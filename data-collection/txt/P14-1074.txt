



















































Linguistic Structured Sparsity in Text Categorization


Proceedings of the 52nd Annual Meeting of the Association for Computational Linguistics, pages 786–796,
Baltimore, Maryland, USA, June 23-25 2014. c©2014 Association for Computational Linguistics

Linguistic Structured Sparsity in Text Categorization

Dani Yogatama
Language Technologies Institute

School of Computer Science
Carnegie Mellon University
Pittsburgh, PA 15213, USA
dyogatama@cs.cmu.edu

Noah A. Smith
Language Technologies Institute

School of Computer Science
Carnegie Mellon University
Pittsburgh, PA 15213, USA
nasmith@cs.cmu.edu

Abstract

We introduce three linguistically moti-
vated structured regularizers based on
parse trees, topics, and hierarchical word
clusters for text categorization. These
regularizers impose linguistic bias in fea-
ture weights, enabling us to incorporate
prior knowledge into conventional bag-
of-words models. We show that our
structured regularizers consistently im-
prove classification accuracies compared
to standard regularizers that penalize fea-
tures in isolation (such as lasso, ridge,
and elastic net regularizers) on a range of
datasets for various text prediction prob-
lems: topic classification, sentiment anal-
ysis, and forecasting.

1 Introduction

What is the best way to exploit linguistic infor-
mation in statistical text processing models? For
tasks like text classification, sentiment analysis,
and text-driven forecasting, this is an open ques-
tion, as cheap “bag-of-words” models often per-
form well. Much recent work in NLP has fo-
cused on linguistic feature engineering (Joshi et
al., 2010) or representation learning (Glorot et al.,
2011; Socher et al., 2013).

In this paper, we propose a radical alternative.
We embrace the conventional bag-of-words repre-
sentation of text, instead bringing linguistic bias
to bear on regularization. Since the seminal work
of Chen and Rosenfeld (2000), the importance of
regularization in discriminative models of text—
including language modeling, structured predic-
tion, and classification—has been widely recog-
nized. The emphasis, however, has largely been
on one specific kind of inductive bias: avoiding
large weights (i.e., coefficients in a linear model).

Recently, structured (or composite) regulariza-
tion has been introduced; simply put, it reasons

about different weights jointly. The most widely
explored variant, group lasso (Yuan and Lin, 2006)
seeks to avoid large `2 norms for groups of
weights. Group lasso has been shown useful in
a range of applications, including computational
biology (Kim and Xing, 2008), signal processing
(Lv et al., 2011), and NLP (Eisenstein et al., 2011;
Martins et al., 2011; Nelakanti et al., 2013). For
text categorization problems, Yogatama and Smith
(2014) proposed groups based on sentences, an
idea generalized here to take advantage of richer
linguistic information.

In this paper, we show how linguistic informa-
tion of various kinds—parse trees, thematic topics,
and hierarchical word clusterings—can be used to
construct group lasso variants that impose linguis-
tic bias without introducing any new features. Our
experiments demonstrate that structured regulariz-
ers can squeeze higher performance out of conven-
tional bag-of-words models on seven out of eight
of text categorization tasks tested, in six cases with
more compact models than the best-performing
unstructured-regularized model.

2 Notation

We represent each document as a feature vector
x ∈ RV , where V is the vocabulary size. xv is the
frequency of the vth word (i.e., this is a “bag of
words” model).

Consider a linear model that predicts a binary
response y ∈ {−1,+1} given x and weight vector
w ∈ RV . We denote our training data of D doc-
uments in the corpus by {xd, yd}Dd=1. The goal of
the learning procedure is to estimate w by mini-
mizing the regularized training data loss:

ŵ = arg min
w

Ω(w) +
∑D

d=1 L(xd,w, yd),

where L(x,w, y) is the loss function for docu-
ment d and Ω(w) is the regularizer.

In this work, we use the log loss:

L(xd,w, yd) = − log(1 + exp(−ydw>xd)),

786



Other loss functions (e.g., hinge loss, squared loss)
can also be used with any of the regularizers dis-
cussed in this paper.

Our focus is on the regularizer, Ω(w). For high
dimensional data such as text, regularization is
crucial to avoid overfitting.1

The usual starting points for regularization are
the “lasso” (Tibshirani, 1996) and the “ridge” (Ho-
erl and Kennard, 1970), based respectively on the
`1 and squared `2 norms:

Ωlas(w) = λlas‖w‖1 = λ
∑

j |wj |
Ωrid (w) = λrid‖w‖22 = λ

∑
j w

2
j

Both methods disprefer weights of large magni-
tude; smaller (relative) magnitude means a feature
(here, a word) has a smaller effect on the predic-
tion, and zero means a feature has no effect.2 The
hyperparameter λ in each case is typically tuned
on a development dataset. A linear combination
of ridge and lasso is known as the elastic net (Zou
and Hastie, 2005). The lasso, ridge, and elastic net
are three strong baselines in our experiments.

3 Group Lasso

Structured regularizers penalize estimates of w in
which collections of weights are penalized jointly.
For example, in the group lasso (Yuan and Lin,
2006), predefined groups of weights (subvectors
of w) are encouraged to either go to zero (as
a group) or not (as a group)—this is known as
“group sparsity.”3

The variant of group lasso we explore here uses
an `1,2 norm. Let g index the G predefined groups
of weights and wg denote the subvector of w con-
taining weights for group g:

Ωglas(w) =λglas
∑G

g=1 λg‖wg‖2,
1A Bayesian interpretation of regularization is as a prior

on the weight vector w; in many cases Ω can be under-
stood as a log-prior representing beliefs about the model held
before exposure to data. For lasso regression, the prior is
a zero-mean Laplace distribution, whereas for ridge regres-
sion the prior is a zero-mean Gaussian distribution. For non-
overlapping group lasso, the prior is a two-level hierarchical
Bayes model (Figueiredo, 2002). The Bayesian interpretation
of overlapping group lasso is not yet well understood.

2The lasso leads to strongly sparse solutions, in which
many elements of the estimated w are actually zero. This
is an attractive property for efficiency and (perhaps) inter-
pretability. The ridge encourages weights to go toward zero,
but usually not all the way to zero; for this reason its solutions
are known as “weakly” sparse.

3Other structured regularizers include the fused lasso
(Tibshirani et al., 2005) and the elitist lasso (Kowalski and
Torresani, 2009).

where λglas is a hyperparameter tuned on a devel-
opment data, and λg is a group specific weight.
Typically the groups are non-overlapping, which
offers computational advantages, but this need not
be the case (Jacob et al., 2009; Jenatton et al.,
2011).

4 Structured Regularizers for Text

Past work applying the group lasso to NLP prob-
lems has considered four ways of defining the
groups. Eisenstein et al. (2011) defined groups
of coefficients corresponding to the same inde-
pendent variable applied to different (continuous)
output variables in multi-output regression. Mar-
tins et al. (2011) defined groups based on fea-
ture templates used in chunking and parsing tasks.
Nelakanti et al. (2013) defined groups based on n-
gram histories for language modeling. In each of
these cases, the groups were defined based on in-
formation from feature types alone; given the fea-
tures to be used, the groups were known.

Here we build on a fourth approach that exploits
structure in the data.4 Yogatama and Smith (2014)
introduced the sentence regularizer, which uses
patterns of word cooccurrence in the training data
to define groups. We review this method, then ap-
ply the idea to three more linguistically informed
structure in text data.

4.1 Sentence Regularizer
The sentence regularizer exploits sentence bound-
aries in each training document. The idea is to
define a group gd,s for every sentence s in every
training document d. The group contains coeffi-
cients for words that occur in its sentence. This
means that a word is a member of one group for
every distinct (training) sentence it occurs in, and
that the regularizer is based on word tokens, not
types as in the approach of Martins et al. (2011)
and Nelakanti et al. (2013). The regularizer is:

Ωsen(w) =
∑D

d=1

∑Sd
s=1 λd,s‖wd,s‖2,

where Sd is the number of sentences in document
d. This regularizer results in tens of thousands
to millions of heavily overlapping groups, since
a standard corpus typically contains thousands to
millions of sentences and many words that appear
in more than one sentence.

4This provides a compelling reason not to view such
methods in a Bayesian framework: if the regularizer is in-
formed by the data, then it does not truly correspond to a
prior.

787



c0,++

c1 c4,+

c2 c3

The actors

c5,++ c8

c6 c7,+

are fantastic

.

Figure 1: An example of a parse tree from the Stanford sen-
timent treebank, which annotates sentiment at the level of
every constituent (indicated here by + and ++; no mark-
ing indicates neutral sentiment). The sentence is The ac-
tors are fantastic. Our regularizer constructs nine groups for
this sentence, corresponding to c0, c1, . . . , c8. gc0 consists of
5 weights—〈wthe , wactors , ware , wfantastic , w.〉, exactly the
same as the group in the sentence regularizer—gc1 consists
of 2 words, gc4 of 3 words, etc. Notice that c2, c3, c6, c7,
and c8 each consist of only 1 word. The Stanford sentiment
treebank has an annotation of sentiments at the constituent
level. As in this example, most constituents are annotated as
neutral.

If the norm of wgd,s is driven to zero, then the
learner has deemed the corresponding sentence ir-
relevant to the prediction. It is important to point
out that, while the regularizer prefers to zero out
the weights for all words in irrelevant sentences, it
also prefers not to zero out weights for words in
relevant sentences. Since the groups overlap and
may work against each other, the regularizer may
not be able to drive many weights to zero on its
own. Yogatama and Smith (2014) used a linear
combination of the sentence regularizer and the
lasso (a kind of sparse group lasso; Friedman et
al., 2010) to also encourage weights of irrelevant
word types to go to zero.5

4.2 Parse Tree Regularizer

Sentence boundaries are a rather superficial kind
of linguistic structure; syntactic parse trees pro-
vide more fine-grained information. We introduce
a new regularizer, the parse tree regularizer, in
which groups are defined for every constituent in
every parse of a training data sentence.

Figure 1 illustrates the group structures derived
from an example sentence from the Stanford sen-
timent treebank (Socher et al., 2013). This regu-
larizer captures the idea that phrases might be se-
lected as relevant or (in most cases) irrelevant to
a task, and is expected to be especially useful in
sentence-level prediction tasks.

The parse-tree regularizer (omitting the group

5Formally, this is equivalent to including one additional
group for each word type.

coefficients and λ) for one sentence with the parse
tree shown in Figure 1 is:
Ωtree(w) =p

|wthe |2 + |wactors |2 + |ware |2 + |wfantastic |2 + |w.|2
+

p
|ware |2 + |wfantastic |2 + |w2. |

+
p
|wthe |2 + |wactors |2 +

p
|ware |2 + |wfantastic |2

+ |wthe |+ |wactors |+ |ware |+ |wfantastic |+ |w.|

The groups have a tree structure, in that assign-
ing zero values to the weights in a group corre-
sponding to a higher-level constituent implies the
same for those constituents that are dominated by
it. This resembles the tree-guided group lasso in
Kim and Xing (2008), although the leaf nodes in
their tree represent tasks in multi-task regression.

Of course, in a corpus there are many parse trees
(one per sentence, so the number of parse trees is
the number of sentences). The parse-tree regular-
izer is:

Ωtree(w) =
∑D

d=1

∑Sd
s=1

∑Cd,s
c=1 λd,s,c‖wd,s,c‖2,

where λd,s,c = λglas ×
√
size(gd,s,c), d ranges

over (training) documents and c ranges over con-
stituents in the parse of sentence s in docu-
ment d. Similar to the sentence regularizer,
the parse-tree regularizer operates on word to-
kens. Note that, since each word token is it-
self a constituent, the parse tree regularizer in-
cludes terms just like the lasso naturally, penal-
izing the absolute value of each word’s weight
in isolation. For the lasso-like penalty on each
word, instead of defining the group weights to be
1 × the number of tokens for each word type, we
tune one group weight for all word types on a de-
velopment data. As a result, besides λglas , we have
an additional hyperparameter, denoted by λlas .

To gain an intuition for this regularizer, consider
the case where we apply the penalty only for a sin-
gle tree (sentence), which for ease of exposition is
assumed not to use the same word more than once
(i.e., ‖x‖∞ = 1). Because it instantiates the tree-
structured group lasso, the regularizer will require
bigger constituents to be “included” (i.e., their
words given nonzero weight) before smaller con-
stituents can be included. The result is that some
words may not be included. Of course, in some
sentences, some words will occur more than once,
and the parse tree regularizer instantiates groups
for constituents in every sentence in the training
corpus, and these groups may work against each
other. The parse tree regularizer should therefore

788



be understood as encouraging group behavior of
syntactically grouped words, or sharing of infor-
mation by syntactic neighbors.

In sentence level prediction tasks, such as
sentence-level sentiment analysis, it is known that
most constituents (especially those that corre-
spond to shorter phrases) in a parse tree are un-
informative (neutral sentiment). This was verified
by Socher et al. (2013) when annotating phrases
in a sentence for building the Stanford sentiment
treebank. Our regularizer incorporates our prior
expectation that most constituents should have no
effect on prediction.

4.3 LDA Regularizer
Another type of structure to consider is topics.
For example, if we want to predict whether a pa-
per will be cited or not (Yogatama et al., 2011),
the model can perform better if it knows before-
hand the collections of words that represent certain
themes (e.g., in ACL papers, these might include
machine translation, parsing, etc.). As a result,
the model can focus on which topics will increase
the probability of getting citations, and penalize
weights for words in the same topic together, in-
stead of treating each word separately.

We do this by inferring topics in the training
corpus by estimating the latent Dirichlet alloca-
tion (LDA) model (Blei et al., 2003)). Note that
LDA is an unsupervised method, so we can in-
fer topical structures from any collection of docu-
ments that are considered related to the target cor-
pus (e.g., training documents, text from the web,
etc.). This contrasts with typical semi-supervised
learning methods for text categorization that com-
bine unlabeled and labeled data within a genera-
tive model, such as multinomial naı̈ve Bayes, via
expectation-maximization (Nigam et al., 2000) or
semi-supervised frequency estimation (Su et al.,
2011). Our method does not use unlabeled data
to obtain more training documents or estimate the
joint distributions of words better, but it allows the
use of unlabeled data to induce topics. We leave
comparison with other semi-supervised methods
for future work.

There are many ways to associate inferred top-
ics with group structure. In our experiments, we
choose the R most probable words given a topic
and create a group for them.6 The LDA regular-

6Another possibility is to group the smallest set of words
whose total probability given a topic amounts to P (e.g.,
0.99). mass of a topic. Preliminary experiments found this

izer can be written as:

Ωlda(w) =
∑K

k=1 λk‖wk‖2,

where k ranges over the K topics. Similar to our
earlier notations, wk corresponds to the subvec-
tor of w such that the corresponding features are
present in topic k. Note that in this case we can
also have overlapping groups, since words can ap-
pear in the top R of many topics.

k = 1 k = 2 k = 3 k = 4
soccer injury physics monday
striker knee gravity tuesday

midfielder ligament moon april
goal shoulder sun june

defender cruciate relativity sunday

Table 1: A toy example of K = 4 topics. The top R = 5
words in each topics are displayed. The LDA regularizer
will construct four groups from these topics. The first group
is 〈wsoccer , wstriker , wmidfielder , wgoal , wdefender 〉, the sec-
ond group is 〈winjury , wknee , wligament , wshoulder , wcruciate〉,
etc. In this example, there are no words occurring in the top
R of more than one topic, but that need not be the case in
general.

To gain an intuition for this regularizer, consider
the toy example in Table 1. the case where we
have K = 4 topics and we select R = 5 top words
from each topic. Supposed that we want to clas-
sify whether an article is a sports article or a sci-
ence article. The regularizer might encourage the
weights for the fourth topics’ words toward zero,
since they are less useful for the task. Addition-
ally, the regularizer will penalize words in each of
the other three groups collectively. Therefore, if
(for example) ligament is deemed a useful feature
for classifying an article to be about sports, then
the other words in that topic will have a smaller ef-
fective penalty for getting nonzero weights—even
weights of the opposite sign as wligament . It is im-
portant to distinguish this from unstructured reg-
ularizers such as the lasso, which penalize each
word’s weight on its own without regard for re-
lated word types.

Unlike the parse tree regularizer, the LDA regu-
larizer is not tree structured. Since the lasso-like
penalty does not occur naturally in a non tree-
structured regularizer, we add an additional lasso
penalty for each word type (with hyperparameter
λlas) to also encourage weights of irrelevant words
to go to zero. Our LDA regularizer is an instance
of sparse group lasso (Friedman et al., 2010).

not to work well.

789



4.4 Brown Cluster Regularizer
Brown clustering is a commonly used unsuper-
vised method for grouping words into a hierarchy
of clusters (Brown et al., 1992). Because it uses
local information, it tends to discover words with
similar syntactic behavior, though semantic group-
ings are often evident, especially at the more fine-
grained end of the hierarchy.

We incorporate Brown clusters into a regular-
izer in a similar way to the topical word groups
inferred using LDA in §4.3, but here we make use
of the hierarchy. Specifically, we construct tree-
structured groups, one per cluster (i.e., one per
node in the hierarchy). The Brown cluster regu-
larizer is:

Ωbrown(w) =
∑N

v=1 λv‖wv‖2,

where v ranges over the N nodes in the Brown
cluster tree. As a tree structured regularizer, this
regularizer enforces constraints that a node v’s
group is given nonzero weights only if those nodes
that dominate v (i.e., are on a path from v to the
root) have their groups selected.

Consider a similar toy example to the LDA reg-
ularizer (sports vs. science) and the hierarchical
clustering of words in Figure 2. In this case, the
Brown cluster regularizer will create 17 groups,
one for every node in the clustering tree. The regu-
larizer for this tree (omitting the group coefficients
and λ) is:

Ωbrown(w) =
∑7

i=0 ‖wvi‖2 + |wgoal |+ |wstriker |
+ |wmidfielder |+ |wknee |+ |winjury |
+ |wgravity |+ |wmoon |+ |wsun |

The regularizer penalizes words in a cluster to-
gether, exploiting discovered syntactic related-
ness. Additionally, the regularizer can zero out
weights of words corresponding to any of the in-
ternal nodes, such as v7 if the words monday and
sunday are deemed irrelevant to prediction.

Note that the regularizer already includes terms
like the lasso naturally. Similar to the parse
tree regularizer, for the lasso-like penalty on each
word, we tune one group weight for all word types
on a development data with a hyperparameter λlas.

A key difference between the Brown cluster
regularizer and the parse tree regularizer is that
there is only one tree for Brown cluster regularizer,
whereas the parse tree regularizer can have mil-
lions (one per sentence in the training data). The

v0

v1 v5

v2 v4

v3 v10

v8 v9

goal striker

midfielder

v11 v12

knee injury

v6 v7

v13 v14

moon sun

v15 v16

monday sunday

Figure 2: An illustrative example of Brown clusters for N =
9. The Brown cluster regularizer constructs 17 groups, one
per node in for this tree, v0, v1, . . . , v16. v0 contains 8 words,
v1 contains 5, etc. Note that the leaves, v8, v9, . . . , v16, each
contain one word.

LDA and Brown cluster regularizers offer ways to
incorporate unlabeled data, if we believe that the
unlabeled data can help us infer better topics or
clusters. Note that the processes of learning topics
or clusters, or parsing training data sentences, are
a separate stage that precedes learning our predic-
tive model.

5 Learning

There are many optimization methods for learn-
ing models with structured regularizers, particu-
lary group lasso (Jacob et al., 2009; Jenatton et al.,
2011; Chen et al., 2011; Qin and Goldfarb, 2012;
Yuan et al., 2013). We choose the optimization
method of Yogatama and Smith (2014) since it
handles millions of overlapping groups effectively.
The method is based on the alternating directions
method of multipliers (ADMM; Hestenes, 1969;
Powell, 1969). We review it here in brief, for com-
pleteness, and show how it can be applied to tree-
structured regularizers (such as the parse tree and
Brown cluster regularizers in §4) in particular.

Our learning problem is, generically:

min
w

Ω(w) +
∑D

d=1 L(xd,w, yd).

Separating the lasso-like penalty for each word
type from our group regularizers, we can rewrite
this problem as:
min
w,v

Ωlas(w) + Ωglas(v) +
∑D

d=1 L(xd,w, yd)

s.t. v = Mw

where v consists of copies of the elements of
w. Notice that we work directly on w instead
of the copies for the lasso-like penalty, since it
does not have overlaps and has its own hyper-
parameters λlas. For the remaining groups with
size greater than one, we create copies v of size

790



L =
∑G

g=1 size(g). M ∈ {0, 1}L×V is a ma-
trix whose 1s link elements of w to their copies.7

We now have a constrained optimization prob-
lem, from which we can create an augmented La-
grangian problem; let u be the Lagrange variables:

Ωlas(w) + Ωglas(v) + L(w)

+ u>(v −Mw) + ρ
2
‖v −Mw‖22

ADMM proceeds by iteratively updating each
of w, v, and u, amounting to the following sub-
problems:

min
w

Ωlas(w) + L(w)− u>Mw + ρ
2
‖v −Mw‖22 (1)

min
v

Ωglas(v) + u
>v +

ρ

2
‖v −Mw‖22 (2)

u = u + ρ(v −Mw) (3)
Yogatama and Smith (2014) show that Eq. 1

can be rewritten in a form quite similar to `2-
regularized loss minimization.8

Eq. 2 is the proximal operator of 1ρΩglas ap-
plied to Mw − uρ . As such, it depends on the
form of M. Note that when applied to the col-
lection of “copies” of the parameters, v, Ωglas no
longer has overlapping groups. Defined Mg as
the rows of M corresponding to weight copies as-
signed to group g. Let zg , Mgw − ugρ . De-
note λg = λglas

√
size(g). The problem can be

solved by applying the proximal operator used in
non-overlapping group lasso to each subvector:

vg = proxΩglas ,λgρ
(zg)

=

 0 if ‖zg‖2 ≤
λg
ρ

‖zg‖2−λgρ
‖zg‖2 zg otherwise.

For a tree structured regularizer, we can get
speedups by working from the root node towards
the leaf nodes when applying the proximal oper-
ator in the second step. If g is a node in a tree
which is driven to zero, all of its children h that
has λh ≤ λg will also be driven to zero.

Eq. 3 is a simple update of the dual variable u.
Algorithm 1 summarizes our learning procedure.9

7For the parse tree regularizer, L is the sum, over all
training-data word tokens t, of the number of constituents t
belongs to. For the LDA regularizer, L = R × K. For the
Brown cluster regularizer, L = V − 1.

8The difference lies in that the squared `2 norm in the
penalty penalizes the difference between w and a vector that
depends on the current values of u and v. This does not affect
the algorithm or its convergence in any substantive way.

9We use relative changes in the `2 norm of the parameter
vector w as our convergence criterion (threshold of 10−3),
and set the maximum number of iterations to 100. Other cri-
teria can also be used.

Algorithm 1 ADMM for overlapping group lasso
Input: augmented Lagrangian variable ρ, regularization
strengths λglas and λlas
while stopping criterion not met do

w = arg min
w

Ωlas(w)+L(w)+
ρ

2

PV
i=1 Ni(wi−µi)2

for g = 1 to G do
vg = prox

Ωglas ,
λg
ρ

(zg)

end for
u = u + ρ(v −Mw)

end while

6 Experiments

6.1 Datasets

We use publicly available datasets to evaluate our
model described in more detail below.

Topic classification. We consider four binary
categorization tasks from the 20 Newsgroups
dataset.10 Each task involves categorizing a
document according to two related categories:
comp.sys: ibm.pc.hardware vs. mac.hardware;
rec.sport: baseball vs. hockey; sci: med vs. space;
and alt.atheism vs. soc.religion.christian.

Sentiment analysis. One task in sentiment anal-
ysis is predicting the polarity of a piece of text, i.e.,
whether the author is favorably inclined toward a
(usually known) subject of discussion or proposi-
tion (Pang and Lee, 2008). Sentiment analysis,
even at the coarse level of polarity we consider
here, can be confused by negation, stylistic use of
irony, and other linguistic phenomena. Our sen-
timent analysis datasets consist of movie reviews
from the Stanford sentiment treebank (Socher et
al., 2013),11 and floor speeches by U.S. Congress-
men alongside “yea”/“nay” votes on the bill under
discussion (Thomas et al., 2006).12 For the Stan-
ford sentiment treebank, we only predict binary
classifications (positive or negative) and exclude
neutral reviews.

Text-driven forecasting. Forecasting from text
requires identifying textual correlates of a re-
sponse variable revealed in the future, most of
which will be weak and many of which will be
spurious (Kogan et al., 2009). We consider two
such problems. The first one is predicting whether
a scientific paper will be cited or not within three
years of its publication (Yogatama et al., 2011);

10
http://qwone.com/˜jason/20Newsgroups

11
http://nlp.stanford.edu/sentiment/

12
http://www.cs.cornell.edu/˜ainur/data.html

791



Dataset D # Dev. # Test V

20
N

science 952 235 790 30,154
sports 958 239 796 20,832
relig. 870 209 717 24,528

comp. 929 239 777 20,868

Se
nt

. movie 6,920 872 1,821 17,576
vote 1,175 257 860 24,508

Fo
re

. science 3,207 280 539 42,702
bill 37,850 7,341 6,571 10,001

Table 2: Descriptive statistics about the datasets.

the dataset comes from the ACL Anthology and
consists of research papers from the Association
for Computational Linguistics and citation data
(Radev et al., 2009). The second task is predicting
whether a legislative bill will be recommended by
a Congressional committee (Yano et al., 2012).13

Table 2 summarizes statistics about the datasets
used in our experiments. In total, we evaluate our
method on eight binary classification tasks.

6.2 Setup

In all our experiments, we use unigram features
plus an additional bias term which is not regu-
larized. We compare our new regularizers with
state-of-the-art methods for document classifica-
tion: lasso, ridge, and elastic net regularization, as
well as the sentence regularizer discussed in §4.1
(Yogatama and Smith, 2014).14

We parsed all corpora using the Berkeley parser
(Petrov and Klein, 2007).15 For the LDA regular-
izers, we ran LDA16 on training documents with
K = 1, 000 and R = 10. For the Brown cluster
regularizers, we ran Brown clustering17 on train-
ing documents with 5, 000 clusters for the topic
classification and sentiment analysis datasets, and
1, 000 for the larger text forecasting datasets (since
they are bigger datasets that took more time).

13
http://www.ark.cs.cmu.edu/bills

14Hyperparameters are tuned on a separate develop-
ment dataset, using accuracy as the evaluation crite-
rion. For lasso and ridge models, we choose λ from
{10−2, 10−1, 1, 10, 102, 103}. For elastic net, we perform
grid search on the same set of values as ridge and lasso
experiments for λrid and λlas . For the sentence, Brown
cluster, and LDA regularizers, we perform grid search on
the same set of values as ridge and lasso experiments for
ρ, λglas , λlas . For the parse tree regularizer, because there
are many more groups than other regularizers, we choose
λglas from {10−4, 10−3, 10−2, 10−1, 10}, ρ and λlas from
the same set of values as ridge and lasso experiments. If there
is a tie on development data we choose the model with the
smallest number of nonzero weights.

15
https://code.google.com/p/berkeleyparser/

16
http://www.cs.princeton.edu/˜blei/lda-c/

17
https://github.com/percyliang/brown-cluster

6.3 Results

Table 3 shows the results of our experiments on
the eight datasets. The results demonstrate the su-
periority of structured regularizers. One of them
achieved the best result on all but one dataset.18 It
is also worth noting that in most cases all variants
of the structured regularizers outperformed lasso,
ridge, and elastic net. In four cases, the new regu-
larizers in this paper outperform the sentence reg-
ularizer.

We can see that the parse tree regularizer per-
formed the best for the movie review dataset. The
task is to predict sentence-level sentiment, so each
training example is a sentence. Since constituent-
level annotations are available for this dataset, we
only constructed groups for neutral constituents
(i.e., we drive neutral constituents to zero during
training). It has been shown that syntactic in-
formation is helpful for sentence-level predictions
(Socher et al., 2013), so the parse tree regularizer
is naturally suitable for this task.

The Brown cluster and LDA regularizers per-
formed best for the forecasting scientific articles
dataset. The task is to predict whether an article
will be cited or not within three years after publi-
cation. Regularizers that exploit the knowledge of
semantic relations (e.g., topical categories), such
as the Brown cluster and LDA regularizers, are
therefore suitable for this type of prediction.

Table 4 shows model sizes obtained by each
of the regularizers for each dataset. While lasso
prunes more aggressively, it almost always per-
forms worse. Our structured regularizers were
able to obtain a significantly smaller model (27%,
34%, 19% as large on average for parse tree,
Brown, and LDA regularizers respectively) com-
pared to the ridge model.

Topic and cluster features. Another way to in-
corporate LDA topics and Brown clusters into a
linear model is by adding them as additional fea-
tures. For the 20N datasets, we also ran lasso,
ridge, and elastic net with additional LDA topic
and Brown cluster features.19 Note that these new
baselines use more features than our model. We
can also add these additional features to our model

18This “bill” dataset, where they offered no improvement,
is the largest by far (37,850 documents), and therefore the
one where regularizers should matter the least. Note that the
differences are small across regularizers for this dataset.

19For LDA, we took the top 10 words in a topic as a feature.
For Brown clusters, we add a cluster as an additional feature
if its size is less than 50.

792



Task Dataset Accuracy (%)m.f.c. lasso ridge elastic sentence parse Brown LDA

20N

science 50.13 90.63 91.90 91.65 96.20 92.66 93.04 93.67
sports 50.13 91.08 93.34 93.71 95.10 93.09 93.71 94.97

religion 55.51 90.52 92.47 92.47 92.75 94.98 92.89 93.03
computer 50.45 85.84 86.74 87.13 90.86 89.45 86.36 88.42

Sentiment movie 50.08 78.03 80.45 80.40 80.72 81.55 80.34 78.36vote 58.37 73.14 72.79 72.79 73.95 73.72 66.86 73.14

Forecasting science 50.28 64.00 66.79 66.23 67.71 66.42 69.02 69.39bill 87.40 88.36 87.70 88.48 88.11 87.98 88.20 88.27

Table 3:
Classification
accuracies on
various datasets.
“m.f.c.” is the
most frequent
class baseline.
Boldface shows
best results.

Task Dataset Model size (%)m.f.c. lasso ridge elastic sentence parse Brown LDA

20N

science - 1 100 34 12 2 42 9
sports - 2 100 15 3 3 16 9

religion - 0.3 100 48 94 72 41 15
computer - 2 100 24 10 5 24 8

Sentiment movie - 10 100 54 83 87 59 12vote - 2 100 44 6 2 30 4

Forecasting science - 31 100 43 99 9 50 90bill - 7 100 7 8 37 7 7

Table 4: Model
sizes (percentages
of nonzero
features in the
resulting models)
on various
datasets.

Dataset + LDA features LDAlasso ridge elastic reg.
science 90.63 91.90 91.90 93.67
sports 91.33 93.47 93.84 94.97

religion 91.35 92.47 91.35 93.03
computer 85.20 86.87 86.35 88.42

Dataset + Brown features Brownlasso ridge elastic reg.
science 86.96 90.51 91.14 93.04
sports 82.66 88.94 85.43 93.71

religion 94.98 96.93 96.93 92.89
computer 55.72 96.65 67.57 86.36

Table 5: Classification accuracies on the 20N datasets for
lasso, ridge, and elastic net models with additional LDA fea-
tures (top) and Brown cluster features (bottom). The last col-
umn shows structured regularized models from Table 3.

and treat them as regular features (i.e., they do
not belong to any groups and are regularized with
standard regularizer such as the lasso penalty).
The results in Table 5 show that for these datasets,
models that incorporate this information through
structured regularizers outperformed models that
encode this information as additional features in
4 out 4 of cases (LDA) and 2 out of 4 cases
(Brown). Sparse models with Brown clusters ap-
pear to overfit badly; recall that the clusters were
learned on only the training data—clusters from
a larger dataset would likely give stronger re-
sults. Of course, better performance might also
be achieved by incorporating new features as well
as using structured regularizers.

6.4 Examples

To gain an insight into the models, we inspect
group sparsity patterns in the learned models by
looking at the parameter copies v. This lets us see
which groups are considered important (i.e., “se-

lected” vs. “removed”). For each of the proposed
regularizers, we inspect the model a task in which
it performed well.

For the parse tree regularizer, we inspect the
model for the 20N:religion task. We observed that
the model included most of the sentences (root
node groups), but in some cases removed phrases
from the parse trees, such as ozzy osbourne in the
sentence ozzy osbourne , ex-singer and main char-
acter of the black sabbath of good ole days past ,
is and always was a devout catholic .

For the LDA regularizer, we inspect zero and
nonzero groups (topics) in the forecasting scien-
tific articles task. In this task, we observed that
642 out of 1,000 topics are driven to zero by
our model. Table 6 shows examples of zero and
nonzero topics for the dev.-tuned hyperparameter
values. We can see that in this particular case, the
model kept meaningful topics such as parsing and
speech processing, and discarded general topics
that are not correlated with the content of the pa-
pers (e.g., acknowledgment, document metadata,
equation, etc.). Note that most weights for non-
selected groups, even in w, are near zero.

For the Brown cluster regularizer, we inspect
the model from the 20N:science task. 771 out
of 5,775 groups were driven to zero for the best
model tuned on the development set. Examples
of zero and nonzero groups are shown in Ta-
ble 7. Similar to the LDA example, the groups
that were driven to zero tend to contain generic
words that are not relevant to the predictions. We
can also see the tree structure effect in the regu-
larizer. The group {underwater, industrial} was

793



= 0

“acknowledgment”: workshop arpa program session darpa research papers spoken technology systems
“document metadata”: university references proceedings abstract work introduction new been research both

“equation”: pr w h probability wi gram context z probabilities complete
“translation”: translation target source german english length alignment hypothesis translations position

6= 0
“translation”: korean translation english rules sentences parsing input evaluation machine verb

“speech processing”: speaker identification topic recognition recognizer models acoustic test vocabulary independent
“parsing”: parser parsing probabilistic prediction parse pearl edges chart phase theory

“classification”: documents learning accuracy bayes classification wt document naive method selection

Table 6: Examples of LDA regularizer-removed and -selected groups (in v) in the forecasting scientific articles dataset. Words
with weights (in w) of magnitude greater than 10−3 are highlighted in red (not cited) and blue (cited).

= 0

underwater industrial
spotted hit reaped rejuvenated destroyed stretched undertake shake run
seeing developing tingles diminishing launching finding investigating receiving

maintaining
adds engage explains builds

6= 0

failure reproductive ignition reproduction
cyanamid planetary nikola fertility astronomical geophysical # lunar cometary

supplying astronautical
magnetic atmospheric
std underwater hpr wordscan exclusively aneutronic industrial peoples obsessive
congenital rare simple bowel hereditary breast

Table 7: Examples of Brown
regularizer-removed and
-selected groups (in v) in the
20N:science task. # denotes
any numeral. Words with
weights (in w) of magnitude
greater than 10−3 are
highlighted in red (space) and
blue (medical).

driven to zero, but not once it combined with other
words such as hpr, std, obsessive. Note that we
ran Brown clustering only on the training docu-
ments; running it on a larger collection of (unla-
beled) documents relevant to the prediction task
(i.e., semi-supervised learning) is worth exploring
in future work.

7 Related and Future Work

Overall, our results demonstrate that linguistic
structure in the data can be used to improve bag-
of-words models, through structured regulariza-
tion. State-of-the-art approaches to some of these
problems have used additional features and repre-
sentations (Yessenalina et al., 2010; Socher et al.,
2013). For example, for the vote sentiment analy-
sis datasets, latent variable models of Yessenalina
et al. (2010) achieved a superior result of 77.67%.
To do so, they sacrificed convexity and had to rely
on side information for initialization. Our exper-
imental focus has been on a controlled compari-
son between regularizers for a fixed model family
(the simplest available, linear with bag-of-words
features). However, the improvements offered by
our regularization methods can be applied in fu-
ture work to other model families with more care-
fully engineered features, metadata features (espe-
cially important in forecasting), latent variables,
etc. In particular, note that other kinds of weights
(e.g., metadata) can be penalized conventionally,
or incorporated into the structured regularization
where it makes sense to do so (e.g., n-grams, as in
Nelakanti et al., 2013).

8 Conclusion

We introduced three data-driven, linguistically
informed structured regularizers based on parse
trees, topics, and hierarchical word clusters. We
empirically showed that models regularized us-
ing our methods consistently outperformed stan-
dard regularizers that penalize features in isolation
such as lasso, ridge, and elastic net on a range
of datasets for various text prediction problems:
topic classification, sentiment analysis, and fore-
casting.

Acknowledgments

The authors thank Brendan O’Connor for help
with visualization and three anonymous review-
ers for helpful feedback on an earlier draft of this
paper. This research was supported in part by
computing resources provided by a grant from the
Pittsburgh Supercomputing Center, a Google re-
search award, and the Intelligence Advanced Re-
search Projects Activity via Department of In-
terior National Business Center contract number
D12PC00347. The U.S. Government is authorized
to reproduce and distribute reprints for Govern-
mental purposes notwithstanding any copyright
annotation thereon. The views and conclusions
contained herein are those of the authors and
should not be interpreted as necessarily represent-
ing the official policies or endorsements, either ex-
pressed or implied, of IARPA, DoI/NBC, or the
U.S. Government.

794



References
David M. Blei, Andrew Y. Ng, and Michael I. Jordan.

2003. Latent Dirichlet allocation. Journal of Ma-
chine Learning Research, 3:993–1022.

Peter F. Brown, Peter V. deSouza, Robert L. Mer-
cer, Vincent J. Della Pietra, and Jenifer C. Lai.
1992. Class-based n-gram models of natural lan-
guage. Computational Linguistics, 18:467–479.

Stanley F. Chen and Ronald Rosenfeld. 2000. A
survey of smoothing techniques for me models.
IEEE Transactions on Speech and Audio Process-
ing, 8(1):37–50.

Xi Chen, Qihang Lin, Seyoung Kim, Jaime G. Car-
bonell, and Eric P. Xing. 2011. Smoothing prox-
imal gradient method for general structured sparse
learning. In Proc. of UAI.

Jacob Eisenstein, Noah A. Smith, and Eric P. Xing.
2011. Discovering sociolinguistic associations with
structured sparsity. In Proc. of ACL.

Mario A. T. Figueiredo. 2002. Adaptive sparseness
using Jeffreys’ prior. In Proc. of NIPS.

Jerome Friedman, Trevor Hastie, and Robert Tibshiran.
2010. A note on the group lasso and a sparse group
lasso. Technical report, Stanford University.

Xavier Glorot, Antoine Bordes, and Yoshua Bengio.
2011. Domain adaptation for large-scale sentiment
classification: A deep learning approach. In Proc. of
ICML.

Magnus R. Hestenes. 1969. Multiplier and gradient
methods. Journal of Optimization Theory and Ap-
plications, 4:303–320.

Arthur E. Hoerl and Robert W. Kennard. 1970. Ridge
regression: Biased estimation for nonorthogonal
problems. Technometrics, 12(1):55–67.

Laurent Jacob, Guillaume Obozinski, and Jean-
Philippe Vert. 2009. Group lasso with overlap and
graph lasso. In Proc. of ICML.

Rodolphe Jenatton, Jean-Yves Audibert, and Fran-
cis Bach. 2011. Structured variable selection
with sparsity-inducing norms. Journal of Machine
Learning Research, 12:2777–2824.

Mahesh Joshi, Dipanjan Das, Kevin Gimpel, and
Noah A. Smith. 2010. Movie reviews and rev-
enues: An experiment in text regression. In Proc.
of NAACL.

Seyoung Kim and Eric P. Xing. 2008. Feature selec-
tion via block-regularized regression. In Proc. of
UAI.

Shimon Kogan, Dimitry Levin, Bryan R. Routledge,
Jacob S. Sagi, and Noah A. Smith. 2009. Predicting
risk from financial reports with regression. In Proc.
of HLT-NAACL.

Matthieu Kowalski and Bruno Torresani. 2009. Spar-
sity and persistence: mixed norms provide simple
signal models with dependent coefficients. Signal,
Image and Video Processing, 3(3):251–0264.

Xiaolei Lv, Guoan Bi, and Chunru Wan. 2011. The
group lasso for stable recovery of block-sparse sig-
nal representations. IEEE Transactions on Signal
Processing, 59(4):1371–1382.

Andre F. T. Martins, Noah A. Smith, Pedro M. Q.
Aguiar, and Mario A. T. Figueiredo. 2011. Struc-
tured sparsity in structured prediction. In Proc. of
EMNLP.

Anil Nelakanti, Cedric Archambeau, Julien Mairal,
Francis Bach, and Guillaume Bouchard. 2013.
Structured penalties for log-linear language models.
In Proc. of EMNLP.

Kamal Nigam, Andrew McCallum, Sebastian Thrun,
and Tom Mitchell. 2000. Text classification from la-
beled and unlabeled documents using em. Machine
Learning, 39(2-3):103–134.

Bo Pang and Lilian Lee. 2008. Opinion mining and
sentiment analysis. Foundations and Trends in In-
formation Retrieval, 2(1–2):1–135.

Slav Petrov and Dan Klein. 2007. Improved inference
for unlexicalized parsing. In Proc. of HLT-NAACL.

M. J. D. Powell. 1969. A method for nonlinear con-
straints in minimization problems. In R. Fletcher,
editor, Optimization, pages 283–298. Academic
Press.

Zhiwei (Tony) Qin and Donald Goldfarb. 2012. Struc-
tured sparsity via alternating direction methods.
Journal of Machine Learning Research, 13:1435–
1468.

Dragomir R. Radev, Pradeep Muthukrishnan, and Va-
hed Qazvinian. 2009. The ACL anthology net-
work corpus. In Proc. of ACL Workshop on Natural
Language Processing and Information Retrieval for
Digital Libraries.

Richard Socher, Alex Perelygin, Jean Wu, Jason
Chuang, Chris Manning, Andrew Ng, and Chris
Potts. 2013. Recursive deep models for semantic
compositionality over a sentiment treebank. In Proc.
of EMNLP.

Jiang Su, Jelber Sayyad-Shirabad, and Stan Matwin.
2011. Large scale text classication using semi-
supervised multinomial naive Bayes. In Proc. of
ICML.

Matt Thomas, Bo Pang, and Lilian Lee. 2006. Get out
the vote: Determining support or opposition from
congressional floor-debate transcripts. In Proc. of
EMNLP.

795



Robert Tibshirani, Michael Saunders, Saharon Ros-
set, Ji Zhu, and Keith Knight. 2005. Sparsity and
smoothness via the fused lasso. Journal of Royal
Statistical Society B, 67(1):91–108.

Robert Tibshirani. 1996. Regression shrinkage and
selection via the lasso. Journal of Royal Statistical
Society B, 58(1):267–288.

Tae Yano, Noah A. Smith, and John D. Wilkerson.
2012. Textual predictors of bill survival in congres-
sional committees. In Proc. of NAACL.

Ainur Yessenalina, Yisong Yue, and Claire Cardie.
2010. Multi-level structured models for document
sentiment classification. In Proc. of EMNLP.

Dani Yogatama and Noah A. Smith. 2014. Making the
most of bag of words: Sentence regularization with
alternating direction method of multipliers. In Proc.
of ICML.

Dani Yogatama, Michael Heilman, Brendan O’Connor,
Chris Dyer, Bryan R. Routledge, and Noah A.
Smith. 2011. Predicting a scientific community’s
response to an article. In Proc. of EMNLP.

Ming Yuan and Yi Lin. 2006. Model selection
and estimation in regression with grouped variables.
Journal of the Royal Statistical Society, Series B,
68(1):49–67.

Lei Yuan, Jun Liu, and Jieping Ye. 2013. Efficient
methods for overlapping group lasso. IEEE Trans-
actions on Pattern Analysis and Machine Intelli-
gence, 35(9):2104–2116.

Hui Zou and Trevor Hastie. 2005. Regularization and
variable selection via the elastic net. Journal of the
Royal Statistical Society, Series B, 67:301–320.

796


