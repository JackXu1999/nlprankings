



















































Context-Aware Neural Machine Translation Learns Anaphora Resolution


Proceedings of the 56th Annual Meeting of the Association for Computational Linguistics (Long Papers), pages 1264–1274
Melbourne, Australia, July 15 - 20, 2018. c©2018 Association for Computational Linguistics

1264

Context-Aware Neural Machine Translation Learns Anaphora Resolution
Elena Voita

Yandex, Russia
University of Amsterdam, Netherlands
lena-voita@yandex-team.ru

Pavel Serdyukov
Yandex, Russia

pavser@yandex-team.ru

Rico Sennrich
University of Edinburgh, Scotland
University of Zurich, Switzerland
rico.sennrich@ed.ac.uk

Ivan Titov
University of Edinburgh, Scotland

University of Amsterdam, Netherlands
ititov@inf.ed.ac.uk

Abstract

Standard machine translation systems pro-
cess sentences in isolation and hence ig-
nore extra-sentential information, even
though extended context can both prevent
mistakes in ambiguous cases and improve
translation coherence. We introduce a
context-aware neural machine translation
model designed in such way that the flow
of information from the extended con-
text to the translation model can be con-
trolled and analyzed. We experiment with
an English-Russian subtitles dataset, and
observe that much of what is captured
by our model deals with improving pro-
noun translation. We measure correspon-
dences between induced attention distri-
butions and coreference relations and ob-
serve that the model implicitly captures
anaphora. It is consistent with gains for
sentences where pronouns need to be gen-
dered in translation. Beside improvements
in anaphoric cases, the model also im-
proves in overall BLEU, both over its
context-agnostic version (+0.7) and over
simple concatenation of the context and
source sentences (+0.6).

1 Introduction

It has long been argued that handling discourse
phenomena is important in translation (Mitkov,
1999; Hardmeier, 2012). Using extended con-
text, beyond the single source sentence, should
in principle be beneficial in ambiguous cases and
also ensure that generated translations are coher-
ent. Nevertheless, machine translation systems
typically ignore discourse phenomena and trans-
late sentences in isolation.

Earlier research on this topic focused on han-
dling specific phenomena, such as translating pro-
nouns (Le Nagard and Koehn, 2010; Hardmeier
and Federico, 2010; Hardmeier et al., 2015), dis-
course connectives (Meyer et al., 2012), verb
tense (Gong et al., 2012), increasing lexical con-
sistency (Carpuat, 2009; Tiedemann, 2010; Gong
et al., 2011), or topic adaptation (Su et al., 2012;
Hasler et al., 2014), with special-purpose features
engineered to model these phenomena. How-
ever, with traditional statistical machine transla-
tion being largely supplanted with neural machine
translation (NMT) models trained in an end-to-
end fashion, an alternative is to directly provide
additional context to an NMT system at training
time and hope that it will succeed in inducing rel-
evant predictive features (Jean et al., 2017; Wang
et al., 2017; Tiedemann and Scherrer, 2017; Baw-
den et al., 2018).

While the latter approach, using context-aware
NMT models, has demonstrated to yield perfor-
mance improvements, it is still not clear what
kinds of discourse phenomena are successfully
handled by the NMT systems and, importantly,
how they are modeled. Understanding this would
inform development of future discourse-aware
NMT models, as it will suggest what kind of in-
ductive biases need to be encoded in the archi-
tecture or which linguistic features need to be ex-
ploited.

In our work we aim to enhance our un-
derstanding of the modelling of selected dis-
course phenomena in NMT. To this end, we con-
struct a simple discourse-aware model, demon-
strate that it achieves improvements over the
discourse-agnostic baseline on an English-Russian
subtitles dataset (Lison et al., 2018) and study
which context information is being captured in
the model. Specifically, we start with the Trans-



1265

former (Vaswani et al., 2017), a state-of-the-art
model for context-agnostic NMT, and modify it in
such way that it can handle additional context. In
our model, a source sentence and a context sen-
tence are first encoded independently, and then a
single attention layer, in a combination with a gat-
ing function, is used to produce a context-aware
representation of the source sentence. The infor-
mation from context can only flow through this at-
tention layer. When compared to simply concate-
nating input sentences, as proposed by Tiedemann
and Scherrer (2017), our architecture appears both
more accurate (+0.6 BLEU) and also guarantees
that the contextual information cannot bypass the
attention layer and hence remain undetected in our
analysis.

We analyze what types of contextual informa-
tion are exploited by the translation model. While
studying the attention weights, we observe that
much of the information captured by the model
has to do with pronoun translation. It is not en-
tirely surprising, as we consider translation from
a language without grammatical gender (English)
to a language with grammatical gender (Russian).
For Russian, translated pronouns need to agree in
gender with their antecedents. Moreover, since in
Russian verbs agree with subjects in gender and
adjectives also agree in gender with pronouns in
certain frequent constructions, mistakes in trans-
lating pronouns have a major effect on the words
in the produced sentences. Consequently, the stan-
dard cross-entropy training objective sufficiently
rewards the model for improving pronoun transla-
tion and extracting relevant information from the
context.

We use automatic co-reference systems and hu-
man annotation to isolate anaphoric cases. We ob-
serve even more substantial improvements in per-
formance on these subsets. By comparing atten-
tion distributions induced by our model against
co-reference links, we conclude that the model
implicitly captures coreference phenomena, even
without having any kind of specialized features
which could help it in this subtask. These obser-
vations also suggest potential directions for future
work. For example, effective co-reference systems
go beyond relying simply on embeddings of con-
texts. One option would be to integrate ‘global’
features summarizing properties of groups of men-
tions predicted as linked in a document (Wiseman
et al., 2016), or to use latent relations to trace en-

tities across documents (Ji et al., 2017). Our key
contributions can be summarized as follows:

• we introduce a context-aware neural model,
which is effective and has a sufficiently sim-
ple and interpretable interface between the
context and the rest of the translation model;

• we analyze the flow of information from the
context and identify pronoun translation as
the key phenomenon captured by the model;

• by comparing to automatically predicted or
human-annotated coreference relations, we
observe that the model implicitly captures
anaphora.

2 Neural Machine Translation

Given a source sentence x = (x1, x2, . . . , xS)
and a target sentence y = (y1, y2, . . . , yT ), NMT
models predict words in the target sentence, word
by word.

Current NMT models mainly have an encoder-
decoder structure. The encoder maps an in-
put sequence of symbol representations x to
a sequence of distributed representations z =
(z1, z2, . . . , zS). Given z, a neural decoder gener-
ates the corresponding target sequence of symbols
y one element at a time.

Attention-based NMT The encoder-decoder
framework with attention has been proposed by
Bahdanau et al. (2015) and has become the de-
facto standard in NMT. The model consists of en-
coder and decoder recurrent networks and an at-
tention mechanism. The attention mechanism se-
lectively focuses on parts of the source sentence
during translation, and the attention weights spec-
ify the proportions with which information from
different positions is combined.

Transformer Vaswani et al. (2017) proposed
an architecture that avoids recurrence completely.
The Transformer follows an encoder-decoder ar-
chitecture using stacked self-attention and fully
connected layers for both the encoder and decoder.
An important advantage of the Transformer is that
it is more parallelizable and faster to train than re-
current encoder-decoder models.

From the source tokens, learned embeddings are
generated and then modified using positional en-
codings. The encoded word embeddings are then
used as input to the encoder which consists of N



1266

layers each containing two sub-layers: (a) a multi-
head attention mechanism, and (b) a feed-forward
network.

The self-attention mechanism first computes at-
tention weights: i.e., for each word, it computes a
distribution over all words (including itself). This
distribution is then used to compute a new repre-
sentation of that word: this new representation is
set to an expectation (under the attention distribu-
tion specific to the word) of word representations
from the layer below. In multi-head attention, this
process is repeated h times with different repre-
sentations and the result is concatenated.

The second component of each layer of the
Transformer network is a feed-forward network.
The authors propose using a two-layered network
with the ReLU activations.

Analogously, each layer of the decoder contains
the two sub-layers mentioned above as well as
an additional multi-head attention sub-layer that
receives input from the corresponding encoding
layer.

In the decoder, the attention is masked to pre-
vent future positions from being attended to, or in
other words, to prevent illegal leftward informa-
tion flow. See Vaswani et al. (2017) for additional
details.

The proposed architecture reportedly improves
over the previous best results on the WMT 2014
English-to-German and English-to-French trans-
lation tasks, and we verified its strong perfor-
mance on our data set in preliminary experiments.
Thus, we consider it a strong state-of-the-art base-
line for our experiments. Moreover, as the Trans-
former is attractive in practical NMT applications
because of its parallelizability and training effi-
ciency, integrating extra-sentential information in
Transformer is important from the engineering
perspective. As we will see in Section 4, previ-
ous techniques developed for recurrent encoder-
decoders do not appear effective for the Trans-
former.

3 Context-aware model architecture

Our model is based on Transformer architecture
(Vaswani et al., 2017). We leave Transformer’s
decoder intact while incorporating context infor-
mation on the encoder side (Figure 1).

Source encoder: The encoder is composed of a
stack of N layers. The first N − 1 layers are iden-
tical and represent the original layers of Trans-

Figure 1: Encoder of the discourse-aware model

former’s encoder. The last layer incorporates con-
textual information as shown in Figure 1. In ad-
dition to multi-head self-attention it has a block
which performs multi-head attention over the out-
put of the context encoder stack. The outputs of
the two attention mechanisms are combined via
a gated sum. More precisely, let c(s−attn)i be the
output of the multi-head self-attention, c(c−attn)i
the output of the multi-head attention to context,
ci their gated sum, and σ the logistic sigmoid
function, then

gi = σ
(
Wg

[
c
(s−attn)
i , c

(c−attn)
i

]
+ bg

)
(1)

ci = gi � c(s−attn)i + (1− gi)� c
(c−attn)
i (2)

Context encoder: The context encoder is com-
posed of a stack of N identical layers and repli-
cates the original Transformer encoder. In con-
trast to related work (Jean et al., 2017; Wang et al.,
2017), we found in preliminary experiments that
using separate encoders does not yield an accurate
model. Instead we share the parameters of the first
N − 1 layers with the source encoder.

Since major proportion of the context encoder’s
parameters are shared with the source encoder, we
add a special token (let us denote it <bos>) to
the beginning of context sentences, but not source



1267

sentences, to let the shared layers know whether it
is encoding a source or a context sentence.

4 Experiments

4.1 Data and setting

We use the publicly available OpenSubtitles2018
corpus (Lison et al., 2018) for English and Rus-
sian.1 As described in the appendix, we apply
data cleaning and randomly choose 2 million train-
ing instances from the resulting data. For devel-
opment and testing, we randomly select two sub-
sets of 10000 instances from movies not encoun-
tered in training.2 Sentences were encoded using
byte-pair encoding (Sennrich et al., 2016), with
source and target vocabularies of about 32000 to-
kens. We generally used the same parameters and
optimizer as in the original Transformer (Vaswani
et al., 2017). The hyperparameters, preprocessing
and training details are provided in the supplemen-
tary material.

5 Results and analysis

We start by experiments motivating the setting and
verifying that the improvements are indeed gen-
uine, i.e. they come from inducing predictive fea-
tures of the context. In subsequent section 5.2,
we analyze the features induced by the context en-
coder and perform error analysis.

5.1 Overall performance

We use the traditional automatic metric BLEU on
a general test set to get an estimate of the over-
all performance of the discourse-aware model, be-
fore turning to more targeted evaluation in the next
section. We provide results in Table 1.3 The
‘baseline’ is the discourse-agnostic version of the
Transformer. As another baseline we use the stan-
dard Transformer applied to the concatenation of
the previous and source sentences, as proposed
by Tiedemann and Scherrer (2017). Tiedemann
and Scherrer (2017) only used a special symbol
to mark where the context sentence ends and the
source sentence begins. This technique performed
badly with the non-recurrent Transformer archi-
tecture in preliminary experiments, resulting in

1http://opus.nlpl.eu/
OpenSubtitles2018.php

2The resulting data sets are freely available at http://
data.statmt.org/acl18_contextnmt_data/

3We use bootstrap resampling (Riezler and Maxwell,
2005) for significance testing

model BLEU
baseline 29.46
concatenation (previous sentence) 29.53
context encoder (previous sentence) 30.14
context encoder (next sentence) 29.31
context encoder (random context) 29.69

Table 1: Automatic evaluation: BLEU. Signifi-
cant differences at p < 0.01 are in bold.

a substantial degradation of performance (over 1
BLEU). Instead, we use a binary flag at every word
position in our concatenation baseline telling the
encoder whether the word belongs to the context
sentence or to the source sentence.

We consider two versions of our discourse-
aware model: one using the previous sentence as
the context, another one relying on the next sen-
tence. We hypothesize that both the previous and
the next sentence provide a similar amount of ad-
ditional clues about the topic of the text, whereas
for discourse phenomena such as anaphora, dis-
course relations and elliptical structures, the pre-
vious sentence is more important.

First, we observe that our best model is the
one using a context encoder for the previous sen-
tence: it achieves 0.7 BLEU improvement over the
discourse-agnostic model. We also notice that, un-
like the previous sentence, the next sentence does
not appear beneficial. This is a first indicator that
discourse phenomena are the main reason for the
observed improvement, rather than topic effects.
Consequently, we focus solely on using the previ-
ous sentence in all subsequent experiments.

Second, we observe that the concatenation base-
line appears less accurate than the introduced
context-aware model. This result suggests that our
model is not only more amendable to analysis but
also potentially more effective than using concate-
nation.

In order to verify that our improvements are
genuine, we also evaluate our model (trained with
the previous sentence as context) on the same test
set with shuffled context sentences. It can be seen
that the performance drops significantly when a
real context sentence is replaced with a random
one. This confirms that the model does rely on
context information to achieve the improvement in
translation quality, and is not merely better regu-
larized. However, the model is robust towards be-
ing shown a random context and obtains a perfor-
mance similar to the context-agnostic baseline.

http://opus.nlpl.eu/OpenSubtitles2018.php
http://opus.nlpl.eu/OpenSubtitles2018.php
http://data.statmt.org/acl18_contextnmt_data/
http://data.statmt.org/acl18_contextnmt_data/


1268

5.2 Analysis
In this section we investigate what types of con-
textual information are exploited by the model.
We study the distribution of attention to context
and perform analysis on specific subsets of the test
data. Specifically the research questions we seek
to answer are as follows:

• For the translation of which words does the
model rely on contextual history most?

• Are there any non-lexical patterns affecting
attention to context, such as sentence length
and word position?

• Can the context-aware NMT system implic-
itly learn coreference phenomena without
any feature engineering?

Since all the attentions in our model are multi-
head, by attention weights we refer to an average
over heads of per-head attention weights.

First, we would like to identify a useful attention
mass coming to context. We analyze the attention
maps between source and context, and find that the
model mostly attends to <bos> and <eos> con-
text tokens, and much less often attends to words.
Our hypothesis is that the model has found a way
to take no information from context by looking at
uninformative tokens, and it attends to words only
when it wants to pass some contextual information
to the source sentence encoder. Thus we define
useful contextual attention mass as sum of atten-
tion weights to context words, excluding <bos>
and <eos> tokens and punctuation.

5.2.1 Top words depending on context
We analyze the distribution of attention to context
for individual source words to see for which words
the model depends most on contextual history. We
compute the overall average attention to context
words for each source word in our test set. We
do the same for source words at positions higher
than first. We filter out words that occurred less
than 10 times in a test set. The top 10 words with
the highest average attention to context words are
provided in Table 2.

An interesting finding is that contextual atten-
tion is high for the translation of “it”, “yours”,
“ones”, “you” and “I”, which are indeed very am-
biguous out-of-context when translating into Rus-
sian. For example, “it” will be translated as third
person singular masculine, feminine or neuter, or
third person plural depending on its antecedent.

word attn pos word attn pos
it 0.376 5.5 it 0.342 6.8

yours 0.338 8.4 yours 0.341 8.3
yes 0.332 2.5 ones 0.318 7.5

i 0.328 3.3 ’m 0.301 4.8
yeah 0.314 1.4 you 0.287 5.6
you 0.311 4.8 am 0.274 4.4
ones 0.309 8.3 i 0.262 5.2
’m 0.298 5.1 ’s 0.260 5.6

wait 0.281 3.8 one 0.259 6.5
well 0.273 2.1 won 0.258 4.6

Table 2: Top-10 words with the highest average
attention to context words. attn gives an average
attention to context words, pos gives an average
position of the source word. Left part is for words
on all positions, right — for words on positions
higher than first.

“You” can be second person singular impolite or
polite, or plural. Also, verbs must agree in gender
and number with the translation of “you”.

It might be not obvious why “I” has high con-
textual attention, as it is not ambiguous itself.
However, in past tense, verbs must agree with “I”
in gender, so to translate past tense sentences prop-
erly, the source encoder must predict speaker gen-
der, and the context may provide useful indicators.

Most surprising is the appearance of “yes”,
“yeah”, and “well” in the list of context-dependent
words, similar to the finding by Tiedemann and
Scherrer (2017). We note that these words mostly
appear in sentence-initial position, and in rela-
tively short sentences. If only words after the first
are considered, they disappear from the top-10 list.
We hypothesize that the amount of attention to
context not only depends on the words themselves,
but also on factors such as sentence length and po-
sition, and we test this hypothesis in the next sec-
tion.

5.2.2 Dependence on sentence length and
position

We compute useful attention mass coming to con-
text by averaging over source words. Figure 2 il-
lustrates the dependence of this average attention
mass on sentence length. We observe a dispro-
portionally high attention on context for short sen-
tences, and a positive correlation between the av-
erage contextual attention and context length.

It is also interesting to see the importance given
to the context at different positions in the source



1269

Figure 2: Average attention to context words vs.
both source and context length

Figure 3: Average attention to context vs. source
token position

sentence. We compute an average attention mass
to context for a set of 1500 sentences of the same
length. As can be seen in Figure 3, words at
the beginning of a source sentence tend to attend
to context more than words at the end of a sen-
tence. This correlates with standard view that En-
glish sentences present hearer-old material before
hearer-new.

There is a clear (negative) correlation between
sentence length and the amount of attention placed
on contextual history, and between token position
and the amount of attention to context, which sug-
gests that context is especially helpful at the be-
ginning of a sentence, and for shorter sentences.
However, Figure 4 shows that there is no straight-
forward dependence of BLEU improvement on
source length. This means that while attention
on context is disproportionally high for short sen-
tences, context does not seem disproportionally
more useful for these sentences.

5.3 Analysis of pronoun translation

The analysis of the attention model indicates that
the model attends heavily to the contextual history
for the translation of some pronouns. Here, we
investigate whether this context-aware modelling
results in empirical improvements in translation

Figure 4: BLEU score vs. source sentence length

quality, and whether the model learns structures
related to anaphora resolution.

5.3.1 Ambiguous pronouns and translation
quality

Ambiguous pronouns are relatively sparse in a
general-purpose test set, and previous work has
designed targeted evaluation of pronoun transla-
tion (Hardmeier et al., 2015; Miculicich Werlen
and Popescu-Belis, 2017; Bawden et al., 2018).
However, we note that in Russian, grammati-
cal gender is not only marked on pronouns, but
also on adjectives and verbs. Rather than us-
ing a pronoun-specific evaluation, we present re-
sults with BLEU on test sets where we hypothe-
size context to be relevant, specifically sentences
containing co-referential pronouns. We feed Stan-
ford CoreNLP open-source coreference resolution
system (Manning et al., 2014a) with pairs of sen-
tences to find examples where there is a link be-
tween one of the pronouns under consideration
and the context. We focus on anaphoric instances
of “it” (this excludes, among others, pleonastic
uses of ”it”), and instances of the pronouns “I”,
“you”, and “yours” that are coreferent with an ex-
pression in the previous sentence. All these pro-
nouns express ambiguity in the translation into
Russian, and the model has learned to attend to
context for their translation (Table 2). To combat
data sparsity, the test sets are extracted from large
amounts of held-out data of OpenSubtitles2018.
Table 3 shows BLEU scores for the resulting sub-
sets.

First of all, we see that most of the antecedents
in these test sets are also pronouns. Antecedent
pronouns should not be particularly informative
for translating the source pronoun. Nevertheless,
even with such contexts, improvements are gener-
ally larger than on the overall test set.

When we focus on sentences where the an-
tecedent for pronoun under consideration contains



1270

pronoun N #pronominal antecedent baseline our model difference
it 11128 6604 25.4 26.6 +1.2
you 6398 5795 29.7 30.8 +1.1
yours 2181 2092 24.1 25.2 +1.1
I 8205 7496 30.1 30.0 -0.1

Table 3: BLEU for test sets with coreference between pronoun and a word in context sentence. We show
both N, the total number of instances in a particular test set, and number of instances with pronominal
antecedent. Significant BLEU differences are in bold.

word N baseline our model diff.
it 4524 23.9 26.1 +2.2
you 693 29.9 31.7 +1.8
I 709 29.1 29.7 +0.6

Table 4: BLEU for test sets of pronouns having a
nominal antecedent in context sentence. N: num-
ber of examples in the test set.

type N baseline our model diff.
masc. 2509 26.9 27.2 +0.3
fem. 2403 21.8 26.6 +4.8
neuter 862 22.1 24.0 +1.9
plural 1141 18.2 22.5 +4.3

Table 5: BLEU for test sets of pronoun “it” hav-
ing a nominal antecedent in context sentence. N:
number of examples in the test set.

a noun, we observe even larger improvements (Ta-
ble 4). Improvement is smaller for “I”, but we note
that verbs with first person singular subjects mark
gender only in the past tense, which limits the im-
pact of correctly predicting gender. In contrast,
different types of “you” (polite/impolite, singu-
lar/plural) lead to different translations of the pro-
noun itself plus related verbs and adjectives, lead-
ing to a larger jump in performance. Examples
of nouns co-referent with “I” and “you” include
names, titles (“Mr.”, “Mrs.”, “officer”), terms de-
noting family relationships (“Mom”, “Dad”), and
terms of endearment (“honey”, “sweetie”). Such
nouns can serve to disambiguate number and gen-
der of the speaker or addressee, and mark the level
of familiarity between them.

The most interesting case is translation of “it”,
as “it” can have many different translations into
Russian, depending on the grammatical gender of
the antecedent. In order to disentangle these cases,
we train the Berkeley aligner on 10m sentences
and use the trained model to divide the test set
with “it” referring to a noun into test sets specific
to each gender and number. Results are in Table 5.

pronoun agreement (in %)random first last attention
it 69 66 72 69
you 76 85 71 80
I 74 81 73 78

Table 6: Agreement with CoreNLP for test sets of
pronouns having a nominal antecedent in context
sentence (%).

We see an improvement of 4-5 BLEU for sen-
tences where “it” is translated into a feminine or
plural pronoun by the reference. For cases where
“it” is translated into a masculine pronoun, the im-
provement is smaller because the masculine gen-
der is more frequent, and the context-agnostic
baseline tends to translate the pronoun “it” as mas-
culine.

5.3.2 Latent anaphora resolution

The results in Tables 4 and 5 suggest that the
context-aware model exploits information about
the antecedent of an ambiguous pronoun. We hy-
pothesize that we can interpret the model’s atten-
tion mechanism as a latent anaphora resolution,
and perform experiments to test this hypothesis.

For test sets from Table 4, we find an antecedent
noun phrase (usually a determiner or a posses-
sive pronoun followed by a noun) using Stanford
CoreNLP (Manning et al., 2014b). We select only
examples where a noun phrase contains a single
noun to simplify our analysis. Then we identify
which token receives the highest attention weight
(excluding <bos> and <eos> tokens and punc-
tuation). If this token falls within the antecedent
span, then we treat it as agreement (see Table 6).

One natural question might be: does the atten-
tion component in our model genuinely learn to
perform anaphora resolution, or does it capture
some simple heuristic (e.g., pointing to the last
noun)? To answer this question, we consider sev-
eral baselines: choosing a random, last or first



1271

pronoun agreement (in %)random first last attention
it 40 36 52 58
you 42 63 29 67
I 39 56 35 62

Table 7: Agreement with CoreNLP for test sets of
pronouns having a nominal antecedent in context
sentence (%). Examples with ≥1 noun in context
sentence.

noun from the context sentence as an antecedent.
Note that an agreement of the last noun for “it”

or the first noun for “you” and “I” is very high.
This is partially due to the fact that most context
sentences have only one noun. For these examples
a random and last predictions are always correct,
meanwhile attention does not always pick a noun
as the most relevant word in the context. To get
a more clear picture let us now concentrate only
on examples where there is more than one noun in
the context (Table 7). We can now see that the at-
tention weights are in much better agreement with
the coreference system than any of the heuristics.
This indicates that the model is indeed performing
anaphora resolution.

While agreement with CoreNLP is encourag-
ing, we are aware that coreference resolution by
CoreNLP is imperfect and partial agreement with
it may not necessarily indicate that the attention is
particularly accurate. In order to control for this,
we asked human annotators to manually evaluate
500 examples from the test sets where CoreNLP
predicted that “it” refers to a noun in the con-
text sentence. More precisely, we picked random
500 examples from the test set with “it” from Ta-
ble 7. We marked the pronoun in a source which
CoreNLP found anaphoric. Assessors were given
the source and context sentences and were asked to
mark an antecedent noun phrase for a marked pro-
noun in a source sentence or say that there is no
antecedent at all. We then picked those examples
where assessors found a link from “it” to some
noun in context (79% of all examples). Then we
evaluated agreement of CoreNLP and our model
with the ground truth links. We also report the
performance of the best heuristic for “it” from our
previous analysis (i.e. last noun in context). The
results are provided in Table 8.

The agreement between our model and the
ground truth is 72%. Though 5% below the coref-
erence system, this is a lot higher than the best

agreement (in %)
CoreNLP 77
attention 72
last noun 54

Table 8: Performance of CoreNLP and our
model’s attention mechanism compared to human
assessment. Examples with ≥1 noun in context
sentence.

Figure 5: An example of an attention map between
source and context. On the y-axis are the source
tokens, on the x-axis the context tokens. Note
the high attention between “it” and its antecedent
“heart”.

CoreNLP
right wrong

attn right 53 19
attn wrong 24 4

Table 9: Performance of CoreNLP and our
model’s attention mechanism compared to human
assessment (%). Examples with ≥1 noun in con-
text sentence.

heuristic (+18%). This confirms our conclusion
that our model performs latent anaphora resolu-
tion. Interestingly, the patterns of mistakes are
quite different for CoreNLP and our model (Ta-
ble 9). We also present one example (Figure 5)
where the attention correctly predicts anaphora
while CoreNLP fails. Nevertheless, there is room
for improvement, and improving the attention
component is likely to boost translation perfor-
mance.

6 Related work

Our analysis focuses on how our context-aware
neural model implicitly captures anaphora. Early
work on anaphora phenomena in statistical ma-
chine translation has relied on external systems
for coreference resolution (Le Nagard and Koehn,
2010; Hardmeier and Federico, 2010). Results



1272

were mixed, and the low performance of corefer-
ence resolution systems was identified as a prob-
lem for this type of system. Later work by Hard-
meier et al. (2013) has shown that cross-lingual
pronoun prediction systems can implicitly learn
to resolve coreference, but this work still relied
on external feature extraction to identify anaphora
candidates. Our experiments show that a context-
aware neural machine translation system can im-
plicitly learn coreference phenomena without any
feature engineering.

Tiedemann and Scherrer (2017) and Bawden
et al. (2018) analyze the attention weights of
context-aware NMT models. Tiedemann and
Scherrer (2017) find some evidence for above-
average attention on contextual history for the
translation of pronouns, and our analysis goes fur-
ther in that we are the first to demonstrate that our
context-aware model learns latent anaphora reso-
lution through the attention mechanism. This is
contrary to Bawden et al. (2018), who do not ob-
serve increased attention between a pronoun and
its antecedent in their recurrent model. We deem
our model more suitable for analysis, since it has
no recurrent connections and fully relies on the at-
tention mechanism within a single attention layer.

7 Conclusions

We introduced a context-aware NMT system
which is based on the Transformer architecture.
When evaluated on an En-Ru parallel corpus, it
outperforms both the context-agnostic baselines
and a simple context-aware baseline. We observe
that improvements are especially prominent for
sentences containing ambiguous pronouns. We
also show that the model induces anaphora rela-
tions. We believe that further improvements in
handling anaphora, and by proxy translation, can
be achieved by incorporating specialized features
in the attention model. Our analysis has focused
on the effect of context information on pronoun
translation. Future work could also investigate
whether context-aware NMT systems learn other
discourse phenomena, for example whether they
improve the translation of elliptical constructions,
and markers of discourse relations and informa-
tion structure.

Acknowledgments

We would like to thank Bonnie Webber for helpful
discussions and annonymous reviewers for their

comments. The authors also thank David Tal-
bot and Yandex Machine Translation team for
helpful discussions and inspiration. Ivan Titov
acknowledges support of the European Research
Council (ERC StG BroadSem 678254) and the
Dutch National Science Foundation (NWO VIDI
639.022.518). Rico Sennrich has received fund-
ing from the Swiss National Science Foundation
(105212 169888).

References

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proceedings of the
Third International Conference on Learning Repre-
sentations (ICLR 2015). San Diego.

Rachel Bawden, Rico Sennrich, Alexandra Birch, and
Barry Haddow. 2018. Evaluating Discourse Phe-
nomena in Neural Machine Translation. In Pro-
ceedings of the 16th Annual Conference of the North
American Chapter of the Association for Computa-
tional Linguistics: Human Language Technologies.
New Orleans, USA.

Marine Carpuat. 2009. One Translation Per Dis-
course. In Proceedings of the Workshop on
Semantic Evaluations: Recent Achievements and
Future Directions. Association for Computational
Linguistics, Boulder, Colorado, pages 19–27.
http://www.aclweb.org/anthology/W09-2404.

Zhengxian Gong, Min Zhang, Chew Lim Tan, and
Guodong Zhou. 2012. N-gram-based tense models
for statistical machine translation. In Proceedings
of the 2012 Joint Conference on Empirical Methods
in Natural Language Processing and Computational
Natural Language Learning. Association for Com-
putational Linguistics, Jeju Island, Korea, pages
276–285. http://www.aclweb.org/anthology/D12-
1026.

Zhengxian Gong, Min Zhang, and Guodong Zhou.
2011. Cache-based Document-level Statistical Ma-
chine Translation. In Proceedings of the 2011 Con-
ference on Empirical Methods in Natural Language
Processing. Association for Computational Linguis-
tics, Edinburgh, Scotland, UK., pages 909–919.
http://www.aclweb.org/anthology/D11-1084.

Christian Hardmeier. 2012. Discourse in statistical ma-
chine translation: A survey and a case study. Dis-
cours 11.

Christian Hardmeier and Marcello Federico. 2010.
Modelling Pronominal Anaphora in Statistical Ma-
chine Translation. In Proceedings of the seventh In-
ternational Workshop on Spoken Language Transla-
tion (IWSLT). pages 283–289.

http://www.aclweb.org/anthology/W09-2404
http://www.aclweb.org/anthology/W09-2404
http://www.aclweb.org/anthology/W09-2404
http://www.aclweb.org/anthology/D12-1026
http://www.aclweb.org/anthology/D12-1026
http://www.aclweb.org/anthology/D12-1026
http://www.aclweb.org/anthology/D12-1026
http://www.aclweb.org/anthology/D11-1084
http://www.aclweb.org/anthology/D11-1084
http://www.aclweb.org/anthology/D11-1084


1273

Christian Hardmeier, Preslav Nakov, Sara Stymne, Jörg
Tiedemann, Yannick Versley, and Mauro Cettolo.
2015. Pronoun-Focused MT and Cross-Lingual
Pronoun Prediction: Findings of the 2015 Dis-
coMT Shared Task on Pronoun Translation. In
Proceedings of the Second Workshop on Discourse
in Machine Translation. Association for Computa-
tional Linguistics, Lisbon, Portugal, pages 1–16.
https://doi.org/10.18653/v1/W15-2501.

Christian Hardmeier, Jörg Tiedemann, and Joakim
Nivre. 2013. Latent anaphora resolution for cross-
lingual pronoun prediction. In Proceedings of the
2013 Conference on Empirical Methods in Natu-
ral Language Processing. Association for Computa-
tional Linguistics, Seattle, Washington, USA, pages
380–391. http://www.aclweb.org/anthology/D13-
1037.

Eva Hasler, Phil Blunsom, Philipp Koehn, and Barry
Haddow. 2014. Dynamic topic adaptation for
phrase-based mt. In Proceedings of the 14th Confer-
ence of the European Chapter of the Association for
Computational Linguistics. Association for Com-
putational Linguistics, Gothenburg, Sweden, pages
328–337. https://doi.org/10.3115/v1/E14-1035.

Sebastien Jean, Stanislas Lauly, Orhan Firat, and
Kyunghyun Cho. 2017. Does Neural Machine
Translation Benefit from Larger Context? In
arXiv:1704.05135. ArXiv: 1704.05135.

Yangfeng Ji, Chenhao Tan, Sebastian Martschat,
Yejin Choi, and Noah A Smith. 2017. Dy-
namic entity representations in neural language
models. In Proceedings of the 2017 Conference
on Empirical Methods in Natural Language Pro-
cessing. Association for Computational Linguis-
tics, Copenhagen, Denmark, pages 1830–1839.
https://doi.org/10.18653/v1/D17-1195.

Ronan Le Nagard and Philipp Koehn. 2010. Aiding
pronoun translation with co-reference resolu-
tion. In Proceedings of the Joint Fifth Work-
shop on Statistical Machine Translation and
MetricsMATR. Association for Computational
Linguistics, Uppsala, Sweden, pages 252–261.
http://www.aclweb.org/anthology/W10-1737.

Pierre Lison, Jörg Tiedemann, and Milen Kouylekov.
2018. Opensubtitles2018: Statistical rescoring of
sentence alignments in large, noisy parallel corpora.
In Proceedings of the Eleventh International Confer-
ence on Language Resources and Evaluation (LREC
2018). Miyazaki, Japan.

Christopher Manning, Mihai Surdeanu, John Bauer,
Jenny Finkel, Steven Bethard, and David McClosky.
2014a. The stanford corenlp natural language pro-
cessing toolkit. In Proceedings of 52nd Annual
Meeting of the Association for Computational Lin-
guistics: System Demonstrations. Association for
Computational Linguistics, Baltimore, Maryland,
pages 55–60. https://doi.org/10.3115/v1/P14-5010.

Christopher D. Manning, Mihai Surdeanu, John
Bauer, Jenny Finkel, Steven J. Bethard, and
David McClosky. 2014b. The Stanford CoreNLP
natural language processing toolkit. In Pro-
ceedings of 52nd Annual Meeting of the As-
sociation for Computational Linguistics: Sys-
tem Demonstrations. Association for Computational
Linguistics, Baltimore, Maryland, pages 55–60.
https://doi.org/10.3115/v1/P14-5010.

Thomas Meyer, Andrei Popescu-Belis, Najeh Hajlaoui,
and Andrea Gesmundo. 2012. Machine Transla-
tion of Labeled Discourse Connectives. In Pro-
ceedings of the Tenth Conference of the Asso-
ciation for Machine Translation in the Americas
(AMTA). http://www.mt-archive.info/AMTA-2012-
Meyer.pdf.

Lesly Miculicich Werlen and Andrei Popescu-Belis.
2017. Validation of an automatic metric for the ac-
curacy of pronoun translation (apt). In Proceed-
ings of the Third Workshop on Discourse in Ma-
chine Translation. Association for Computational
Linguistics, Copenhagen, Denmark, pages 17–25.
https://doi.org/10.18653/v1/W17-4802.

Ruslan Mitkov. 1999. Introduction: Special issue on
anaphora resolution in machine translation and mul-
tilingual nlp. Machine Translation 14(3/4):159–
161. http://www.jstor.org/stable/40006919.

Stefan Riezler and John T. Maxwell. 2005. On
some pitfalls in automatic evaluation and signif-
icance testing for mt. In Proceedings of the
ACL Workshop on Intrinsic and Extrinsic Eval-
uation Measures for Machine Translation and/or
Summarization. Association for Computational Lin-
guistics, Ann Arbor, Michigan, pages 57–64.
https://www.aclweb.org/anthology/W05-0908.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proceedings of the 54th Annual
Meeting of the Association for Computational Lin-
guistics (Volume 1: Long Papers). Association for
Computational Linguistics, Berlin, Germany, pages
1715–1725. https://doi.org/10.18653/v1/P16-1162.

Jinsong Su, Hua Wu, Haifeng Wang, Yidong Chen,
Xiaodong Shi, Huailin Dong, and Qun Liu. 2012.
Translation model adaptation for statistical machine
translation with monolingual topic information. In
Proceedings of the 50th Annual Meeting of the
Association for Computational Linguistics (Volume
1: Long Papers). Association for Computational
Linguistics, Jeju Island, Korea, pages 459–468.
http://www.aclweb.org/anthology/P12-1048.

Jörg Tiedemann. 2010. Context Adaptation in Statisti-
cal Machine Translation Using Models with Expo-
nentially Decaying Cache. In Proceedings of the
2010 Workshop on Domain Adaptation for Natu-
ral Language Processing. Association for Compu-
tational Linguistics, Uppsala, Sweden, pages 8–15.
http://www.aclweb.org/anthology/W10-2602.

https://doi.org/10.18653/v1/W15-2501
https://doi.org/10.18653/v1/W15-2501
https://doi.org/10.18653/v1/W15-2501
https://doi.org/10.18653/v1/W15-2501
http://www.aclweb.org/anthology/D13-1037
http://www.aclweb.org/anthology/D13-1037
http://www.aclweb.org/anthology/D13-1037
http://www.aclweb.org/anthology/D13-1037
https://doi.org/10.3115/v1/E14-1035
https://doi.org/10.3115/v1/E14-1035
https://doi.org/10.3115/v1/E14-1035
https://doi.org/10.18653/v1/D17-1195
https://doi.org/10.18653/v1/D17-1195
https://doi.org/10.18653/v1/D17-1195
https://doi.org/10.18653/v1/D17-1195
http://www.aclweb.org/anthology/W10-1737
http://www.aclweb.org/anthology/W10-1737
http://www.aclweb.org/anthology/W10-1737
http://www.aclweb.org/anthology/W10-1737
https://doi.org/10.3115/v1/P14-5010
https://doi.org/10.3115/v1/P14-5010
https://doi.org/10.3115/v1/P14-5010
https://doi.org/10.3115/v1/P14-5010
https://doi.org/10.3115/v1/P14-5010
https://doi.org/10.3115/v1/P14-5010
http://www.mt-archive.info/AMTA-2012-Meyer.pdf
http://www.mt-archive.info/AMTA-2012-Meyer.pdf
http://www.mt-archive.info/AMTA-2012-Meyer.pdf
http://www.mt-archive.info/AMTA-2012-Meyer.pdf
https://doi.org/10.18653/v1/W17-4802
https://doi.org/10.18653/v1/W17-4802
https://doi.org/10.18653/v1/W17-4802
http://www.jstor.org/stable/40006919
http://www.jstor.org/stable/40006919
http://www.jstor.org/stable/40006919
http://www.jstor.org/stable/40006919
https://www.aclweb.org/anthology/W05-0908
https://www.aclweb.org/anthology/W05-0908
https://www.aclweb.org/anthology/W05-0908
https://www.aclweb.org/anthology/W05-0908
https://doi.org/10.18653/v1/P16-1162
https://doi.org/10.18653/v1/P16-1162
https://doi.org/10.18653/v1/P16-1162
http://www.aclweb.org/anthology/P12-1048
http://www.aclweb.org/anthology/P12-1048
http://www.aclweb.org/anthology/P12-1048
http://www.aclweb.org/anthology/W10-2602
http://www.aclweb.org/anthology/W10-2602
http://www.aclweb.org/anthology/W10-2602
http://www.aclweb.org/anthology/W10-2602


1274

Jörg Tiedemann and Yves Scherrer. 2017. Neural Ma-
chine Translation with Extended Context. In Pro-
ceedings of the Third Workshop on Discourse in Ma-
chine Translation. Association for Computational
Linguistics, Copenhagen, Denmark, DISCOMT’17,
pages 82–92. https://doi.org/10.18653/v1/W17-
4811.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Lukasz
Kaiser, and Illia Polosukhin. 2017. Atten-
tion is all you need. In NIPS. Los Ange-
les. http://papers.nips.cc/paper/7181-attention-is-
all-you-need.pdf.

Longyue Wang, Zhaopeng Tu, Andy Way, and
Qun Liu. 2017. Exploiting Cross-Sentence Con-
text for Neural Machine Translation. In Pro-
ceedings of the 2017 Conference on Empiri-
cal Methods in Natural Language Processing.
Association for Computational Linguistics, Den-
mark, Copenhagen, EMNLP’17, pages 2816–2821.
https://doi.org/10.18653/v1/D17-1301.

Sam Wiseman, Alexander M Rush, and Stuart M
Shieber. 2016. Learning global features for coref-
erence resolution. In Proceedings of the 2016 Con-
ference of the North American Chapter of the Asso-
ciation for Computational Linguistics: Human Lan-
guage Technologies. Association for Computational
Linguistics, San Diego, California, pages 994–1004.
https://doi.org/10.18653/v1/N16-1114.

https://doi.org/10.18653/v1/W17-4811
https://doi.org/10.18653/v1/W17-4811
https://doi.org/10.18653/v1/W17-4811
https://doi.org/10.18653/v1/W17-4811
http://papers.nips.cc/paper/7181-attention-is-all-you-need.pdf
http://papers.nips.cc/paper/7181-attention-is-all-you-need.pdf
http://papers.nips.cc/paper/7181-attention-is-all-you-need.pdf
http://papers.nips.cc/paper/7181-attention-is-all-you-need.pdf
https://doi.org/10.18653/v1/D17-1301
https://doi.org/10.18653/v1/D17-1301
https://doi.org/10.18653/v1/D17-1301
https://doi.org/10.18653/v1/N16-1114
https://doi.org/10.18653/v1/N16-1114
https://doi.org/10.18653/v1/N16-1114

