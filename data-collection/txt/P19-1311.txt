



















































Cross-Lingual Syntactic Transfer through Unsupervised Adaptation of Invertible Projections


Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics, pages 3211–3223
Florence, Italy, July 28 - August 2, 2019. c©2019 Association for Computational Linguistics

3211

Cross-Lingual Syntactic Transfer through
Unsupervised Adaptation of Invertible Projections

Junxian He1, Zhisong Zhang1, Taylor Berg-Kirkpatrick2, and Graham Neubig1
1Language Technologies Institute, Carnegie Mellon University

2Department of Computer Science and Engineering, University of California San Diego
{junxianh,zhisongz,gneubig}@cs.cmu.edu, tberg@eng.ucsd.edu

Abstract

Cross-lingual transfer is an effective way to
build syntactic analysis tools in low-resource
languages. However, transfer is difficult when
transferring to typologically distant languages,
especially when neither annotated target data
nor parallel corpora are available. In this pa-
per, we focus on methods for cross-lingual
transfer to distant languages and propose to
learn a generative model with a structured
prior that utilizes labeled source data and un-
labeled target data jointly. The parameters
of source model and target model are softly
shared through a regularized log likelihood ob-
jective. An invertible projection is employed
to learn a new interlingual latent embedding
space that compensates for imperfect cross-
lingual word embedding input. We evaluate
our method on two syntactic tasks: part-of-
speech (POS) tagging and dependency pars-
ing. On the Universal Dependency Treebanks,
we use English as the only source corpus and
transfer to a wide range of target languages.
On the 10 languages in this dataset that are
distant from English, our method yields an
average of 5.2% absolute improvement on
POS tagging and 8.3% absolute improvement
on dependency parsing over a direct trans-
fer method using state-of-the-art discrimina-
tive models.1

1 Introduction

Current top performing systems on syntactic anal-
ysis tasks such as part-of-speech (POS) tagging
and dependency parsing rely heavily on large-
scale annotated data (Huang et al., 2015; Dozat
and Manning, 2017; Ma et al., 2018). How-
ever, because creating syntactic treebanks is an ex-
pensive and time consuming task, annotated data
is scarce for many languages. Prior work has

1Code is available at https://github.com/jxhe/
cross-lingual-struct-flow.

0.4 0.5 0.6 0.7 0.8
language distance to English

30

40

50

60

70

80

90

PO
S 

Ta
gg

in
g 

Ac
cu

ra
cy

% nl sv

da

no

es

fr
pt

it
bg

he

hr

hi
tr

ko

id

ja
zh

fa
ar

nearby languages
distant languages

0.4 0.5 0.6 0.7 0.8
language distance to English

30

40

50

60

70

80

90

De
pe

nd
en

cy
 P

ar
sin

g 
UA

S%

nl

sv
da

no
es

fr
pt
itbg

he
hr

hi tr ko

id

ja

zh

fa
ar

nearby languages
distant languages

Figure 1: Left: POS tagging transfer accuracy of
the Bidirectional LSTM-CRF model, Right: Depen-
dency parsing transfer UAS of the “SelfAtt-Graph”
model (Ahmad et al., 2019). These models are trained
on the labeled English corpus and directly evaluated
on different target languages. The x-axis represents
language distance to English (details in Section 2.1).
Both models take pre-trained cross-lingual word em-
beddings as input. The parsing model also uses gold
universal POS tags.

demonstrated the efficacy of cross-lingual learn-
ing methods (Guo et al., 2015; Tiedemann, 2015;
Guo et al., 2016; Zhang et al., 2016; Ammar
et al., 2016; Ahmad et al., 2019; Schuster et al.,
2019), which transfer models between different
languages through the use of shared features such
as cross-lingual word embeddings (Smith et al.,
2017; Conneau et al., 2018) or universal part-of-
speech tags (Petrov et al., 2012). In the case of
zero-shot transfer (i.e. with no target-side supervi-
sion), a common practice is to train a strong su-
pervised system on the source language and di-
rectly apply it to the target language over these
shared embedding or POS spaces. This method
has demonstrated promising results, particularly
for transfer of models to closely related target lan-
guages (Ahmad et al., 2019; Schuster et al., 2019).

However, this direct transfer approach often
produces poor performance when transferring to
more distant languages that are less similar to
the source. For example, in Figure 1 we show

https://github.com/jxhe/cross-lingual-struct-flow
https://github.com/jxhe/cross-lingual-struct-flow


3212

the results of direct transfer of POS taggers
and dependency parsers trained on only English
and evaluated on 20 target languages using pre-
trained cross-lingual word embeddings, where the
x-axis shows the linguistic distance from En-
glish calculated according to the URIEL linguis-
tic database (Littell et al., 2017) (more details in
Section 2). As we can see, these systems suf-
fer from a large performance drop when applied
to distant languages. The reasons are two-fold:
(1) Cross-lingual word embeddings of distant lan-
guage pairs are often poorly aligned with cur-
rent methods that make strong assumptions of or-
thogonality of embedding spaces (Smith et al.,
2017; Conneau et al., 2018). (2) Divergent syn-
tactic characteristics make the model trained on
the source language non-ideal, even if the cross-
lingual word embeddings are of high quality.

In this paper we take a drastically different ap-
proach from most previous work: instead of di-
rectly transferring a discriminative model trained
only on labeled data in another language, we use a
generative model that can be trained in an super-
vised fashion on labeled data in another language,
but also perform unsupervised training to directly
maximize likelihood of the target language. This
makes it possible to specifically adapt to the lan-
guage that we would like to analyze, both with
respect to the cross-lingual word embeddings and
the syntactic parameters of the model itself.

Specifically, our approach builds on two previ-
ous works. We follow a training strategy similar to
Zhang et al. (2016), who have previously demon-
strated that it is possible to do this sort of cross-
lingual unsupervised adaptation, although limited
to the sort of linear projections that we argue are
too simple for mapping between embeddings in
distant languages. To relax this limitation, we fol-
low He et al. (2018) who, in the context of fully
unsupervised learning, propose a method using
invertible projections (which is also called flow)
to learn more expressive transformation functions
while nonetheless maintaining the ability to train
in an unsupervised manner to maximize likeli-
hood. We learn this structured flow model (de-
tailed in Section 3.1) on both labeled source data
and unlabeled target data through a soft parame-
ter sharing scheme. We describe how to apply this
method to two syntactic analysis tasks: POS tag-
ging with a hidden Markov model (HMM) prior
and dependency parsing with a dependency model

Language
Category

Language Names

Distant Chinese (zh, 0.86), Persian (fa, 0.86),
Arabic (ar, 0.86), Japanese (ja, 0.71),
Indonesian (id, 0.71), Korean (ko, 0.69),
Turkish (tr, 0.62), Hindi (hi, 0.61),
Croatian (hr, 0.59), Hebrew (he, 0.57)

Nearby Bulgarian (bg, 0.50), Italian (it, 0.50),
Portuguese (pt, 0.48), French (fr, 0.46),
Spanish (es, 0.46), Norwegian (no, 0.45)
Danish (da, 0.41), Swedish (sv, 0.40)
Dutch (nl, 0.37), German (de, 0.36)

Table 1: 20 selected target languages. Numbers in the
parenthesis denote the distances to English.

with valence (DMV; Klein and Manning (2004))
prior (Section 4.3).

We evaluate our method on Universal Depen-
dencies Treebanks (v2.2) (Nivre et al., 2018),
where English is used as the only labeled source
data. 10 distant languages and 10 nearby lan-
guages are selected as the target without labels.
On 10 distant transfer cases – which we focus on in
this paper – our approach achieves an average of
5.2% absolute improvement on POS tagging and
8.3% absolute improvement on dependency pars-
ing over strong discriminative baselines. We also
analyze the performance difference between dif-
ferent systems as a function of language distance,
and provide preliminary guidance on when to use
generative models for cross-lingual transfer.

2 Difficulties of Cross-Lingual Transfer
on Distant Languages

In this section, we demonstrate the difficulties in-
volved in performing cross-lingual transfer to dis-
tant languages. Specficially, we investigate the di-
rect transfer performance as a function of language
distances by training a high-performing system on
English and then apply it to target languages. We
first introduce the measurement of language dis-
tances and selection of 20 target languages, then
study the transfer performance change on POS
tagging and dependency parsing tasks.

2.1 Language Distance

To quantify language distances, we make use of
the URIEL (Littell et al., 2017) database,2 which
represents over 8,000 languages as information-
rich typological, phylogenetic, and geographical
vectors. These vectors are sourced and predicted

2http://www.cs.cmu.edu/˜dmortens/
uriel.html

http://www.cs.cmu.edu/~dmortens/uriel.html
http://www.cs.cmu.edu/~dmortens/uriel.html


3213

from a variety of linguistic resources such as
WALS (Dryer, 2013), PHOIBLE (Moran et al.,
2014), Ethnologue (Lewis et al., 2015), and Glot-
tolog (Hammarstrm et al., 2015). Based on these
vectors, this database provides ready-to-use dis-
tance statistics between any pair of languages in-
cluded in the database in terms of various met-
rics including genetic distance, geographical dis-
tance, syntactic distance, phonological distance,
and phonetic inventory distance. These distances
are represented by values between 0 and 1. Since
phonological and inventory distances mainly char-
acterize intra-word phonetic/phonological features
that have less effect on word-level language com-
position rules, we remove these two and take the
average of genetic, geographic, and syntactic dis-
tances as our distance measure.

We rank all languages in Universal Dependen-
cies (UD) Treebanks (v2.2) (Nivre et al., 2018) ac-
cording to their distances to English, with the dis-
tant ones on the top. Then we select 10 languages
from the top that represent the distant language
group, and 10 languages from the bottom that rep-
resent the nearby language group. The selected
languages are required to meet the following two
conditions: (1) at least 1,000 unlabeled training
sentences present in the treebank since a reason-
ably large amount of unlabeled data is needed to
study the effect of unsupervised adaptation, and
(2) an offline pre-trained word embedding align-
ment matrix is available.3 The 20 selected target
languages are shown in Table 1, which contains
distant languages like Persian and Arabic, but also
closely related languages like Spanish and French.
Detailed statistical information of the selected lan-
guages and corresponding treebanks can be found
in Appendix A.

2.2 Observations
In the direct transfer experiments, we use the
pre-trained cross-lingual fastText word embed-
dings (Bojanowski et al., 2017), aligned with the
method of Smith et al. (2017). These embed-
dings are fixed during training otherwise the align-
ment would be broken. We employ a bidirectional
LSTM-CRF (Huang et al., 2015) model for POS
tagging using NCRF++ toolkit (Yang and Zhang,

3Following Ahmad et al. (2019), we use the
offline pre-trained alignment matrix present in
https://github.com/Babylonpartners/
fastText_multilingual, which contains alignment
matrices for 78 languages, which also allows comparison
with their numbers in Section 4.3.

z1
<latexit sha1_base64="jbtr+W9vpRfg2saI7YImOblkNik=">AAACCHicZVDLSgMxFM3UV62vqks3g0VwUcqMCOqu6MZlRccW2qFk0kwbmkyG5I5Qh36BuNXvcCVu/Qs/wz8wM52FbS+Ee3LuueHkBDFnGhznxyqtrK6tb5Q3K1vbO7t71f2DRy0TRahHJJeqE2BNOYuoBww47cSKYhFw2g7GN9m8/USVZjJ6gElMfYGHEQsZwWCo++e+26/WnIaTl70M3ALUUFGtfvW3N5AkETQCwrHWXdeJwU+xAkY4nVZ6iaYxJmM8pF0DIyyo9tPc6tQ+MczADqUyJwI7Z/9vpFhogWFklFnTc7OMASm5rhsVjETWsmfyu56IoB6IeiZSOtQLRiC89FMWxQnQiMx8hAm3QdpZLPaAKUqATwzARDHzFZuMsMIETHgVk5G7mMgy8M4aVw3n7rzWvC7CKqMjdIxOkYsuUBPdohbyEEFD9Ire0Lv1Yn1Yn9bXTFqyip1DNFfW9x/uTZqw</latexit><latexit sha1_base64="jbtr+W9vpRfg2saI7YImOblkNik=">AAACCHicZVDLSgMxFM3UV62vqks3g0VwUcqMCOqu6MZlRccW2qFk0kwbmkyG5I5Qh36BuNXvcCVu/Qs/wz8wM52FbS+Ee3LuueHkBDFnGhznxyqtrK6tb5Q3K1vbO7t71f2DRy0TRahHJJeqE2BNOYuoBww47cSKYhFw2g7GN9m8/USVZjJ6gElMfYGHEQsZwWCo++e+26/WnIaTl70M3ALUUFGtfvW3N5AkETQCwrHWXdeJwU+xAkY4nVZ6iaYxJmM8pF0DIyyo9tPc6tQ+MczADqUyJwI7Z/9vpFhogWFklFnTc7OMASm5rhsVjETWsmfyu56IoB6IeiZSOtQLRiC89FMWxQnQiMx8hAm3QdpZLPaAKUqATwzARDHzFZuMsMIETHgVk5G7mMgy8M4aVw3n7rzWvC7CKqMjdIxOkYsuUBPdohbyEEFD9Ire0Lv1Yn1Yn9bXTFqyip1DNFfW9x/uTZqw</latexit><latexit sha1_base64="jbtr+W9vpRfg2saI7YImOblkNik=">AAACCHicZVDLSgMxFM3UV62vqks3g0VwUcqMCOqu6MZlRccW2qFk0kwbmkyG5I5Qh36BuNXvcCVu/Qs/wz8wM52FbS+Ee3LuueHkBDFnGhznxyqtrK6tb5Q3K1vbO7t71f2DRy0TRahHJJeqE2BNOYuoBww47cSKYhFw2g7GN9m8/USVZjJ6gElMfYGHEQsZwWCo++e+26/WnIaTl70M3ALUUFGtfvW3N5AkETQCwrHWXdeJwU+xAkY4nVZ6iaYxJmM8pF0DIyyo9tPc6tQ+MczADqUyJwI7Z/9vpFhogWFklFnTc7OMASm5rhsVjETWsmfyu56IoB6IeiZSOtQLRiC89FMWxQnQiMx8hAm3QdpZLPaAKUqATwzARDHzFZuMsMIETHgVk5G7mMgy8M4aVw3n7rzWvC7CKqMjdIxOkYsuUBPdohbyEEFD9Ire0Lv1Yn1Yn9bXTFqyip1DNFfW9x/uTZqw</latexit>

z2
<latexit sha1_base64="ZNKuRe23lzCJMNesh6cRgweKXJI=">AAACCHicZVDLSgMxFM3UV62vqks3g0VwUcpMEdRd0Y3Lio4W2qFk0kwbmkyG5I5Qh36BuNXvcCVu/Qs/wz8wM52FbS+Ee3LuueHkBDFnGhznxyqtrK6tb5Q3K1vbO7t71f2DBy0TRahHJJeqE2BNOYuoBww47cSKYhFw+hiMr7P54xNVmsnoHiYx9QUeRixkBIOh7p77zX615jScvOxl4Baghopq96u/vYEkiaAREI617rpODH6KFTDC6bTSSzSNMRnjIe0aGGFBtZ/mVqf2iWEGdiiVORHYOft/I8VCCwwjo8yanptlDEjJdd2oYCSylj2T3/VEBPVA1DOR0qFeMALhhZ+yKE6ARmTmI0y4DdLOYrEHTFECfGIAJoqZr9hkhBUmYMKrmIzcxUSWgddsXDac27Na66oIq4yO0DE6RS46Ry10g9rIQwQN0St6Q+/Wi/VhfVpfM2nJKnYO0VxZ33/v75qx</latexit><latexit sha1_base64="ZNKuRe23lzCJMNesh6cRgweKXJI=">AAACCHicZVDLSgMxFM3UV62vqks3g0VwUcpMEdRd0Y3Lio4W2qFk0kwbmkyG5I5Qh36BuNXvcCVu/Qs/wz8wM52FbS+Ee3LuueHkBDFnGhznxyqtrK6tb5Q3K1vbO7t71f2DBy0TRahHJJeqE2BNOYuoBww47cSKYhFw+hiMr7P54xNVmsnoHiYx9QUeRixkBIOh7p77zX615jScvOxl4Baghopq96u/vYEkiaAREI617rpODH6KFTDC6bTSSzSNMRnjIe0aGGFBtZ/mVqf2iWEGdiiVORHYOft/I8VCCwwjo8yanptlDEjJdd2oYCSylj2T3/VEBPVA1DOR0qFeMALhhZ+yKE6ARmTmI0y4DdLOYrEHTFECfGIAJoqZr9hkhBUmYMKrmIzcxUSWgddsXDac27Na66oIq4yO0DE6RS46Ry10g9rIQwQN0St6Q+/Wi/VhfVpfM2nJKnYO0VxZ33/v75qx</latexit><latexit sha1_base64="ZNKuRe23lzCJMNesh6cRgweKXJI=">AAACCHicZVDLSgMxFM3UV62vqks3g0VwUcpMEdRd0Y3Lio4W2qFk0kwbmkyG5I5Qh36BuNXvcCVu/Qs/wz8wM52FbS+Ee3LuueHkBDFnGhznxyqtrK6tb5Q3K1vbO7t71f2DBy0TRahHJJeqE2BNOYuoBww47cSKYhFw+hiMr7P54xNVmsnoHiYx9QUeRixkBIOh7p77zX615jScvOxl4Baghopq96u/vYEkiaAREI617rpODH6KFTDC6bTSSzSNMRnjIe0aGGFBtZ/mVqf2iWEGdiiVORHYOft/I8VCCwwjo8yanptlDEjJdd2oYCSylj2T3/VEBPVA1DOR0qFeMALhhZ+yKE6ARmTmI0y4DdLOYrEHTFECfGIAJoqZr9hkhBUmYMKrmIzcxUSWgddsXDac27Na66oIq4yO0DE6RS46Ry10g9rIQwQN0St6Q+/Wi/VhfVpfM2nJKnYO0VxZ33/v75qx</latexit>

z3
<latexit sha1_base64="VwYPdoeVjXkUU912kwmjdymaS+E=">AAACCHicZVBLTsMwFHT4lvIrsGQTUSGxqKoEkIBdBRuWRRBaqY0qx3Vaq3Yc2S9IJeoJEFs4ByvElltwDG6Ak2ZB2ydZbzxvnjWeIOZMg+P8WEvLK6tr66WN8ubW9s5uZW//UctEEeoRyaVqB1hTziLqAQNO27GiWASctoLRTTZvPVGlmYweYBxTX+BBxEJGMBjq/rl31qtUnbqTl70I3AJUUVHNXuW325ckETQCwrHWHdeJwU+xAkY4nZS7iaYxJiM8oB0DIyyo9tPc6sQ+NkzfDqUyJwI7Z/9vpFhogWFolFnTM7OMASm5rhkVDEXWsmfyux6LoBaIWiZSOtRzRiC89FMWxQnQiEx9hAm3QdpZLHafKUqAjw3ARDHzFZsMscIETHhlk5E7n8gi8E7rV3Xn7rzauC7CKqFDdIROkIsuUAPdoibyEEED9Ire0Lv1Yn1Yn9bXVLpkFTsHaKas7z/xkZqy</latexit><latexit sha1_base64="VwYPdoeVjXkUU912kwmjdymaS+E=">AAACCHicZVBLTsMwFHT4lvIrsGQTUSGxqKoEkIBdBRuWRRBaqY0qx3Vaq3Yc2S9IJeoJEFs4ByvElltwDG6Ak2ZB2ydZbzxvnjWeIOZMg+P8WEvLK6tr66WN8ubW9s5uZW//UctEEeoRyaVqB1hTziLqAQNO27GiWASctoLRTTZvPVGlmYweYBxTX+BBxEJGMBjq/rl31qtUnbqTl70I3AJUUVHNXuW325ckETQCwrHWHdeJwU+xAkY4nZS7iaYxJiM8oB0DIyyo9tPc6sQ+NkzfDqUyJwI7Z/9vpFhogWFolFnTM7OMASm5rhkVDEXWsmfyux6LoBaIWiZSOtRzRiC89FMWxQnQiEx9hAm3QdpZLHafKUqAjw3ARDHzFZsMscIETHhlk5E7n8gi8E7rV3Xn7rzauC7CKqFDdIROkIsuUAPdoibyEEED9Ire0Lv1Yn1Yn9bXVLpkFTsHaKas7z/xkZqy</latexit><latexit sha1_base64="VwYPdoeVjXkUU912kwmjdymaS+E=">AAACCHicZVBLTsMwFHT4lvIrsGQTUSGxqKoEkIBdBRuWRRBaqY0qx3Vaq3Yc2S9IJeoJEFs4ByvElltwDG6Ak2ZB2ydZbzxvnjWeIOZMg+P8WEvLK6tr66WN8ubW9s5uZW//UctEEeoRyaVqB1hTziLqAQNO27GiWASctoLRTTZvPVGlmYweYBxTX+BBxEJGMBjq/rl31qtUnbqTl70I3AJUUVHNXuW325ckETQCwrHWHdeJwU+xAkY4nZS7iaYxJiM8oB0DIyyo9tPc6sQ+NkzfDqUyJwI7Z/9vpFhogWFolFnTM7OMASm5rhkVDEXWsmfyux6LoBaIWiZSOtRzRiC89FMWxQnQiEx9hAm3QdpZLHafKUqAjw3ARDHzFZsMscIETHhlk5E7n8gi8E7rV3Xn7rzauC7CKqFDdIROkIsuUAPdoibyEEED9Ire0Lv1Yn1Yn9bXVLpkFTsHaKas7z/xkZqy</latexit>

x1
<latexit sha1_base64="2HhTHyaEJkkJenBTAOB/h38YNco=">AAAB83icbVDLSsNAFL2pr1pfVZduBovgqiQi6LLoxmUF+4CmlMl00g6dTMLMjVhCf8ONC0Xc+jPu/BsnbRbaemDgcM693DMnSKQw6LrfTmltfWNzq7xd2dnd2z+oHh61TZxqxlsslrHuBtRwKRRvoUDJu4nmNAok7wST29zvPHJtRKwecJrwfkRHSoSCUbSS70cUx0GYPc0G3qBac+vuHGSVeAWpQYHmoPrlD2OWRlwhk9SYnucm2M+oRsEkn1X81PCEsgkd8Z6likbc9LN55hk5s8qQhLG2TyGZq783MhoZM40CO5lnNMteLv7n9VIMr/uZUEmKXLHFoTCVBGOSF0CGQnOGcmoJZVrYrISNqaYMbU0VW4K3/OVV0r6oe27du7+sNW6KOspwAqdwDh5cQQPuoAktYJDAM7zCm5M6L86787EYLTnFzjH8gfP5AypgkcA=</latexit><latexit sha1_base64="2HhTHyaEJkkJenBTAOB/h38YNco=">AAAB83icbVDLSsNAFL2pr1pfVZduBovgqiQi6LLoxmUF+4CmlMl00g6dTMLMjVhCf8ONC0Xc+jPu/BsnbRbaemDgcM693DMnSKQw6LrfTmltfWNzq7xd2dnd2z+oHh61TZxqxlsslrHuBtRwKRRvoUDJu4nmNAok7wST29zvPHJtRKwecJrwfkRHSoSCUbSS70cUx0GYPc0G3qBac+vuHGSVeAWpQYHmoPrlD2OWRlwhk9SYnucm2M+oRsEkn1X81PCEsgkd8Z6likbc9LN55hk5s8qQhLG2TyGZq783MhoZM40CO5lnNMteLv7n9VIMr/uZUEmKXLHFoTCVBGOSF0CGQnOGcmoJZVrYrISNqaYMbU0VW4K3/OVV0r6oe27du7+sNW6KOspwAqdwDh5cQQPuoAktYJDAM7zCm5M6L86787EYLTnFzjH8gfP5AypgkcA=</latexit><latexit sha1_base64="2HhTHyaEJkkJenBTAOB/h38YNco=">AAAB83icbVDLSsNAFL2pr1pfVZduBovgqiQi6LLoxmUF+4CmlMl00g6dTMLMjVhCf8ONC0Xc+jPu/BsnbRbaemDgcM693DMnSKQw6LrfTmltfWNzq7xd2dnd2z+oHh61TZxqxlsslrHuBtRwKRRvoUDJu4nmNAok7wST29zvPHJtRKwecJrwfkRHSoSCUbSS70cUx0GYPc0G3qBac+vuHGSVeAWpQYHmoPrlD2OWRlwhk9SYnucm2M+oRsEkn1X81PCEsgkd8Z6likbc9LN55hk5s8qQhLG2TyGZq783MhoZM40CO5lnNMteLv7n9VIMr/uZUEmKXLHFoTCVBGOSF0CGQnOGcmoJZVrYrISNqaYMbU0VW4K3/OVV0r6oe27du7+sNW6KOspwAqdwDh5cQQPuoAktYJDAM7zCm5M6L86787EYLTnFzjH8gfP5AypgkcA=</latexit><latexit sha1_base64="2HhTHyaEJkkJenBTAOB/h38YNco=">AAAB83icbVDLSsNAFL2pr1pfVZduBovgqiQi6LLoxmUF+4CmlMl00g6dTMLMjVhCf8ONC0Xc+jPu/BsnbRbaemDgcM693DMnSKQw6LrfTmltfWNzq7xd2dnd2z+oHh61TZxqxlsslrHuBtRwKRRvoUDJu4nmNAok7wST29zvPHJtRKwecJrwfkRHSoSCUbSS70cUx0GYPc0G3qBac+vuHGSVeAWpQYHmoPrlD2OWRlwhk9SYnucm2M+oRsEkn1X81PCEsgkd8Z6likbc9LN55hk5s8qQhLG2TyGZq783MhoZM40CO5lnNMteLv7n9VIMr/uZUEmKXLHFoTCVBGOSF0CGQnOGcmoJZVrYrISNqaYMbU0VW4K3/OVV0r6oe27du7+sNW6KOspwAqdwDh5cQQPuoAktYJDAM7zCm5M6L86787EYLTnFzjH8gfP5AypgkcA=</latexit>

x2
<latexit sha1_base64="/xhoKoWR751dxO/nYLz15N6jlLs=">AAAB83icbVDLSsNAFL3xWeur6tLNYBFclaQIuiy6cVnBPqApZTK9aYdOJmFmIpbQ33DjQhG3/ow7/8ZJm4W2Hhg4nHMv98wJEsG1cd1vZ219Y3Nru7RT3t3bPzisHB23dZwqhi0Wi1h1A6pRcIktw43AbqKQRoHATjC5zf3OIyrNY/lgpgn2IzqSPOSMGiv5fkTNOAizp9mgPqhU3Zo7B1klXkGqUKA5qHz5w5ilEUrDBNW657mJ6WdUGc4Ezsp+qjGhbEJH2LNU0gh1P5tnnpFzqwxJGCv7pCFz9fdGRiOtp1FgJ/OMetnLxf+8XmrC637GZZIalGxxKEwFMTHJCyBDrpAZMbWEMsVtVsLGVFFmbE1lW4K3/OVV0q7XPLfm3V9WGzdFHSU4hTO4AA+uoAF30IQWMEjgGV7hzUmdF+fd+ViMrjnFzgn8gfP5AyvkkcE=</latexit><latexit sha1_base64="/xhoKoWR751dxO/nYLz15N6jlLs=">AAAB83icbVDLSsNAFL3xWeur6tLNYBFclaQIuiy6cVnBPqApZTK9aYdOJmFmIpbQ33DjQhG3/ow7/8ZJm4W2Hhg4nHMv98wJEsG1cd1vZ219Y3Nru7RT3t3bPzisHB23dZwqhi0Wi1h1A6pRcIktw43AbqKQRoHATjC5zf3OIyrNY/lgpgn2IzqSPOSMGiv5fkTNOAizp9mgPqhU3Zo7B1klXkGqUKA5qHz5w5ilEUrDBNW657mJ6WdUGc4Ezsp+qjGhbEJH2LNU0gh1P5tnnpFzqwxJGCv7pCFz9fdGRiOtp1FgJ/OMetnLxf+8XmrC637GZZIalGxxKEwFMTHJCyBDrpAZMbWEMsVtVsLGVFFmbE1lW4K3/OVV0q7XPLfm3V9WGzdFHSU4hTO4AA+uoAF30IQWMEjgGV7hzUmdF+fd+ViMrjnFzgn8gfP5AyvkkcE=</latexit><latexit sha1_base64="/xhoKoWR751dxO/nYLz15N6jlLs=">AAAB83icbVDLSsNAFL3xWeur6tLNYBFclaQIuiy6cVnBPqApZTK9aYdOJmFmIpbQ33DjQhG3/ow7/8ZJm4W2Hhg4nHMv98wJEsG1cd1vZ219Y3Nru7RT3t3bPzisHB23dZwqhi0Wi1h1A6pRcIktw43AbqKQRoHATjC5zf3OIyrNY/lgpgn2IzqSPOSMGiv5fkTNOAizp9mgPqhU3Zo7B1klXkGqUKA5qHz5w5ilEUrDBNW657mJ6WdUGc4Ezsp+qjGhbEJH2LNU0gh1P5tnnpFzqwxJGCv7pCFz9fdGRiOtp1FgJ/OMetnLxf+8XmrC637GZZIalGxxKEwFMTHJCyBDrpAZMbWEMsVtVsLGVFFmbE1lW4K3/OVV0q7XPLfm3V9WGzdFHSU4hTO4AA+uoAF30IQWMEjgGV7hzUmdF+fd+ViMrjnFzgn8gfP5AyvkkcE=</latexit><latexit sha1_base64="/xhoKoWR751dxO/nYLz15N6jlLs=">AAAB83icbVDLSsNAFL3xWeur6tLNYBFclaQIuiy6cVnBPqApZTK9aYdOJmFmIpbQ33DjQhG3/ow7/8ZJm4W2Hhg4nHMv98wJEsG1cd1vZ219Y3Nru7RT3t3bPzisHB23dZwqhi0Wi1h1A6pRcIktw43AbqKQRoHATjC5zf3OIyrNY/lgpgn2IzqSPOSMGiv5fkTNOAizp9mgPqhU3Zo7B1klXkGqUKA5qHz5w5ilEUrDBNW657mJ6WdUGc4Ezsp+qjGhbEJH2LNU0gh1P5tnnpFzqwxJGCv7pCFz9fdGRiOtp1FgJ/OMetnLxf+8XmrC637GZZIalGxxKEwFMTHJCyBDrpAZMbWEMsVtVsLGVFFmbE1lW4K3/OVV0q7XPLfm3V9WGzdFHSU4hTO4AA+uoAF30IQWMEjgGV7hzUmdF+fd+ViMrjnFzgn8gfP5AyvkkcE=</latexit>

x3
<latexit sha1_base64="7sikxe2TJ1ePgYWw26lqNsE8Uck=">AAAB83icbVBNS8NAFHypX7V+VT16WSyCp5KooMeiF48VbC00pWy2L+3SzSbsbsQS+je8eFDEq3/Gm//GTZuDtg4sDDPv8WYnSATXxnW/ndLK6tr6RnmzsrW9s7tX3T9o6zhVDFssFrHqBFSj4BJbhhuBnUQhjQKBD8H4JvcfHlFpHst7M0mwF9Gh5CFn1FjJ9yNqRkGYPU375/1qza27M5Bl4hWkBgWa/eqXP4hZGqE0TFCtu56bmF5GleFM4LTipxoTysZ0iF1LJY1Q97JZ5ik5scqAhLGyTxoyU39vZDTSehIFdjLPqBe9XPzP66YmvOplXCapQcnmh8JUEBOTvAAy4AqZERNLKFPcZiVsRBVlxtZUsSV4i19eJu2zuufWvbuLWuO6qKMMR3AMp+DBJTTgFprQAgYJPMMrvDmp8+K8Ox/z0ZJT7BzCHzifPy1okcI=</latexit><latexit sha1_base64="7sikxe2TJ1ePgYWw26lqNsE8Uck=">AAAB83icbVBNS8NAFHypX7V+VT16WSyCp5KooMeiF48VbC00pWy2L+3SzSbsbsQS+je8eFDEq3/Gm//GTZuDtg4sDDPv8WYnSATXxnW/ndLK6tr6RnmzsrW9s7tX3T9o6zhVDFssFrHqBFSj4BJbhhuBnUQhjQKBD8H4JvcfHlFpHst7M0mwF9Gh5CFn1FjJ9yNqRkGYPU375/1qza27M5Bl4hWkBgWa/eqXP4hZGqE0TFCtu56bmF5GleFM4LTipxoTysZ0iF1LJY1Q97JZ5ik5scqAhLGyTxoyU39vZDTSehIFdjLPqBe9XPzP66YmvOplXCapQcnmh8JUEBOTvAAy4AqZERNLKFPcZiVsRBVlxtZUsSV4i19eJu2zuufWvbuLWuO6qKMMR3AMp+DBJTTgFprQAgYJPMMrvDmp8+K8Ox/z0ZJT7BzCHzifPy1okcI=</latexit><latexit sha1_base64="7sikxe2TJ1ePgYWw26lqNsE8Uck=">AAAB83icbVBNS8NAFHypX7V+VT16WSyCp5KooMeiF48VbC00pWy2L+3SzSbsbsQS+je8eFDEq3/Gm//GTZuDtg4sDDPv8WYnSATXxnW/ndLK6tr6RnmzsrW9s7tX3T9o6zhVDFssFrHqBFSj4BJbhhuBnUQhjQKBD8H4JvcfHlFpHst7M0mwF9Gh5CFn1FjJ9yNqRkGYPU375/1qza27M5Bl4hWkBgWa/eqXP4hZGqE0TFCtu56bmF5GleFM4LTipxoTysZ0iF1LJY1Q97JZ5ik5scqAhLGyTxoyU39vZDTSehIFdjLPqBe9XPzP66YmvOplXCapQcnmh8JUEBOTvAAy4AqZERNLKFPcZiVsRBVlxtZUsSV4i19eJu2zuufWvbuLWuO6qKMMR3AMp+DBJTTgFprQAgYJPMMrvDmp8+K8Ox/z0ZJT7BzCHzifPy1okcI=</latexit><latexit sha1_base64="7sikxe2TJ1ePgYWw26lqNsE8Uck=">AAAB83icbVBNS8NAFHypX7V+VT16WSyCp5KooMeiF48VbC00pWy2L+3SzSbsbsQS+je8eFDEq3/Gm//GTZuDtg4sDDPv8WYnSATXxnW/ndLK6tr6RnmzsrW9s7tX3T9o6zhVDFssFrHqBFSj4BJbhhuBnUQhjQKBD8H4JvcfHlFpHst7M0mwF9Gh5CFn1FjJ9yNqRkGYPU375/1qza27M5Bl4hWkBgWa/eqXP4hZGqE0TFCtu56bmF5GleFM4LTipxoTysZ0iF1LJY1Q97JZ5ik5scqAhLGyTxoyU39vZDTSehIFdjLPqBe9XPzP66YmvOplXCapQcnmh8JUEBOTvAAy4AqZERNLKFPcZiVsRBVlxtZUsSV4i19eJu2zuufWvbuLWuO6qKMMR3AMp+DBJTTgFprQAgYJPMMrvDmp8+K8Ox/z0ZJT7BzCHzifPy1okcI=</latexit>

e3
<latexit sha1_base64="T0xafC3gI5PMvzG8a4QNBgEsbwg=">AAAB83icbVDLSsNAFL2pr1pfVZduBovgqiQq6LLoxmUF+4AmlMn0ph06mYSZiVBCf8ONC0Xc+jPu/BunbRbaemDgcM693DMnTAXXxnW/ndLa+sbmVnm7srO7t39QPTxq6yRTDFssEYnqhlSj4BJbhhuB3VQhjUOBnXB8N/M7T6g0T+SjmaQYxHQoecQZNVby/ZiaURjlOO1f9qs1t+7OQVaJV5AaFGj2q1/+IGFZjNIwQbXueW5qgpwqw5nAacXPNKaUjekQe5ZKGqMO8nnmKTmzyoBEibJPGjJXf2/kNNZ6Eod2cpZRL3sz8T+vl5noJsi5TDODki0ORZkgJiGzAsiAK2RGTCyhTHGblbARVZQZW1PFluAtf3mVtC/qnlv3Hq5qjduijjKcwCmcgwfX0IB7aEILGKTwDK/w5mTOi/PufCxGS06xcwx/4Hz+ABBjka8=</latexit><latexit sha1_base64="T0xafC3gI5PMvzG8a4QNBgEsbwg=">AAAB83icbVDLSsNAFL2pr1pfVZduBovgqiQq6LLoxmUF+4AmlMn0ph06mYSZiVBCf8ONC0Xc+jPu/BunbRbaemDgcM693DMnTAXXxnW/ndLa+sbmVnm7srO7t39QPTxq6yRTDFssEYnqhlSj4BJbhhuB3VQhjUOBnXB8N/M7T6g0T+SjmaQYxHQoecQZNVby/ZiaURjlOO1f9qs1t+7OQVaJV5AaFGj2q1/+IGFZjNIwQbXueW5qgpwqw5nAacXPNKaUjekQe5ZKGqMO8nnmKTmzyoBEibJPGjJXf2/kNNZ6Eod2cpZRL3sz8T+vl5noJsi5TDODki0ORZkgJiGzAsiAK2RGTCyhTHGblbARVZQZW1PFluAtf3mVtC/qnlv3Hq5qjduijjKcwCmcgwfX0IB7aEILGKTwDK/w5mTOi/PufCxGS06xcwx/4Hz+ABBjka8=</latexit><latexit sha1_base64="T0xafC3gI5PMvzG8a4QNBgEsbwg=">AAAB83icbVDLSsNAFL2pr1pfVZduBovgqiQq6LLoxmUF+4AmlMn0ph06mYSZiVBCf8ONC0Xc+jPu/BunbRbaemDgcM693DMnTAXXxnW/ndLa+sbmVnm7srO7t39QPTxq6yRTDFssEYnqhlSj4BJbhhuB3VQhjUOBnXB8N/M7T6g0T+SjmaQYxHQoecQZNVby/ZiaURjlOO1f9qs1t+7OQVaJV5AaFGj2q1/+IGFZjNIwQbXueW5qgpwqw5nAacXPNKaUjekQe5ZKGqMO8nnmKTmzyoBEibJPGjJXf2/kNNZ6Eod2cpZRL3sz8T+vl5noJsi5TDODki0ORZkgJiGzAsiAK2RGTCyhTHGblbARVZQZW1PFluAtf3mVtC/qnlv3Hq5qjduijjKcwCmcgwfX0IB7aEILGKTwDK/w5mTOi/PufCxGS06xcwx/4Hz+ABBjka8=</latexit><latexit sha1_base64="T0xafC3gI5PMvzG8a4QNBgEsbwg=">AAAB83icbVDLSsNAFL2pr1pfVZduBovgqiQq6LLoxmUF+4AmlMn0ph06mYSZiVBCf8ONC0Xc+jPu/BunbRbaemDgcM693DMnTAXXxnW/ndLa+sbmVnm7srO7t39QPTxq6yRTDFssEYnqhlSj4BJbhhuB3VQhjUOBnXB8N/M7T6g0T+SjmaQYxHQoecQZNVby/ZiaURjlOO1f9qs1t+7OQVaJV5AaFGj2q1/+IGFZjNIwQbXueW5qgpwqw5nAacXPNKaUjekQe5ZKGqMO8nnmKTmzyoBEibJPGjJXf2/kNNZ6Eod2cpZRL3sz8T+vl5noJsi5TDODki0ORZkgJiGzAsiAK2RGTCyhTHGblbARVZQZW1PFluAtf3mVtC/qnlv3Hq5qjduijjKcwCmcgwfX0IB7aEILGKTwDK/w5mTOi/PufCxGS06xcwx/4Hz+ABBjka8=</latexit>

e2
<latexit sha1_base64="Tg2IblW3A5cGR/EL2kChnHLfo/8=">AAAB83icbVDLSsNAFL2pr1pfVZduBovgqiRF0GXRjcsK9gFNKZPpTTt0MgkzE6GE/oYbF4q49Wfc+TdO2iy09cDA4Zx7uWdOkAiujet+O6WNza3tnfJuZW//4PCoenzS0XGqGLZZLGLVC6hGwSW2DTcCe4lCGgUCu8H0Lve7T6g0j+WjmSU4iOhY8pAzaqzk+xE1kyDMcD5sDKs1t+4uQNaJV5AaFGgNq1/+KGZphNIwQbXue25iBhlVhjOB84qfakwom9Ix9i2VNEI9yBaZ5+TCKiMSxso+achC/b2R0UjrWRTYyTyjXvVy8T+vn5rwZpBxmaQGJVseClNBTEzyAsiIK2RGzCyhTHGblbAJVZQZW1PFluCtfnmddBp1z617D1e15m1RRxnO4BwuwYNraMI9tKANDBJ4hld4c1LnxXl3PpajJafYOYU/cD5/AA7fka4=</latexit><latexit sha1_base64="Tg2IblW3A5cGR/EL2kChnHLfo/8=">AAAB83icbVDLSsNAFL2pr1pfVZduBovgqiRF0GXRjcsK9gFNKZPpTTt0MgkzE6GE/oYbF4q49Wfc+TdO2iy09cDA4Zx7uWdOkAiujet+O6WNza3tnfJuZW//4PCoenzS0XGqGLZZLGLVC6hGwSW2DTcCe4lCGgUCu8H0Lve7T6g0j+WjmSU4iOhY8pAzaqzk+xE1kyDMcD5sDKs1t+4uQNaJV5AaFGgNq1/+KGZphNIwQbXue25iBhlVhjOB84qfakwom9Ix9i2VNEI9yBaZ5+TCKiMSxso+achC/b2R0UjrWRTYyTyjXvVy8T+vn5rwZpBxmaQGJVseClNBTEzyAsiIK2RGzCyhTHGblbAJVZQZW1PFluCtfnmddBp1z617D1e15m1RRxnO4BwuwYNraMI9tKANDBJ4hld4c1LnxXl3PpajJafYOYU/cD5/AA7fka4=</latexit><latexit sha1_base64="Tg2IblW3A5cGR/EL2kChnHLfo/8=">AAAB83icbVDLSsNAFL2pr1pfVZduBovgqiRF0GXRjcsK9gFNKZPpTTt0MgkzE6GE/oYbF4q49Wfc+TdO2iy09cDA4Zx7uWdOkAiujet+O6WNza3tnfJuZW//4PCoenzS0XGqGLZZLGLVC6hGwSW2DTcCe4lCGgUCu8H0Lve7T6g0j+WjmSU4iOhY8pAzaqzk+xE1kyDMcD5sDKs1t+4uQNaJV5AaFGgNq1/+KGZphNIwQbXue25iBhlVhjOB84qfakwom9Ix9i2VNEI9yBaZ5+TCKiMSxso+achC/b2R0UjrWRTYyTyjXvVy8T+vn5rwZpBxmaQGJVseClNBTEzyAsiIK2RGzCyhTHGblbAJVZQZW1PFluCtfnmddBp1z617D1e15m1RRxnO4BwuwYNraMI9tKANDBJ4hld4c1LnxXl3PpajJafYOYU/cD5/AA7fka4=</latexit><latexit sha1_base64="Tg2IblW3A5cGR/EL2kChnHLfo/8=">AAAB83icbVDLSsNAFL2pr1pfVZduBovgqiRF0GXRjcsK9gFNKZPpTTt0MgkzE6GE/oYbF4q49Wfc+TdO2iy09cDA4Zx7uWdOkAiujet+O6WNza3tnfJuZW//4PCoenzS0XGqGLZZLGLVC6hGwSW2DTcCe4lCGgUCu8H0Lve7T6g0j+WjmSU4iOhY8pAzaqzk+xE1kyDMcD5sDKs1t+4uQNaJV5AaFGgNq1/+KGZphNIwQbXue25iBhlVhjOB84qfakwom9Ix9i2VNEI9yBaZ5+TCKiMSxso+achC/b2R0UjrWRTYyTyjXvVy8T+vn5rwZpBxmaQGJVseClNBTEzyAsiIK2RGzCyhTHGblbAJVZQZW1PFluCtfnmddBp1z617D1e15m1RRxnO4BwuwYNraMI9tKANDBJ4hld4c1LnxXl3PpajJafYOYU/cD5/AA7fka4=</latexit>

e1
<latexit sha1_base64="lYE4z03Y7EMd5kkOh7HTRFWoh4U=">AAAB83icbVBNS8NAFHypX7V+VT16WSyCp5KIoMeiF48VbC00oWy2L+3SzSbsboQS+je8eFDEq3/Gm//GTZuDtg4sDDPv8WYnTAXXxnW/ncra+sbmVnW7trO7t39QPzzq6iRTDDssEYnqhVSj4BI7hhuBvVQhjUOBj+HktvAfn1BpnsgHM00xiOlI8ogzaqzk+zE14zDKcTbwBvWG23TnIKvEK0kDSrQH9S9/mLAsRmmYoFr3PTc1QU6V4UzgrOZnGlPKJnSEfUsljVEH+TzzjJxZZUiiRNknDZmrvzdyGms9jUM7WWTUy14h/uf1MxNdBzmXaWZQssWhKBPEJKQogAy5QmbE1BLKFLdZCRtTRZmxNdVsCd7yl1dJ96LpuU3v/rLRuinrqMIJnMI5eHAFLbiDNnSAQQrP8ApvTua8OO/Ox2K04pQ7x/AHzucPDVuRrQ==</latexit><latexit sha1_base64="lYE4z03Y7EMd5kkOh7HTRFWoh4U=">AAAB83icbVBNS8NAFHypX7V+VT16WSyCp5KIoMeiF48VbC00oWy2L+3SzSbsboQS+je8eFDEq3/Gm//GTZuDtg4sDDPv8WYnTAXXxnW/ncra+sbmVnW7trO7t39QPzzq6iRTDDssEYnqhVSj4BI7hhuBvVQhjUOBj+HktvAfn1BpnsgHM00xiOlI8ogzaqzk+zE14zDKcTbwBvWG23TnIKvEK0kDSrQH9S9/mLAsRmmYoFr3PTc1QU6V4UzgrOZnGlPKJnSEfUsljVEH+TzzjJxZZUiiRNknDZmrvzdyGms9jUM7WWTUy14h/uf1MxNdBzmXaWZQssWhKBPEJKQogAy5QmbE1BLKFLdZCRtTRZmxNdVsCd7yl1dJ96LpuU3v/rLRuinrqMIJnMI5eHAFLbiDNnSAQQrP8ApvTua8OO/Ox2K04pQ7x/AHzucPDVuRrQ==</latexit><latexit sha1_base64="lYE4z03Y7EMd5kkOh7HTRFWoh4U=">AAAB83icbVBNS8NAFHypX7V+VT16WSyCp5KIoMeiF48VbC00oWy2L+3SzSbsboQS+je8eFDEq3/Gm//GTZuDtg4sDDPv8WYnTAXXxnW/ncra+sbmVnW7trO7t39QPzzq6iRTDDssEYnqhVSj4BI7hhuBvVQhjUOBj+HktvAfn1BpnsgHM00xiOlI8ogzaqzk+zE14zDKcTbwBvWG23TnIKvEK0kDSrQH9S9/mLAsRmmYoFr3PTc1QU6V4UzgrOZnGlPKJnSEfUsljVEH+TzzjJxZZUiiRNknDZmrvzdyGms9jUM7WWTUy14h/uf1MxNdBzmXaWZQssWhKBPEJKQogAy5QmbE1BLKFLdZCRtTRZmxNdVsCd7yl1dJ96LpuU3v/rLRuinrqMIJnMI5eHAFLbiDNnSAQQrP8ApvTua8OO/Ox2K04pQ7x/AHzucPDVuRrQ==</latexit><latexit sha1_base64="lYE4z03Y7EMd5kkOh7HTRFWoh4U=">AAAB83icbVBNS8NAFHypX7V+VT16WSyCp5KIoMeiF48VbC00oWy2L+3SzSbsboQS+je8eFDEq3/Gm//GTZuDtg4sDDPv8WYnTAXXxnW/ncra+sbmVnW7trO7t39QPzzq6iRTDDssEYnqhVSj4BI7hhuBvVQhjUOBj+HktvAfn1BpnsgHM00xiOlI8ogzaqzk+zE14zDKcTbwBvWG23TnIKvEK0kDSrQH9S9/mLAsRmmYoFr3PTc1QU6V4UzgrOZnGlPKJnSEfUsljVEH+TzzjJxZZUiiRNknDZmrvzdyGms9jUM7WWTUy14h/uf1MxNdBzmXaWZQssWhKBPEJKQogAy5QmbE1BLKFLdZCRtTRZmxNdVsCd7yl1dJ96LpuU3v/rLRuinrqMIJnMI5eHAFLbiDNnSAQQrP8ApvTua8OO/Ox2K04pQ7x/AHzucPDVuRrQ==</latexit>

xi = f�(ei)
<latexit sha1_base64="qh5OBA1S/e2+Db3eZYNh3vsEqz4=">AAACI3icbVDLSsNAFJ34rPUVdelmsAjVRUlE0I1QdOOygn1AU8JkOmmHzkzCzEQsIf/gT/gLbnXvTty4cOOXOGkjaOuBC4dz7uXee4KYUaUd58NaWFxaXlktrZXXNza3tu2d3ZaKEolJE0cskp0AKcKoIE1NNSOdWBLEA0bawegq99t3RCoaiVs9jkmPo4GgIcVIG8m3jz2O9DAI0/vMp/AChn7qBTz14iHNsuqPSYx55NsVp+ZMAOeJW5AKKNDw7S+vH+GEE6ExQ0p1XSfWvRRJTTEjWdlLFIkRHqEB6RoqECeql05+yuChUfowjKQpoeFE/T2RIq7UmAemMz9SzXq5+K8X8JnNOjzvpVTEiSYCTxeHCYM6gnlgsE8lwZqNDUFYUnM7xEMkEdYm1rIJxZ2NYJ60TmquU3NvTiv1yyKeEtgHB6AKXHAG6uAaNEATYPAAnsAzeLEerVfrzXqfti5Yxcwe+APr8xvKoaU5</latexit><latexit sha1_base64="qh5OBA1S/e2+Db3eZYNh3vsEqz4=">AAACI3icbVDLSsNAFJ34rPUVdelmsAjVRUlE0I1QdOOygn1AU8JkOmmHzkzCzEQsIf/gT/gLbnXvTty4cOOXOGkjaOuBC4dz7uXee4KYUaUd58NaWFxaXlktrZXXNza3tu2d3ZaKEolJE0cskp0AKcKoIE1NNSOdWBLEA0bawegq99t3RCoaiVs9jkmPo4GgIcVIG8m3jz2O9DAI0/vMp/AChn7qBTz14iHNsuqPSYx55NsVp+ZMAOeJW5AKKNDw7S+vH+GEE6ExQ0p1XSfWvRRJTTEjWdlLFIkRHqEB6RoqECeql05+yuChUfowjKQpoeFE/T2RIq7UmAemMz9SzXq5+K8X8JnNOjzvpVTEiSYCTxeHCYM6gnlgsE8lwZqNDUFYUnM7xEMkEdYm1rIJxZ2NYJ60TmquU3NvTiv1yyKeEtgHB6AKXHAG6uAaNEATYPAAnsAzeLEerVfrzXqfti5Yxcwe+APr8xvKoaU5</latexit><latexit sha1_base64="qh5OBA1S/e2+Db3eZYNh3vsEqz4=">AAACI3icbVDLSsNAFJ34rPUVdelmsAjVRUlE0I1QdOOygn1AU8JkOmmHzkzCzEQsIf/gT/gLbnXvTty4cOOXOGkjaOuBC4dz7uXee4KYUaUd58NaWFxaXlktrZXXNza3tu2d3ZaKEolJE0cskp0AKcKoIE1NNSOdWBLEA0bawegq99t3RCoaiVs9jkmPo4GgIcVIG8m3jz2O9DAI0/vMp/AChn7qBTz14iHNsuqPSYx55NsVp+ZMAOeJW5AKKNDw7S+vH+GEE6ExQ0p1XSfWvRRJTTEjWdlLFIkRHqEB6RoqECeql05+yuChUfowjKQpoeFE/T2RIq7UmAemMz9SzXq5+K8X8JnNOjzvpVTEiSYCTxeHCYM6gnlgsE8lwZqNDUFYUnM7xEMkEdYm1rIJxZ2NYJ60TmquU3NvTiv1yyKeEtgHB6AKXHAG6uAaNEATYPAAnsAzeLEerVfrzXqfti5Yxcwe+APr8xvKoaU5</latexit><latexit sha1_base64="qh5OBA1S/e2+Db3eZYNh3vsEqz4=">AAACI3icbVDLSsNAFJ34rPUVdelmsAjVRUlE0I1QdOOygn1AU8JkOmmHzkzCzEQsIf/gT/gLbnXvTty4cOOXOGkjaOuBC4dz7uXee4KYUaUd58NaWFxaXlktrZXXNza3tu2d3ZaKEolJE0cskp0AKcKoIE1NNSOdWBLEA0bawegq99t3RCoaiVs9jkmPo4GgIcVIG8m3jz2O9DAI0/vMp/AChn7qBTz14iHNsuqPSYx55NsVp+ZMAOeJW5AKKNDw7S+vH+GEE6ExQ0p1XSfWvRRJTTEjWdlLFIkRHqEB6RoqECeql05+yuChUfowjKQpoeFE/T2RIq7UmAemMz9SzXq5+K8X8JnNOjzvpVTEiSYCTxeHCYM6gnlgsE8lwZqNDUFYUnM7xEMkEdYm1rIJxZ2NYJ60TmquU3NvTiv1yyKeEtgHB6AKXHAG6uAaNEATYPAAnsAzeLEerVfrzXqfti5Yxcwe+APr8xvKoaU5</latexit>

z ⇠ Syntactic Prior
<latexit sha1_base64="lhmpRI11I8WlXEXYrMDla5/vPcM=">AAACH3icbZC7TsMwFIYdrqXcCowsFhWIqUoQEowVLIxF0IvUVJXjOq1V24nsE0SJ8ga8BK/ACjsbYu3Kk+C0HaDlSJZ+/f85PvYXxIIbcN2xs7S8srq2Xtgobm5t7+yW9vYbJko0ZXUaiUi3AmKY4IrVgYNgrVgzIgPBmsHwOs+bD0wbHql7GMWsI0lf8ZBTAtbqlk58SWAQhOlThn3DJfaBPUJ6N1JAKHCKa5pHOuuWym7FnRReFN5MlNGsat3St9+LaCKZAiqIMW3PjaGTEm3vFCwr+olhMaFD0mdtKxWRzHTSyX8yfGydHg4jbY8CPHF/T6REGjOSge3MX2/ms9z8Nwvk3GYILzspV3ECTNHp4jARGCKcw8I9rhkFMbKCUM1zHnRAtCVjkRYtFG8ewaJonFU8t+LdnperVzM8BXSIjtAp8tAFqqIbVEN1RNEzekVv6N15cT6cT+dr2rrkzGYO0J9yxj8qoKPp</latexit><latexit sha1_base64="lhmpRI11I8WlXEXYrMDla5/vPcM=">AAACH3icbZC7TsMwFIYdrqXcCowsFhWIqUoQEowVLIxF0IvUVJXjOq1V24nsE0SJ8ga8BK/ACjsbYu3Kk+C0HaDlSJZ+/f85PvYXxIIbcN2xs7S8srq2Xtgobm5t7+yW9vYbJko0ZXUaiUi3AmKY4IrVgYNgrVgzIgPBmsHwOs+bD0wbHql7GMWsI0lf8ZBTAtbqlk58SWAQhOlThn3DJfaBPUJ6N1JAKHCKa5pHOuuWym7FnRReFN5MlNGsat3St9+LaCKZAiqIMW3PjaGTEm3vFCwr+olhMaFD0mdtKxWRzHTSyX8yfGydHg4jbY8CPHF/T6REGjOSge3MX2/ms9z8Nwvk3GYILzspV3ECTNHp4jARGCKcw8I9rhkFMbKCUM1zHnRAtCVjkRYtFG8ewaJonFU8t+LdnperVzM8BXSIjtAp8tAFqqIbVEN1RNEzekVv6N15cT6cT+dr2rrkzGYO0J9yxj8qoKPp</latexit><latexit sha1_base64="lhmpRI11I8WlXEXYrMDla5/vPcM=">AAACH3icbZC7TsMwFIYdrqXcCowsFhWIqUoQEowVLIxF0IvUVJXjOq1V24nsE0SJ8ga8BK/ACjsbYu3Kk+C0HaDlSJZ+/f85PvYXxIIbcN2xs7S8srq2Xtgobm5t7+yW9vYbJko0ZXUaiUi3AmKY4IrVgYNgrVgzIgPBmsHwOs+bD0wbHql7GMWsI0lf8ZBTAtbqlk58SWAQhOlThn3DJfaBPUJ6N1JAKHCKa5pHOuuWym7FnRReFN5MlNGsat3St9+LaCKZAiqIMW3PjaGTEm3vFCwr+olhMaFD0mdtKxWRzHTSyX8yfGydHg4jbY8CPHF/T6REGjOSge3MX2/ms9z8Nwvk3GYILzspV3ECTNHp4jARGCKcw8I9rhkFMbKCUM1zHnRAtCVjkRYtFG8ewaJonFU8t+LdnperVzM8BXSIjtAp8tAFqqIbVEN1RNEzekVv6N15cT6cT+dr2rrkzGYO0J9yxj8qoKPp</latexit><latexit sha1_base64="lhmpRI11I8WlXEXYrMDla5/vPcM=">AAACH3icbZC7TsMwFIYdrqXcCowsFhWIqUoQEowVLIxF0IvUVJXjOq1V24nsE0SJ8ga8BK/ACjsbYu3Kk+C0HaDlSJZ+/f85PvYXxIIbcN2xs7S8srq2Xtgobm5t7+yW9vYbJko0ZXUaiUi3AmKY4IrVgYNgrVgzIgPBmsHwOs+bD0wbHql7GMWsI0lf8ZBTAtbqlk58SWAQhOlThn3DJfaBPUJ6N1JAKHCKa5pHOuuWym7FnRReFN5MlNGsat3St9+LaCKZAiqIMW3PjaGTEm3vFCwr+olhMaFD0mdtKxWRzHTSyX8yfGydHg4jbY8CPHF/T6REGjOSge3MX2/ms9z8Nwvk3GYILzspV3ECTNHp4jARGCKcw8I9rhkFMbKCUM1zHnRAtCVjkRYtFG8ewaJonFU8t+LdnperVzM8BXSIjtAp8tAFqqIbVEN1RNEzekVv6N15cT6cT+dr2rrkzGYO0J9yxj8qoKPp</latexit>

ei ⇠ N (µzi ,⌃zi)
<latexit sha1_base64="I+7623Tzq4My/liwg8d1VfjNKe8=">AAACOXicbVDLSsNAFJ34rPUVdelmsAgVpCQi6LLoxpVUtA9oQphMJ+3QmSTMTIQa8jv+hL/gVsGlrsStP+AkzUJbDwyce8693LnHjxmVyrLejIXFpeWV1cpadX1jc2vb3NntyCgRmLRxxCLR85EkjIakrahipBcLgrjPSNcfX+Z+954ISaPwTk1i4nI0DGlAMVJa8symw5Ea+UFKMo9CR1IOCwUjll5ndcfnqcOTzEsfPJodw6K+pUOOSunIM2tWwyoA54ldkhoo0fLMD2cQ4YSTUGGGpOzbVqzcFAlFMSNZ1UkkiREeoyHpaxoiTqSbFpdm8FArAxhEQr9QwUL9PZEiLuWE+7ozv0LOern4r+fzmc0qOHdTGsaJIiGeLg4SBlUE8xjhgAqCFZtogrCg+u8Qj5BAWOmwqzoUezaCedI5adhWw745rTUvyngqYB8cgDqwwRlogivQAm2AwSN4Bi/g1Xgy3o1P42vaumCUM3vgD4zvH3zrrsU=</latexit><latexit sha1_base64="I+7623Tzq4My/liwg8d1VfjNKe8=">AAACOXicbVDLSsNAFJ34rPUVdelmsAgVpCQi6LLoxpVUtA9oQphMJ+3QmSTMTIQa8jv+hL/gVsGlrsStP+AkzUJbDwyce8693LnHjxmVyrLejIXFpeWV1cpadX1jc2vb3NntyCgRmLRxxCLR85EkjIakrahipBcLgrjPSNcfX+Z+954ISaPwTk1i4nI0DGlAMVJa8symw5Ea+UFKMo9CR1IOCwUjll5ndcfnqcOTzEsfPJodw6K+pUOOSunIM2tWwyoA54ldkhoo0fLMD2cQ4YSTUGGGpOzbVqzcFAlFMSNZ1UkkiREeoyHpaxoiTqSbFpdm8FArAxhEQr9QwUL9PZEiLuWE+7ozv0LOern4r+fzmc0qOHdTGsaJIiGeLg4SBlUE8xjhgAqCFZtogrCg+u8Qj5BAWOmwqzoUezaCedI5adhWw745rTUvyngqYB8cgDqwwRlogivQAm2AwSN4Bi/g1Xgy3o1P42vaumCUM3vgD4zvH3zrrsU=</latexit><latexit sha1_base64="I+7623Tzq4My/liwg8d1VfjNKe8=">AAACOXicbVDLSsNAFJ34rPUVdelmsAgVpCQi6LLoxpVUtA9oQphMJ+3QmSTMTIQa8jv+hL/gVsGlrsStP+AkzUJbDwyce8693LnHjxmVyrLejIXFpeWV1cpadX1jc2vb3NntyCgRmLRxxCLR85EkjIakrahipBcLgrjPSNcfX+Z+954ISaPwTk1i4nI0DGlAMVJa8symw5Ea+UFKMo9CR1IOCwUjll5ndcfnqcOTzEsfPJodw6K+pUOOSunIM2tWwyoA54ldkhoo0fLMD2cQ4YSTUGGGpOzbVqzcFAlFMSNZ1UkkiREeoyHpaxoiTqSbFpdm8FArAxhEQr9QwUL9PZEiLuWE+7ozv0LOern4r+fzmc0qOHdTGsaJIiGeLg4SBlUE8xjhgAqCFZtogrCg+u8Qj5BAWOmwqzoUezaCedI5adhWw745rTUvyngqYB8cgDqwwRlogivQAm2AwSN4Bi/g1Xgy3o1P42vaumCUM3vgD4zvH3zrrsU=</latexit><latexit sha1_base64="I+7623Tzq4My/liwg8d1VfjNKe8=">AAACOXicbVDLSsNAFJ34rPUVdelmsAgVpCQi6LLoxpVUtA9oQphMJ+3QmSTMTIQa8jv+hL/gVsGlrsStP+AkzUJbDwyce8693LnHjxmVyrLejIXFpeWV1cpadX1jc2vb3NntyCgRmLRxxCLR85EkjIakrahipBcLgrjPSNcfX+Z+954ISaPwTk1i4nI0DGlAMVJa8symw5Ea+UFKMo9CR1IOCwUjll5ndcfnqcOTzEsfPJodw6K+pUOOSunIM2tWwyoA54ldkhoo0fLMD2cQ4YSTUGGGpOzbVqzcFAlFMSNZ1UkkiREeoyHpaxoiTqSbFpdm8FArAxhEQr9QwUL9PZEiLuWE+7ozv0LOern4r+fzmc0qOHdTGsaJIiGeLg4SBlUE8xjhgAqCFZtogrCg+u8Qj5BAWOmwqzoUezaCedI5adhWw745rTUvyngqYB8cgDqwwRlogivQAm2AwSN4Bi/g1Xgy3o1P42vaumCUM3vgD4zvH3zrrsU=</latexit>

Figure 2: Graphical representation of the structured
flow model. We denote discrete syntactic variables as
z, latent embedding variable as e, and observed pre-
trained word embeddings as x. fφ is the invertible pro-
jection function.

2018), and use the “SelfAtt-Graph” model (Ah-
mad et al., 2019) for dependency parsing.4 Fol-
lowing Ahmad et al. (2019), for dependency pars-
ing gold POS tags are also used to learn POS tag
embeddings as universal features. We train the
systems on English and directly evaluate them on
the target languages. Results are shown in Fig-
ure 1. While these systems achieve quite accurate
results on closely related languages, we observe
large performance drops on both tasks as distance
to English increases. These results motivate our
proposed approach, which aims to close this gap
by directly adapting to the target language through
unsupervised learning over unlabeled text.

3 Proposed Method

In this section, we first introduce the unsupervised
monolingual models presented in He et al. (2018),
which we refer to as structured flow models, then
we propose our approach that extends the struc-
tured flow models to cross-lingual settings.

3.1 Unsupervised Training of Structured
Flow Models

The structured flow generative model, proposed
by He et al. (2018), is a state-of-the-art technique
for inducing syntactic structure in a monolingual
setting without supervision. This model cascades
a structured generative prior psyntax(z;θ) with an
invertible neural network fφ(z) to generate pre-

4We use an implementation and English source model
checkpoint identical to the original paper.

https://github.com/Babylonpartners/fastText_multilingual
https://github.com/Babylonpartners/fastText_multilingual


3214

trained word embeddings x = fφ(z), which cor-
respond to the words in the training sentences. z
represents latent syntax variables that are not ob-
served during training. The structured prior de-
fines a probability over syntactic structures, and
can be a Markov prior to induce POS tags or DMV
prior (Klein and Manning, 2004) to induce depen-
dency structures. Notably, the model side-steps
discrete words, and instead uses pre-trained word
embeddings as observations, which allows it to be
directly employed in cross-lingual transfer setting
by using cross-lingual word embeddings as the ob-
servations. A graphical illustration of this model is
shown in Figure 2. Given a sentence of length l,
we denote z = {z}Kk=1 as a set of discrete latent
variables from the structured prior, e = {ei}li=1
as the latent embeddings, and x = {xi}li=1 as the
observed word embeddings. Note that the num-
ber of latent syntax variables K is no smaller than
the sentence length l, and we assume xi is gen-
erated (indirectly) conditioned on zi for notation
simplicity. The model is trained by maximizing
the following marginal data likelihood:

pus(x) =
∑

z

(
psyntax(z;θ)

·
∏`

i=1
pη(f

−1
φ (xi)|zi)

∣∣∣det∂f−1φ
∂xi

∣∣∣). (1)
pη(·|zi) is defined to be a conditional Gaussian
distribution that emits latent embedding e. The
projection function fφ projects the latent embed-

ding e to the observed embedding x.
∂f−1φ
∂xi

is
the Jacobian matrix of function f−1φ at xi, and∣∣det∂f−1φ∂xi ∣∣ represents the absolute value of its de-
terminant.

To understand the intuitions behind Eq. 1, first
denote the log likelihood over the latent embed-
ding e as log pgaus(·), then log of Eq. 1 can be
equivalently rewritten as:

log pus(x) = log pgaus(f
−1
φ (x))

+
∑l

i=1
log
∣∣∣det∂f−1φ

∂xi

∣∣∣. (2)
Eq. 2 shows that f−1φ (x) inversely projects x to a
new latent embedding space, on which the unsu-
pervised training objective is simply the Gaussian
log likelihood with an additional Jacobian regular-
ization term. The Jacobian regularization term ac-
counts for the volume expansion or contraction be-
havior of the projection, thus maximizing it can be

thought of as preventing information loss.5 This
projection scheme can flexibly transform embed-
ding space to fit the task at hand, but still avoids
trivial solutions by preserving information.

While f−1φ (x) can be any invertible func-
tion, He et al. (2018) use a version of the NICE
architecture (Dinh et al., 2014) to construct f−1φ ,
which has the advantage that the determinant term
is constantly equal to one. This structured flow
model allows for exact marginal data likelihood
computation and exact inference by the use of dy-
namic programs to marginalize out z. More details
about this model can be found in He et al. (2018).

3.2 Supervised Training of Structured Flow
Models

While He et al. (2018) train the structured flow
model in an unsupervised fashion, this model can
be also trained with supervised data when z is
observed. Supervised training is required in the
cross-lingual transfer where we train a model on
the high-resource source language. The super-
vised objective can be written as:

ps(z,x) = psyntax(z;θ)

·
∏`

i=1
pη(f

−1
φ (xi)|zi)

∣∣∣det∂f−1φ
∂xi

∣∣∣, (3)
3.3 Multilingual Training through Parameter

Sharing
In this paper, we focus on the zero-shot cross-
lingual transfer setting where the syntactic struc-
ture z is observed for the source language but un-
available for the target languages. Eq. 2 is an unsu-
pervised objective which is optimized on the target
languages, and Eq. 3 is optimized on the source
language. To establish connections between the
source and target languages, we employ two in-
stances of the structured flow model – a source
model and a target model – and share parameters
between them. The source model uses the super-
vised objective, Eq. 3, and the target model uses
the unsupervised objective, Eq. 2, and both are
optimized jointly. Instead of tying their parame-
ters in a hard way, we share their parameters softly
through an L2 regularizer that encourages similar-
ity. We use subscript p to represent variables of
the source model and q to represent variables of

5Maximizing the Jacobian term encourages volume ex-
pansion and prevents the latent embedding from collapsing
to a (nearly) single point.



3215

the target model. Together, our joint training ob-
jective is:

L(θ{p,q},η{p,q},φ{p,q})=log ps(xp)+log pus(xq)

− β1
2
‖θp − θq‖2 −

β2
2
‖ηp − ηq‖2

− β3
2
‖φp − φq‖2, (4)

where β = {β1, β2, β3} are regularization param-
eters. Introduction of hyperparameters is concern-
ing because in the zero-shot transfer setting we
do not have annotated data to select the parame-
ters for each target language, but in experiments
we found it unnecessary to tune β for different
target languages separately, and it is possible to
use the same β within the same language cate-
gory (i.e. distant or nearby). Under the parame-
ter sharing scheme the projected latent embedding
space e can be understood as the new interlingual
embedding space from which we learn the syntac-
tic structures. The expressivity of the flow model
used in learning this latent embeddings space is
expected to compensate for the imperfect orthog-
onality between the two embedding spaces.

Further, jointly training both models with Eq. 4
is more expensive than typical cross-lingual trans-
fer setups – it would require re-training both mod-
els for each language pair. To improve efficiency
and memory utilization, in practice we use a sim-
ple pipelined approach: (1) We pre-train parame-
ters for the source model only once, in isolation.
(2) We use these parameters to initialize each tar-
get model, and regularize all target parameters to-
wards this initializer via the L2 terms in Eq. 4. In
this way, we only need to save the pre-trained pa-
rameters for a single source model, and target-side
fine-tuning converges much faster than training
each pair from scratch. This training approxima-
tion has been used before in Zhang et al. (2016).

4 Experiments

In this section, we first describe the dataset and ex-
perimental setup, and then report the cross-lingual
transfer results of POS tagging and dependency
parsing on distant target languages. Lastly we in-
clude analysis of different systems.

4.1 Experimental Setup
Across both POS tagging and dependency pars-
ing tasks, we run experiments on Universal De-
pendency Treebanks (v2.2) (Nivre et al., 2018).

Specifically, we train the proposed model on the
English corpus with annotated data and fine-tune
it on target languages in an unsupervised way.
In the rest of the paper we will use Flow-FT to
term our proposed method. We use the aligned
cross-lingual word embeddings described in Sec-
tion 2.2 as the observations of our model. To com-
pare with Ahmad et al. (2019), on dependency
parsing task we also use universal gold POS tags
to index tag embeddings as part of observations.
Specifically, the tag embeddings are concatenated
with word embeddings to form x, tag embed-
dings are updated when training on the source lan-
guage, and fixed at fine-tuning stage. We imple-
ment the structured flow model based on the pub-
lic code from He et al. (2018),6which contains
models with Markov prior for POS tagging and
DMV prior for dependency parsing. Detailed hy-
perparameters can be found in Appendix B. Both
source model and target model are optimized with
Adam (Kingma and Ba, 2014). Training on the
English source corpus is run 5 times with differ-
ent random restarts for all models, then the source
model with the best English test accuracy is se-
lected to perform transfer.

We compare our method with a direct transfer
approach that is based on the state-of-the-art dis-
criminative models as described in Section 2.2.
The pre-trained cross-lingual word embeddings
for all models are frozen since fine-tuning them
will break the multi-lingual alignments. In addi-
tion, to demonstrate the efficacy of unsupervised
adaptation, we also include direct transfer results
of our model without fine-tuning, which we de-
note as Flow-Fix. On the POS tagging task we re-
implement the generative baseline in Zhang et al.
(2016) that employs a linear projection (Linear-
FT). We present results on 20 target languages in
“distant languages” and “nearby languages” cate-
gories to analyze the difference of the systems and
the scenarios to which they are applicable.

4.2 Part-Of-Speech Tagging

Setup. Our method aims to predict coarse uni-
versal POS tags, as fine-grained tags are language-
dependent. The discriminative baseline with the
NCRF++ toolkit (Yang and Zhang, 2018) achieves
supervised test accuracy on English of 94.02%,
which is competitive (rank 12) on the CoNLL

6https://github.com/jxhe/
struct-learning-with-flow.

https://github.com/jxhe/struct-learning-with-flow
https://github.com/jxhe/struct-learning-with-flow


3216

Discriminative Generative
Lang LSTM-CRF Flow-Fix Flow-FT Linear-FT

Distant Languages
zh (0.86) 33.31 35.24 43.44 35.95
fa (0.86) 61.74 55.32 64.47 34.35
ar (0.86) 56.41 49.70 64.00 38.95
ja (0.71) 26.37 25.09 38.37 12.49
id (0.71) 72.21 63.73 73.51 57.56
ko (0.69) 42.57 39.56 41.76 18.30
tr (0.62) 58.74 43.17 60.08 22.79
hi (0.61) 55.85 47.18 64.75 38.04
hr (0.59) 63.23 50.57 57.90 56.53
he (0.57) 48.90 47.97 62.69 48.17
AVG 51.93 45.75 57.10 36.31

Nearby Languages
bg (0.50) 74.55 62.18 64.69 66.71
it (0.50) 77.75 69.93 80.99 73.55
pt (0.48) 74.68 65.08 72.65 72.54
fr (0.46) 73.33 64.15 69.78 66.63
es (0.46) 76.07 65.77 77.19 72.86
no (0.45) 69.30 58.98 62.05 62.38
da (0.41) 79.33 62.42 68.68 67.31
sv (0.40) 76.70 58.91 66.34 61.82
nl (0.37) 80.15 66.52 68.74 66.08
de (0.36) 68.75 57.91 59.97 56.16
AVG 75.06 63.19 69.11 66.60
en∗ 94.02 87.03 – 84.69

Table 2: POS tagging accuracy results (%). Numbers
next to languages names are their distances to English.
Supervised accuracy on English (∗) is included for ref-
erence.

2018 Shared Task scoreboard that uses the same
dataset.7 The regularization parameters β in all
generative models are tuned on the Arabic8 devel-
opment data and kept the same for all target lan-
guages. Our running β is β1 = 0, β2 = 500, β3 =
80. Unsupervised fine-tuning is run for 10 epochs.

Results. We show our results in Table 2, where
unsupervised fine-tuning achieves considerable
and consistent performance improvements over
the Flow-Fix baseline in both language categories.
When compared the discriminative LSTM-CRF
baseline, our approach outperforms it on 8 out
of 10 distant languages, with an average of 5.2%
absolute improvement. Unsurprisingly, however,
it also underperforms the expressive LSTM-CRF
on 8 out of 10 nearby languages. The reasons
for this phenomenon are two-fold. First, the flex-
ible LSTM-CRF model is better able to fit the

7For reference, check the “en ewt” treebank results in
http://universaldependencies.org/conll18/results-upos.html.

8We choose Arabic simply because it is first in alphabeti-
cal order.

source English corpus than our method (94.02%
vs 87.03% accuracy), thus it is also capable of
fitting similar input when transferring. Second,
unsupervised adaptation helps less when transfer-
ring to nearby languages (5.9% improvement over
Flow-Fix versus 11.3% on distant languages), we
posit that this is because a large portion of lin-
guistic knowledge is shared between similar lan-
guages, and the cross-lingual word embeddings
have better quality in this case, so unsupervised
adaptation becomes less necessary. While the
Linear-FT baseline on nearby languages is com-
parable to our method, its performance on distant
languages is much worse, which confirms the im-
portance of invertible projection, especially when
language typologies are divergent.

4.3 Dependency Parsing

Setup. In preliminary parsing results we found
that transferring to “nearby language” group is
likely to suffer from catastrophic forgetting (Mc-
Closkey and Cohen, 1989) and thus requires
stronger regularization towards the source model.
This also makes sense intuitively since nearby
languages should prefer the source model more
than distant languages. Therefore, we use two
different sets of regularization parameters for
nearby languages and distant languages, respec-
tively. Specifically, β for the “distant languages”
group is set as β1 = β2 = β3 = 0.1, tuned on the
Arabic development set, and for the “nearby lan-
guages” group β is set as β1 = β2 = β3 = 1,
tuned on the Spanish development set. Unsu-
pervised adaptation is performed on sentences of
length less than 40 due to memory constraints,9

but we test on sentences of all lengths. We run
unsupervised fine-tuning for 5 epochs, and evalu-
ate using unlabeled attachment score (UAS) with
punctuation excluded.

Results. We show our results in Table 3. While
unsupervised fine-tuning improves the perfor-
mance on the distant languages, it only has min-
imal effect on nearby languages, which is consis-
tent with our observations in the POS tagging ex-
periment and implies that unsupervised adaption
helps more for distant transfer. Similar to POS
tagging results, our method is able to outperform
state-of-the-art “SelfAtt-Graph” model on 8 out
of 10 distant languages, with an average of 8.3%

9Reducing batch size can address this memory issue, but
greatly increases the training time.



3217

Discriminative Generative
Lang SelfAtt-Graph Flow-Fix Flow-FT

Distant Languages
zh (0.86) 42.48 35.72 37.26
fa (0.86) 37.10 37.58 63.20
ar (0.86) 38.12 32.14 55.44
ja (0.71) 28.18 19.03 43.75
id (0.71) 49.20 46.74 64.20
ko (0.69) 34.48 34.76 37.03
tr (0.62) 35.08 34.76 36.05
hi (0.61) 35.50 29.20 33.17
hr (0.59) 61.91 59.57 65.31
he (0.57) 55.29 51.35 64.80
AVG 41.73 38.09 50.02

Nearby Languages
bg (0.50) 79.40 73.52 73.57
it (0.50) 80.80 68.84 70.68
pt (0.48) 76.61 66.61 66.61
fr (0.46) 77.87 65.92 67.66
es (0.46) 74.49 63.10 64.28
no (0.45) 80.80 65.48 65.29
da (0.41) 76.64 61.64 61.08
sv (0.40) 80.98 66.22 64.43
nl (0.37) 68.55 61.59 61.72
de (0.36) 71.34 70.10 69.52
AVG 76.75 66.30 66.48

en∗ 91.82 67.80 –

Table 3: Dependency parsing UAS (%) on sentences of
all lengths. Numbers next to languages names are their
distances to English. Supervised accuracy on English
(∗) is included for reference.

absolute improvement, but the strong discrimina-
tive baseline performs better when transferring to
nearby languages. Note that the supervised per-
formance of our method on English is poor. This
is mainly because the DMV prior is too simple
and limits the capacity of the model. While this
model still achieves good performance on distant
transfer, incorporating more complex DMV vari-
ants (Jiang et al., 2016) might lead to further im-
provement.

Analysis on Dependency Relations. We further
perform breakdown analysis on dependency re-
lations to see how unsupervised adaptation helps
learn new dependency rules. We select three typi-
cal distant languages with different word order of
Subject, Object and Verb (Dryer, 2013): Arabic
(Modern Standard, VSO), Indonesian (SVO) and
Japanese (SOV).

We investigate the unlabeled accuracy (recall)
on the gold dependency labels. We especially
explore four typical dependency relations: case
(case marking), nmod (nominal modifier), obj (ob-

ject) and nsubj (nominal subject). The first two
are “nominal dependents” (modifiers for nouns)
and the rest two are the main nominal “core ar-
guments” (arguments for the predicate). Although
different languages may vary, these four types are
representative relations and occupies 25% to 40%
in frequencies among all 37 UD dependency types.

We compare our fine-tuning model with the
baseline “SelfAtt-Graph” model and our basic
model without fine-tuning. As shown in Figure 3,
although our direct transfer model obtain similar
results when compared with the baseline, the fine-
tuning method brings large improvements on most
of these dependency relations. In these three lan-
guages, Japanese benefits from our tuning method
the most, probably because its word order is quite
different from English and the baseline may over-
fit to the English order. For example, in Japanese,
almost all of the “case” relations are head-first
and “obj” relations are modifier-first, and these
patterns are exactly opposite to those in English,
which serves as our source language. As a result,
direct transfer models fail on most of these rela-
tions since they only learn the patterns in English.
With our fine-tuning on unlabeled data, the model
may get more familiar with the unusual patterns
of word order and predict more correct attachment
decisions (around 0.4 improvements in recalls). In
Arabic and Indonesian, although not as obviously
as in Japanese, the improvements are still consis-
tent, especially on the relations of the core argu-
ments.

4.4 When to Use Generative Models?
In unsupervised cross-lingual transfer setting, it
is hard to find a system that is able to achieve
state-of-the-art on all languages. As reflected by
our experiments, there is a tradeoff between fit-
ting source language and generalizing to target
language – the flexibility of discriminative mod-
els results in overfitting issue and poor perfor-
mance when transferred to distant languages. Un-
fortunately, a limited number of high-resource lan-
guages and many more low-resource languages in
the world are mostly distant. This means that dis-
tant transfer is a practical challenge we face when
dealing with low-resource languages. Next we try
to give a preliminary guidance about which system
should be used in specific transfer scenarios.

As discussed in Section 2.1, there are different
types of distance metrics. Here we aim to com-
pute the significance of correlation between the



3218

case (15.3%) nmod (22.1%) obj (3.6%) nsubj (6.7%)0

20

40

60

80
R

ec
al

l (
U

A
S%

)

Arabic

case (9.7%) nmod (3.5%) obj (4.9%) nsubj (8.1%)0

20

40

60

80

R
ec

al
l (

U
A

S%
)

Indonesian

Baseline Direct-Transfer Fine-Tuned
case (21.8%) nmod (5.9%) obj (2.6%) nsubj (3.9%)0

20

40

60

R
ec

al
l (

U
A

S%
)

Japanese

Figure 3: Results (UAS%) on typical dependency relations for Arabic, Indonesian and Japanese, respectively.
“Baseline” denotes the “SelfAtt-Graph” model, and “Direct-Transfer” denotes our source model without fine-
tuning. The number in the parenthesis after each dependency label indicates the relative frequency of this type.

performance difference between our method and
the discriminative baseline and different distance
features. We have five input distance features: ge-
ographic, genetic, syntactic, inventory, and phono-
logical.

Specifically, we fit a generalized linear model
(GLM) on the difference in accuracy and five fea-
tures of all 20 target languages, then we perform a
hypothesis test to compute the p-value that reflects
the significance of specific features.10 Results are
shown in Table 4, where we can conclude that the
genetic distance feature is significantly correlated
with POS tagging performance, while geographic
distance feature is significantly correlated with de-
pendency parsing performance. As assumed be-
fore, inventory and phonological distance do not
have much influence on the transfer. Interestingly,
syntactic distance is not the significant term for
both tasks, we posit that this is because the trans-
fer performance is affected by both cross-lingual
word embedding quality and linguistic features,
thus genetic/geographic distance might be a bet-
ter indicator overall. The results suggest that our
method might be more suitable than the discrimi-
native approach at genetically distant transfer for
POS tagging and geographically distant transfer
for parsing.

4.5 Effect of Multilingual-BERT

So far the analysis and experiments of this paper
focus on non-contextualized fastText word embed-
dings. We note that concurrently to this work, Wu
and Dredze (2019) found that the recently released
multilingual BERT (mBERT; Devlin et al. (2019))
is able to achieve impressive performance on var-
ious cross-lingual transfer tasks. To study the ef-
fect of contextualized mBERT word embeddings
on our proposed method, we report the average
POS tagging and dependency parsing results in
Table 5, while detailed numbers on each language

10We use the GLM toolkit present in the H2O Python Mod-
ule.

Feature p-value
POS tagging Dependency Parsing

Geographic 0.465 0.013
Genetic 0.007 0.531
Syntactic 0.716 0.231
Inventory 0.982 0.453
Phonological 0.502 0.669

Table 4: p-value of different distance features on POS
tagging and dependency parsing task. A lower p-
value indicates stronger association between the feature
and the response, which is the difference between our
method and the discriminative baselines.

are included in Appendix C. In the mBERT ex-
periments, all the settings and hyperparameters are
the same as in Section 4.2 and Section 4.3, but the
aligned fastText embeddings are replaced with the
mBERT embeddings.11 We also include the aver-
age results from fastText embeddings for compar-
ison.

On the POS tagging task all the models greatly
benefit from the mBERT embeddings, espe-
cially our method on nearby languages where the
mBERT outperforms the fastText by an average
of 16 absolute points. Moreover, unsupervised
adaptation still considerably improves the Flow-
Fix baseline, and surpasses the LSTM-CRF base-
line on 9 out of 10 distant languages with an av-
erage of 6% absolute performance boost. Differ-
ent from the fastText setting where our method
underperforms the discriminative baseline on the
nearby language group, by the use of mBERT em-
beddings our method also beats the discriminative
baseline on 7 out of 10 nearby languages with an
average of 3% absolute improvement. A major
limitation of our method lies in its strong inde-
pendence assumptions, which results in the fail-
ure to model the long-term context information.
We posit that the contextualized word embeddings

11We use the multilingual cased BERT base model released
in https://github.com/google-research/
bert.

https://github.com/google-research/bert
https://github.com/google-research/bert


3219

Tagging Parsing
emb Disc Flow-FT Disc Flow-FT

Distant Languages
fastText 51.93 57.10 41.73 50.02
mBERT 60.24 66.56 51.86 50.11

Nearby Languages
fastText 75.06 69.11 76.75 66.48
mBERT 82.17 85.48 83.41 67.70

Table 5: Average of POS tagging accuracy (%) and de-
pendency parsing UAS (%) results, comparing mBERT
and fastText. “Disc” denotes the discriminative base-
lines.

like mBERT exactly compensate for this drawback
in our model through incorporating the context in-
formation into the observed word embeddings, so
that our method is able to outperform the discrim-
inative baseline on both distant and nearby lan-
guage groups.

On dependency parsing task, however, our
method does not demonstrate significant improve-
ment by the use of mBERT, while mBERT greatly
helps the discriminative baseline. Therefore, al-
though our method still outperforms the discrim-
inative baseline on four very distant languages,
the baseline demonstrates superior performance
on other languages when using mBERT. Interest-
ingly, we find that the performance of flow-based
models with mBERT is similar to the performance
with fastText word embeddings. Based on this,
better generative models for unsupervised depen-
dency parsing that can take advantage of contex-
tualized embeddings seems a promising direction
for future work.

5 Related Work

Cross-lingual transfer learning has been widely
studied to help induce syntactic structures in
low-resource languages (McDonald et al., 2011;
Täckström et al., 2013a; Agić et al., 2014; Tiede-
mann, 2015; Kim et al., 2017; Schuster et al.,
2019; Ahmad et al., 2019). In the case when no
available target annotations are available, unsuper-
vised cross-lingual transfer can be performed by
directly applying pre-trained source model to the
target language. (Guo et al., 2015; Schuster et al.,
2019; Ahmad et al., 2019). The challenge of direct
transfer method lies in the different linguistic rules
between source and distant target languages. Uti-
lizing multiple sources of resources can mitigate
this issue and has been actively studied in the past

years (Cohen et al., 2011; Naseem et al., 2012;
Täckström et al., 2013b; Zhang and Barzilay,
2015; Aufrant et al., 2015; Ammar et al., 2016;
Wang and Eisner, 2018, 2019). Other approaches
that try to overcome the lack of annotations in-
clude annotation projection by the use of bitext su-
pervision or bilingual lexicons (Hwa et al., 2005;
Smith and Eisner, 2009; Wisniewski et al., 2014)
and source data point selection (Søgaard, 2011;
Täckström et al., 2013b).

Learning from both labeled source data and un-
labeled target data has been explored before. Co-
hen et al. (2011) learns a generative target lan-
guage parser as a linear interpolation of multiple
source language parameters, Naseem et al. (2012)
and Täckström et al. (2013b) rely on additional
language typological features to guide selective
model parameter sharing in a multi-source transfer
setting, Wang and Eisner (2018, 2019) extract lin-
guistic features from target languages by training
a feature extractor on multiple source languages.

6 Conclusion

In this work, we focus on transfer to distant lan-
guages for POS tagging and dependency pars-
ing, and propose to learn a structured flow model
in a cross-lingual setting. Through learning a
new latent embedding space as well as language-
specific knowledge with unlabeled target data, our
method proves effective at transferring to distant
languages.

Acknowledgements

This research was supported by NSF Award No.
1761548 “Discovering and Demonstrating Lin-
guistic Features for Language Documentation.”

References

Željko Agić, Jörg Tiedemann, Kaja Dobrovoljc, Si-
mon Krek, Danijela Merkler, and Sara Može. 2014.
Cross-lingual dependency parsing of related lan-
guages with rich morphosyntactic tagsets. In
EMNLP 2014 Workshop on Language Technology
for Closely Related Languages and Language Vari-
ants.

Wasi Uddin Ahmad, Zhisong Zhang, Xuezhe Ma,
Eduard Hovy, Kai-Wei Chang, and Nanyun Peng.
2019. On difficulties of cross-lingual transfer with
order differences: A case study on dependency pars-
ing. In Proceedings of NAACL.



3220

Waleed Ammar, George Mulcaire, Miguel Ballesteros,
Chris Dyer, and Noah A Smith. 2016. Many lan-
guages, one parser. Transactions of the Association
for Computational Linguistics.

Lauriane Aufrant, Guillaume Wisniewski, and François
Yvon. 2015. Zero-resource dependency parsing:
Boosting delexicalized cross-lingual transfer with
linguistic knowledge. In Proceedings of COLING.

Piotr Bojanowski, Edouard Grave, Armand Joulin, and
Tomas Mikolov. 2017. Enriching word vectors with
subword information. Transactions of the Associa-
tion for Computational Linguistics.

Shay B Cohen, Dipanjan Das, and Noah A Smith.
2011. Unsupervised structure prediction with non-
parallel multilingual guidance. In Proceedings of
EMNLP.

Alexis Conneau, Guillaume Lample, Marc’Aurelio
Ranzato, Ludovic Denoyer, and Hervé Jégou. 2018.
Word translation without parallel data. In Proceed-
ings of ICLR.

Jacob Devlin, Ming-Wei Chang, Kenton Lee, and
Kristina Toutanova. 2019. Bert: Pre-training of deep
bidirectional transformers for language understand-
ing. In Proceedings of NAACL.

Laurent Dinh, David Krueger, and Yoshua Bengio.
2014. Nice: Non-linear independent components
estimation. arXiv preprint arXiv:1410.8516.

Timothy Dozat and Christopher D Manning. 2017.
Deep biaffine attention for neural dependency pars-
ing. In Proceedings of ICLR.

Matthew S. Dryer. 2013. Order of subject, object and
verb. In Matthew S. Dryer and Martin Haspelmath,
editors, The World Atlas of Language Structures On-
line. Max Planck Institute for Evolutionary Anthro-
pology, Leipzig.

Jiang Guo, Wanxiang Che, David Yarowsky, Haifeng
Wang, and Ting Liu. 2015. Cross-lingual depen-
dency parsing based on distributed representations.
In Proceedings of ACL.

Jiang Guo, Wanxiang Che, David Yarowsky, Haifeng
Wang, and Ting Liu. 2016. A representation learn-
ing framework for multi-source transfer parsing. In
Proceedings of AAAI.

Harald Hammarstrm, Robert Forkel, Martin Haspel-
math, and Sebastian Bank. 2015. Glottolog 2.6.
Max Planck Institute for the Science of Human His-
tory.

Junxian He, Graham Neubig, and Taylor Berg-
Kirkpatrick. 2018. Unsupervised learning of syn-
tactic structure with invertible neural projections. In
Proceedings of EMNLP.

Zhiheng Huang, Wei Xu, and Kai Yu. 2015. Bidirec-
tional lstm-crf models for sequence tagging. arXiv
preprint arXiv:1508.01991.

Rebecca Hwa, Philip Resnik, Amy Weinberg, Clara
Cabezas, and Okan Kolak. 2005. Bootstrapping
parsers via syntactic projection across parallel texts.
Natural language engineering, 11(3):311–325.

Yong Jiang, Wenjuan Han, and Kewei Tu. 2016. Unsu-
pervised neural dependency parsing. In Proceedings
of EMNLP.

Joo-Kyung Kim, Young-Bum Kim, Ruhi Sarikaya, and
Eric Fosler-Lussier. 2017. Cross-lingual transfer
learning for pos tagging without cross-lingual re-
sources. In Proceedings of EMNLP.

Diederik P Kingma and Jimmy Ba. 2014. Adam: A
method for stochastic optimization. arXiv preprint
arXiv:1412.6980.

Dan Klein and Christopher D Manning. 2004. Corpus-
based induction of syntactic structure: Models of de-
pendency and constituency. In Proceedings of ACL.

M. Paul Lewis, Gary F. Simons, and Charles D. Fennig,
editors. 2015. Ethnologue: Languages of the World,
Eighteenth edition. SIL International, Dallas, Texas.

Patrick Littell, David R Mortensen, Ke Lin, Katherine
Kairis, Carlisle Turner, and Lori Levin. 2017. Uriel
and lang2vec: Representing languages as typologi-
cal, geographical, and phylogenetic vectors. In Pro-
ceedings of EACL.

Xuezhe Ma, Zecong Hu, Jingzhou Liu, Nanyun Peng,
Graham Neubig, and Eduard Hovy. 2018. Stack-
pointer networks for dependency parsing. In Pro-
ceedings of ACL.

Michael McCloskey and Neal J Cohen. 1989. Catas-
trophic interference in connectionist networks: The
sequential learning problem. In Psychology of
learning and motivation, volume 24, pages 109–
165. Elsevier.

Ryan McDonald, Slav Petrov, and Keith Hall. 2011.
Multi-source transfer of delexicalized dependency
parsers. In Proceedings of EMNLP.

Steven Moran, Daniel McCloy, and Richard Wright,
editors. 2014. PHOIBLE Online. Max Planck In-
stitute for Evolutionary Anthropology, Leipzig.

Tahira Naseem, Regina Barzilay, and Amir Globerson.
2012. Selective sharing for multilingual dependency
parsing. In Proceedings of ACL.

Joakim Nivre, Mitchell Abrams, Željko Agić, and
et al. 2018. Universal dependencies 2.2. LIN-
DAT/CLARIN digital library at the Institute of For-
mal and Applied Linguistics (ÚFAL), Faculty of
Mathematics and Physics, Charles University.

Slav Petrov, Dipanjan Das, and Ryan McDonald. 2012.
A universal part-of-speech tagset. In Proceedings
of the Eighth International Conference on Language
Resources and Evaluation (LREC-2012).



3221

Tal Schuster, Ori Ram, Regina Barzilay, and Globerson
Amir. 2019. Cross-lingual alignment of contextual
word embeddings, with applications to zero-shot de-
pendency parsing. In Proceedings of NAACL.

David A Smith and Jason Eisner. 2009. Parser adap-
tation and projection with quasi-synchronous gram-
mar features. In Proceedings of EMNLP.

Samuel L Smith, David HP Turban, Steven Hamblin,
and Nils Y Hammerla. 2017. Offline bilingual word
vectors, orthogonal transformations and the inverted
softmax. In Proceedings of ICLR.

Anders Søgaard. 2011. Data point selection for cross-
language adaptation of dependency parsers. In Pro-
ceedings of ACL.

Oscar Täckström, Dipanjan Das, Slav Petrov, Ryan
McDonald, and Joakim Nivre. 2013a. Token and
type constraints for cross-lingual part-of-speech tag-
ging. Transactions of the Association for Computa-
tional Linguistics, 1:1–12.

Oscar Täckström, Ryan McDonald, and Joakim Nivre.
2013b. Target language adaptation of discriminative
transfer parsers. In Proceedings of NAACL-HLT.

Jörg Tiedemann. 2015. Cross-lingual dependency
parsing with universal dependencies and predicted
pos labels. In Proceedings of the Third International
Conference on Dependency Linguistics (Depling
2015).

Dingquan Wang and Jason Eisner. 2018. Synthetic data
made to order: The case of parsing. In Proceedings
EMNLP.

Dingquan Wang and Jason Eisner. 2019. Surface statis-
tics of an unknown language indicate how to parse it.
Transactions of the Association for Computational
Linguistics.

Guillaume Wisniewski, Nicolas Pécheux, Souhir
Gahbiche-Braham, and François Yvon. 2014.
Cross-lingual part-of-speech tagging through am-
biguous learning. In Proceedings of EMNLP.

Shijie Wu and Mark Dredze. 2019. Beto, Bentz, Becas:
The surprising cross-lingual effectiveness of BERT.
arXiv preprint arXiv:1904.09077.

Jie Yang and Yue Zhang. 2018. NCRF++: An open-
source neural sequence labeling toolkit. In Proceed-
ings of ACL.

Yuan Zhang and Regina Barzilay. 2015. Hierarchical
low-rank tensors for multilingual transfer parsing.
In Proceedings of EMNLP.

Yuan Zhang, David Gaddy, Regina Barzilay, and
Tommi Jaakkola. 2016. Ten pairs to tag–
multilingual pos tagging via coarse mapping be-
tween embeddings. In Proceedings of NAACL-HLT.



3222

A Details of UD Treebanks

Language Dist. Treebank #Sent.

Chinese (zh) 0.86 GSD
train 3997
dev 500
test 500

Persian (fa) 0.86 Seraji
train 4798
dev 599
test 600

Arabic (ar) 0.86 PADT
train 6075
dev 909
test 680

Japanese (ja) 0.71 GSD
train 7164
dev 511
test 557

Indonesian (id) 0.71 GSD
train 4477
dev 559
test 557

Korean (ko) 0.69 GSD,Kaist

train 27410
dev 3016
test 3276

Turkish (tr) 0.62 IMST
train 3685
dev 975
test 975

Hindi (hi) 0.61 HDTB
train 13304
dev 1659
test 1684

Croatian (hr) 0.59 SET
train 6983
dev 849
test 1057

Hebrew (he) 0.57 HTB
train 5241
dev 484
test 491

Bulgarian (bg) 0.50 BTB
train 8907
dev 1115
test 1116

Italian (it) 0.50 ISDT
train 13121
dev 564
test 482

Portuguese (pt) 0.48 Bosque,GSD

train 17993
dev 1770
test 1681

French (fr) 0.46 GSD
train 14554
dev 1478
test 416

Spanish (es) 0.46 GSD,AnCora

train 28492
dev 3054
test 2147

Norwegian (no) 0.45 Bokmaal,Nynorsk

train 29870
dev 4300
test 3450

Danish (da) 0.41 DDT
train 4383
dev 564
test 565

Swedish (sv) 0.40 Talbanken
train 4303
dev 504
test 1219

Dutch (nl) 0.37 Alpino,LassySmall

train 18058
dev 1394
test 1472

German (de) 0.36 GSD
train 13814
dev 799
test 977

English (en) – EWT
train 12543
dev 2002
test 2077

Table 6: Statistics of the UD Treebanks that we used.

We list the statistics of the UD Treebanks that
we used in the following two tables. The left one
lists the distance (to English) languages and the
right one lists the similar (to English) languages.

B Model Hyperparameters

We use the same architecture as in He et al. (2018)
for the invertible projection function fφ which is
the NICE architecture (Dinh et al., 2014). It con-
tains 8 coupling layers. The coupling function in
each coupling layer is a rectified network with an
input layer, one hidden layer, and linear output
units. The number of hidden units is set to the
same as the number of input units, which is 150 in
our case. POS tagger is trained with batch size 32,
while dependency parser is trained with batch size
16.

C Full Results with mBERT

Here we report in Table 7 the full results on all
languages with mBERT.12

12The results of our discriminative baselines are differ-
ent from the ones reported in Wu and Dredze (2019) be-
cause they do not use additional encoders on top of the pre-
trained mBERT word embeddings, while we keep the models
unchanged here for direct comparison with fastText embed-
dings. On some languages our version produces better results
and sometimes their version is superior.



3223

POS Tagging Dependency Parsing
Lang LSTM-CRF Flow-Fix Flow-FT SelfAtt-Graph Flow-Fix Flow-FT

Distant Languages
zh (0.86) 59.63 53.61 65.84 48.78 35.73 35.64
fa (0.86) 57.63 56.18 68.55 51.47 37.99 63.18
ar (0.86) 53.50 48.92 67.33 50.91 32.13 56.85
ja (0.71) 46.81 40.98 46.06 40.08 19.23 43.55
id (0.71) 74.95 70.95 78.72 57.94 47.00 64.35
ko (0.69) 50.74 47.99 54.07 39.42 34.67 37.02
tr (0.62) 60.08 54.69 61.16 42.80 34.88 37.06
hi (0.61) 58.86 53.16 68.39 48.44 29.15 33.17
hr (0.59) 74.98 66.35 78.61 73.63 59.68 65.27
he (0.57) 65.24 57.27 76.83 65.11 51.39 65.03
AVG (mBERT) 60.24 55.01 66.56 51.86 38.19 50.11
AVG (fastText) 51.93 45.75 57.10 41.73 38.09 50.02

Nearby Languages
bg (0.50) 82.36 74.56 80.68 86.32 73.65 74.06
it (0.50) 76.70 66.02 87.88 86.71 69.09 71.59
pt (0.48) 83.45 80.83 86.49 83.75 66.67 69.56
fr (0.46) 79.22 74.21 87.21 86.64 66.08 69.14
es (0.46) 77.68 72.28 84.50 81.74 63.18 66.46
no (0.45) 85.29 80.69 83.96 85.01 65.47 66.08
da (0.41) 85.57 81.90 86.79 82.22 61.61 62.15
sv (0.41) 86.39 81.27 86.31 85.33 66.04 64.51
nl (0.40) 83.67 78.88 85.05 77.32 61.70 63.24
de (0.37) 81.37 78.97 85.96 79.03 70.19 70.19
AVG (mBERT) 82.17 76.96 85.48 83.41 66.37 67.70
AVG (fastText) 75.06 63.19 69.11 76.75 66.30 66.48

en∗ 95.13 91.22 – 92.84 67.76 –

Table 7: POS tagging accuracy (%) and dependency parsing UAS (%) results when using mBERT as the aligned
embeddings. Numbers next to languages names are their distances to English. Supervised accuracy on English (∗)
is included for reference.


