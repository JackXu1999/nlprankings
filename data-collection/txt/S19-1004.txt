



















































Composition of Embeddings : Lessons from Statistical Relational Learning


Proceedings of the Eighth Joint Conference on Lexical and Computational Semantics (*SEM), pages 33–43
Minneapolis, June 6–7, 2019. c©2019 Association for Computational Linguistics

33

Composition of Sentence Embeddings:
Lessons from Statistical Relational Learning

Damien Sileo3,1, Tim Van De Cruys2, Camille Pradel1, and Philippe Muller3

1Synapse Développement, Toulouse, France
2IRIT, CNRS, France

3IRIT, University of Toulouse, France
damien.sileo@synapse-fr.com

Abstract

Various NLP problems – such as the predic-
tion of sentence similarity, entailment, and dis-
course relations – are all instances of the same
general task: the modeling of semantic rela-
tions between a pair of textual elements. A
popular model for such problems is to embed
sentences into fixed size vectors, and use com-
position functions (e.g. concatenation or sum)
of those vectors as features for the prediction.
At the same time, composition of embeddings
has been a main focus within the field of Statis-
tical Relational Learning (SRL) whose goal is
to predict relations between entities (typically
from knowledge base triples). In this article,
we show that previous work on relation pre-
diction between texts implicitly uses composi-
tions from baseline SRL models. We show that
such compositions are not expressive enough
for several tasks (e.g. natural language infer-
ence). We build on recent SRL models to ad-
dress textual relational problems, showing that
they are more expressive, and can alleviate is-
sues from simpler compositions. The resulting
models significantly improve the state of the
art in both transferable sentence representation
learning and relation prediction.

1 Introduction

Predicting relations between textual units is a
widespread task, essential for discourse analy-
sis, dialog systems, information retrieval, or para-
phrase detection. Since relation prediction often
requires a form of understanding, it can also be
used as a proxy to learn transferable sentence rep-
resentations. Several tasks that are useful to build
sentence representations are derived directly from
text structure, without human annotation: sen-
tence order prediction (Logeswaran et al., 2016;
Jernite et al., 2017), the prediction of previous
and subsequent sentences (Kiros et al., 2015; Jer-
nite et al., 2017), or the prediction of explicit dis-

course markers between sentence pairs (Nie et al.,
2017; Jernite et al., 2017). Human labeled re-
lations between sentences can also be used for
that purpose, e.g. inferential relations (Conneau
et al., 2017). While most work on sentence simi-
larity estimation, entailment detection, answer se-
lection, or discourse relation prediction seemingly
uses task-specific models, they all involve predict-
ing whether a relation R holds between two sen-
tences s1 and s2. This genericity has been noticed
in the literature before (Baudiš et al., 2016) and it
has been leveraged for the evaluation of sentence
embeddings within the SentEval framework (Con-
neau et al., 2017).

A straightforward way to predict the probability
of (s1, R, s2) being true is to represent s1 and s2
with d-dimensional embeddings h1 and h2, and to
compute sentence pair features f(h1, h2), where
f is a composition function (e.g. concatenation,
product, . . . ). A softmax classifier gθ can learn to
predict R with those features. gθ ◦ f can be seen
as a reasoning based on the content of h1 and h2
(Socher et al., 2013).

Our contributions are as follows:

– we review composition functions used in tex-
tual relational learning and show that they
lack expressiveness (section 2);

– we draw analogies with existing SRL mod-
els (section 3) and design new compositions
inspired from SRL (section 4);

– we perform extensive experiments to test
composition functions and show that some of
them can improve the learning of representa-
tions and their downstream uses (section 6).

2 Composition functions for relation
prediction

We review here popular composition functions
used for relation prediction based on sentence em-

damien.sileo@synapse-fr.com


34

beddings. Ideally, they should simultaneously ful-
fill the following minimal requirements:

– make use of interactions between representa-
tions of sentences to relate;

– allow for the learning of asymmetric relations
(e.g. entailment, order);

– be usable with high dimensionalities (param-
eters θ and f should fit in GPU memory).

Additionally, if the main goal is transferable
sentence representation learning, compositions
should also incentivize gradually changing sen-
tences to lie on a linear manifold, since trans-
fer usually uses linear models. Another goal can
be learning of transferable relation representa-
tion. Concretely, a sentence encoder and f can
be trained on a base task, and f(h1, h2) can be
used as features for transfer in another task. In
that case, the geometry of the sentence embed-
ding space is less relevant, as long as the f(h1, h2)
space works well for transfer learning. Our evalu-
ation will cover both cases.

A straightforward instantiation of f is concate-
nation (Hooda & Kosseim, 2017):

f[,](h1, h2) = [h1, h2] (1)

However, interactions between s1 and s2 cannot
be modeled with f[,] followed by a softmax regres-
sion. Indeed, f[,](h1, h2)θ can be rewritten as a
sum of independent contributions from h1 and h2,
namely θ[0:d]h1 + θ[d:2d]h2. Using a multi-layer
perceptron before the softmax would solve this
issue, but it also harms sentence representation
learning (Conneau et al., 2017; Logeswaran et al.,
2018), possibly because the perceptron allows for
accurate predictions even if the sentence embed-
dings lie in a convoluted space. To promote inter-
actions between h1 and h2, element-wise product
has been used in Baudiš et al. (2016):

f�(h1, h2) = h1 � h2 (2)

Absolute difference is another solution for sen-
tence similarity (Mueller & Thyagarajan, 2016),
and its element-wise variation may equally be
used to compute informative features:

f−(h1, h2) = |h1 − h2| (3)

The latter two were combined into a popular in-
stantiation, sometimes refered as heuristic match-
ing (Tai et al., 2015; Kiros et al., 2015; Mou et al.,

2016):

f�−(h1, h2) = [h1 � h2, |h2 − h1|] (4)

Although effective for certain similarity tasks,
f�− is symmetrical, and should be a poor choice
for tasks like entailment prediction or prediction
of discourse relations. For instance, if Re de-
notes entailment and (s1, s2)= (“It just rained”,
“The ground is wet”), (s1, Re, s2) should hold but
not (s2, Re, s1). The f�− composition function is
nonetheless used to train/evaluate models on en-
tailment (Conneau et al., 2017) or discourse rela-
tion prediction (Nie et al., 2017).

Sometimes [h1, h2] is concatenated to
f�−(h1, h2) (Ampomah et al., 2016; Conneau
et al., 2017). While the resulting composition
is asymmetrical, the asymmetrical component
involves no interaction as noted previously. We
note that this composition is very commonly used.
On the SNLI benchmark,1 12 out of the 25 listed
sentence embedding based models use it, and 7
use a weaker form (e.g. omitting f�).

The outer product ⊗ has been used instead
for asymmetric multiplicative interaction (Jernite
et al., 2017):

f⊗(h1, h2) = h1⊗h2 where (h1⊗h2)i,j = h1ih2j
(5)

This formulation is expressive but it forces gθ to
have d2 parameters per relation, which is pro-
hibitive when there are many relations and d is
high.

The problems outlined above are well known in
SRL. Thus, existing compositions (except f⊗) can
only model relations superficially for tasks cur-
rently used to train state of the art sentence en-
coders, like NLI or discourse connectives predic-
tion.

3 Statistical Relational Learning models

In this section we introduce the context of statisti-
cal relational learning (SRL) and relevant models.
Recently, SRL has focused on efficient and expres-
sive relation prediction based on embeddings. A
core goal of SRL (Getoor & Taskar, 2007) is to
induce whether a relationR holds between two ar-
bitrary entities e1, e2. As an example, we would
like to assign a score to (e1, R, e2) = (Paris, LO-
CATED IN, France) that reflects a high probability.

1nlp.stanford.edu/projects/snli/, as of
February 2019.

nlp.stanford.edu/projects/snli/


35

Model Scoring function Parameters

Unstructured ||e1 − e2||p -
TransE ||e1 + wr − e2||p wr ∈ Rd

RESCAL eT1Wre2 Wr ∈ Rd
2

DistMult < e1, wr, e2 > wr ∈ Rd
ComplEx Re < e1, wr, e2 > wr ∈ Cd

Table 1: Selected relational learning models. Un-
structured is from (Bordes et al., 2013a), TransE from
(Bordes et al., 2013b), RESCAL from (Nickel et al.,
2011), DistMult from (Yang et al., 2015) and (Trouil-
lon et al., 2016). Following the latter, < a, b, c > de-
notes

∑
k akbkck. Re(x) is the real part of x, and p is

commonly set to 1.

In embedding-based SRL models, entities ei have
vector representations in Rd and a scoring function
reflects truth values of relations. The scoring func-
tion should allow for relation-dependent reason-
ing over the latent space of entities. Scoring func-
tions can have relation-specific parameters, which
can be interpreted as relation embeddings. Table 1
presents an overview of a number of state of the art
relational models. We can distinguish two families
of models: subtractive and multiplicative.

The TransE scoring function is motivated by
the idea that translations in latent space can
model analogical reasoning and hierarchical re-
lationships. Dense word embeddings trained on
tasks related to the distributional hypothesis natu-
rally allow for analogical reasoning with transla-
tions without explicit supervision (Mikolov et al.,
2013). TransE generalizes the older Unstructured
model. We call them subtractive models.

The RESCAL, Distmult, and ComplEx scoring
functions can be seen as dot product matching be-
tween e1 and a relation-specific linear transforma-
tion of e2 (Liu et al., 2017). This transformation
helps checking whether e1 matches with some as-
pects of e2. RESCAL allows a full linear mapping
Wre2 but has a high complexity, while Distmult is
restricted to a component-wise weighting wr�e2.
ComplEx has fewer parameters than RESCAL but
still allows for the modeling of asymmetrical re-
lations. As shown in Liu et al. (2017), ComplEx
boils down to a restriction of RESCAL where Wr
is a block diagonal matrix. These blocks are 2-
dimensional, antisymmetric and have equal diag-
onal terms. Using such a form, even and odd in-
dexes of e’s dimensions play the roles of real and
imaginary numbers respectively. The ComplEx
model (Trouillon et al., 2016) and its variations

tied 
weights

h₁

relation representation f(h₁, h₂)

sentence 
encoder

s₁

h₂

sentence 
encoder

s₂

softmax gθ 
Statistical 
Relational 
Learning 
model

relations probabilities/scores

Figure 1: Implicit SRL model in text relation prediction

(Lacroix et al., 2018) yield state of the art perfor-
mance on knowledge base completion on numer-
ous evaluations.

4 Embeddings composition as SRL
models

We claim that several existing models (Conneau
et al., 2017; Nie et al., 2017; Baudiš et al.,
2016) boil down to SRL models where the sen-
tence embeddings (h1, h2) act as entity embed-
dings (e1, e2). This framework is depicted in fig-
ure 1. In this article we focus on sentence em-
beddings, although our framework can straightfor-
wardly be applied to other levels of language gran-
ularity (such as words, clauses, or documents).

Some models (Chen et al., 2017b; Seo et al.,
2017; Gong et al., 2018; Radford et al., 2018; De-
vlin et al., 2018) do not rely on explicit sentence
encodings to perform relation prediction. They
combine information of input sentences at ear-
lier stages, using conditional encoding or cross-
attention. There is however no straightforward
way to derive transferable sentence representa-
tions in this setting, and so these models are out
of the scope of this paper. They sometimes make
use of composition functions, so our work could
still be relevant to them in some respect.

In this section we will make a link between
sentence composition functions and SRL scor-
ing functions, and propose new scoring functions
drawing inspiration from SRL.

4.1 Linking composition functions and SRL
models

The composition function f� from equation 2
followed by a softmax regression yields a score
whose analytical form is identical to the Distmult
model score described in section 3. Let θR de-
note the softmax weights for relation R. The logit
score for the truth of (s1, R, s2) is f(h1, h2)θR =



36

(a) Score map of (s1, Rto the past, s2) over possible sentences
s2 using Unstructured composition.

(b) Score map of (s1, Rto the past, s2) over possible sentences
s2 using TransE composition.

(c) Score map of (s1, Rentailment, s2) over possible sentences
s2 using DistMult composition.

(d) Score map of (s1, Rentailment, s2) over possible sentences
s2 using ComplEx composition.

Figure 2: Possible scoring function values according to different composition functions. s1 and R are fixed and
color brightness reflects likelihood of (s1, R, s2) for each position of embedding s2. (b) and (d) are respectively
more expressive than (a) and (c).

(h1�h2)θR which is equal to the Distmult scoring
function < h1, θR, h2 > if h1, h2 act as entities
embeddings and θR as the relation weight wR .

Similarly, the composition f− from equation 3
followed by a softmax regression can be seen as
an element-wise weighted score of Unstructured
(both are equal if softmax weights are all unitary).

Thus, f�− from 4 (with softmax regression)
can be seen as a weighted ensemble of Unstruc-
tured and Distmult. These two models are respec-
tively outperformed by TransE and ComplEx on
knowledge base link prediction by a large margin
(Trouillon et al., 2016; Bordes et al., 2013a). We
therefore propose to change the Unstructured and
Distmult in f�− such that they match their respec-
tive state of the art variations in the following sec-
tions. We will also show the implications of these
refinements.

4.2 Casting TransE as a composition

Simply replacing |h2 − h1| with

ft(h1, h2) = |h2 − h1 + t|, where t ∈ Rd (6)

would make the model analogous to TransE. t is
learned and is shared by all relations. A relation-
specific translation tR could be used but it would
make f relation-specific. Instead, here, each di-
mension of ft(h1, h2) can be weighted according

to a given relation. Non-zero t makes ft asym-
metrical and also yields features that allow for the
checking of an analogy between s1 and s2. Sen-
tence embeddings often rely on pre-trained word
embeddings which have demonstrated strong ca-
pabilities for analogical reasoning. Some analo-
gies, such as part-whole, are computable with off-
the-shelf word embeddings (Chen et al., 2017a)
and should be very informative for natural lan-
guage inference tasks. As an illustration, let us
consider an artificial semantic space (depicted in
figures 2a and 2b) where we posit that there is a
“to the past” translation t so that h1 + t is the em-
bedding of a sentence s1 changed to the past tense.
Unstructured is not able to leverage this semantic
space to correctly score (s1, Rto the past, s2) while
TransE is well tailored to provide highest scores
for sentences near h1 + t̂ where t̂ is an estimation
of t that could be learned from examples.

4.3 Casting ComplEx as a composition

Let us partition h dimensions into two equally
sized sets R and I, e.g. even and odd dimension
indices of h. We propose a new function fC as
a way to fit the ComplEx scoring function into a
composition function.

fC(h1, h2) = [h
R
1 � hR2 + hI1 � hI2 ,
hR1 � hI2 − hI1 � hR2 ]

(7)



37

fC(h1, h2) multiplied by softmax weights θr
is equivalent to the ComplEx scoring function
Re < h1, θr, h2 >. The first half of θr weights
corresponds to the real part of ComplEx rela-
tion weights while the last half corresponds to the
imaginary part.
fC is to the ComplEx scoring function what f�

is to the DistMult scoring function. Intuitively,
ComplEx is a minimal way to model interactions
between distinct latent dimensions while Distmult
only allows for identical dimensions to interact.

Let us consider a new artificial semantic space
(shown in figures 2c and 2d) where the first di-
mension is high when a sentence means that it just
rained, and the second dimension is high when the
ground is wet. Over this semantic space, Distmult
is only able to detect entailment for paraphrases
whereas ComplEx is also able to naturally model
that (“it just rained”, Rentailment, “the ground is
wet”) should be high while its converse should not.

We also propose two more general versions of
fC :

fCα(h1, h2) = [h
R
1 � hR2 , hI1 � hI2 ,

hR1 � hI2 − hI1 � hR2 ]
(8)

fCβ (h1, h2) = [h
R
1 � hR2 , hI1 � hI2 ,
hR1 � hI2 , hI1 � hR2 ]

(9)

fCα can be seen as Distmult concatenated with
the asymmetrical part of ComplEx and fCβ can be
seen as RESCAL with unconstrained block diago-
nal relation matrices.

5 On the evaluation of relational models

The SentEval framework (Conneau et al., 2017)
provides a general evaluation for transferable sen-
tence representations, with open source evalua-
tion code. One only needs to specify a sen-
tence encoder function, and the framework per-
forms classification tasks or relation prediction
tasks using cross-validated logistic regression on
embeddings or composed sentence embeddings.
Tasks include sentiment analysis, entailment, tex-
tual similarity, textual relatedness, and paraphrase
detection. These tasks are a rich way to train or
evaluate sentence representations since in a triple
(s1, R, s2), we can see (R, s2) as a label for s1
(Baudiš et al., 2016). Unfortunately, the rela-
tional tasks hard-code the composition function

from equation 4. From our previous analysis, we
believe this composition function favors the use of
contextual/lexical similarity rather than high-level
reasoning and can penalize representations based
on more semantic aspects. This bias could harm
research since semantic representation is an im-
portant next step for sentence embedding. Train-
ing/evaluation datasets are also arguably flawed
with respect to relational aspects since several re-
cent studies (Dasgupta et al., 2018; Poliak et al.,
2018; Gururangan et al., 2018; Glockner et al.,
2018) show that InferSent, despite being state of
the art on SentEval evaluation tasks, has poor per-
formance when dealing with asymmetrical tasks
and non-additive composition of words. In addi-
tion to providing new ways of training sentence
encoders, we will also extend the SentEval evalu-
ation framework with a more expressive composi-
tion function when dealing with relational transfer
tasks, which improves results even when the sen-
tence encoder was not trained with it.

6 Experiments

Our goal is to show that transferable sentence rep-
resentation learning and relation prediction tasks
can be improved when our expressive composi-
tions are used instead of the composition from
equation 4. We train our relational model adap-
tations on two relation prediction base tasks (T ),
one supervised (T = NLI ) and one unsupervised
(T = Disc) described below, and evaluate sen-
tence/relation representations on base and trans-
fer tasks using the SentEval framework in order
to quantify the generalization capabilities of our
models. Since we use minor modifications of In-
ferSent and SentEval, our experiments are easily
reproducible.

6.1 Training tasks

Natural language inference (T = NLI)’s goal is
to predict whether the relation between two sen-
tences (premise and hypothesis) is Entailment,
Contradiction or Neutral. We use the combination
of SNLI dataset (Bowman et al., 2015) and MNLI
dataset (Williams et al., 2018). We call AllNLI
the resulting dataset of 1M examples. Conneau
et al. (2017) claim that NLI data allows univer-
sal sentence representation learning. They used
the f�,− composition function with concatenated
sentence representations in order to train their In-
fersent model.



38

name N task C representation(s) used

MR 11k sentiment (movies) 2 h1
SUBJ 10k subjectivity/objectivity 2 h1
MPQA 11k opinion polarity 2 h1
TREC 6k question-type 6 h1
SICKms 10k NLI 3 fm,s(h1, h2)
MRPCms 4k paraphrase detection 2 (fm,s(h1, h2) + (fm,s(h2, h1))/2
PDTBms 17k discursive relation 5 fm,s(h1, h2)
STS14 4.5k similarity - cos(h1, h2)

Table 2: Transfer evaluation tasks. N = number of training examples; C = number of classes if applicable. h1, h2
are sentence representations, fm,s a composition function from section 4.

We also train on the prediction of discourse con-
nectives between sentences/clauses (T = Disc).
Discourse connectives make discourse relations
between sentences explicit. In the sentence I live
in Paris but I’m often elsewhere, the word but
highlights that there is a contrast between the two
clauses it connects. We use Malmi et al.’s (2018)
dataset of selected 400k instances with 20 dis-
course connectives (e.g. however, for example)
with the provided train/dev/test split. This dataset
has no other supervision than the list of 20 con-
nectives. Nie et al. (2017) used f�,− concatenated
with the sum of sentence representations to train
their model, DisSent, on a similar task and showed
that their encoder was general enough to perform
well on SentEval tasks. They use a dataset that is,
at the time of writing, not publicly available.

6.2 Evaluation tasks

Table 2 provides an overview of different transfer
tasks that will be used for evaluation. We added
another relation prediction task, the PDTB coarse-
grained implicit discourse relation task, to Sent-
Eval. This task involves predicting a discursive
link between two sentences among {Comparison,
Contingency, Entity based coherence, Expansion,
Temporal}. We followed the setup of Pitler et al.
(2009), without sampling negative examples in
training. MRPC, PDTB and SICK will be tested
with two composition functions: besides SentE-
val composition f�,−, we will use fCβ ,− for trans-
fer learning evaluation, since it has the most gen-
eral multiplicative interaction and it does not pe-
nalize models that do not learn a translation. For
all tasks except STS14, a cross-validated logistic
regression is used on the sentence or relation rep-
resentation. The evaluation of the STS14 task re-
lies on Pearson or Spearman correlation between
cosine similarity and the target. We force the com-
position function to be symmetrical on the MRPC

task since paraphrase detection should be invariant
to permutation of input sentences.

6.3 Setup

We want to compare the different instances of f .
We follow the setup of Infersent (Conneau et al.,
2017): we learn to encode sentences into h with
a bi-directional LSTM using element-wise max
pooling over time. The dimension size of h is
4096. Word embeddings are fixed GloVe with 300
dimensions, trained on Common Crawl 840B.2

Optimization is done with SGD and decreasing
learning rate until convergence.

The only difference with regard to Infersent is
the composition. Sentences are composed with
six different compositions for training according
to the following template:

fm,s,1,2(h1, h2) = [fm(h1, h2), fs(h1, h2), h1, h2]
(10)

fs (subtractive interaction) is in {f−, ft}, fm
(multiplicative interaction) is in {f�, fCα , fCβ}.
We do not consider fC since it yielded inferior re-
sults in our early experiments using NLI and Sent-
Eval development sets.
fm,s,1,2(h1, h2) is fed directly to a softmax re-

gression. Note that Infersent uses a multi-layer
perceptron before the softmax, but uses only lin-
ear activations, so f�,−,1,2(h1, h2) is analytically
equivalent to Infersent when T = NLI .

6.4 Results

Having run several experiments with different ini-
tializations, the standard deviations between them
do not seem to be negligible. We decided to take
these into account when reporting scores, con-
trary to previous work (Kiros et al., 2015; Con-
neau et al., 2017): we average the scores of 6 dis-
tinct runs for each task and use standard deviations

2https://nlp.stanford.edu/projects/glove/



39

Models trained on natural language inference (T = NLI )

m,s MR SUBJ MPQA TREC MRPC�− PDTB
�
− SICK

�
− STS14 T AVG

�,− 81.2 92.7 90.4 89.6 76.1 46.7 86.6 69.5 84.2 79.1
α,− 81.4 92.8 90.5 89.6 75.4 46.6 86.7 69.5 84.3 79.1
β,− 81.2 92.6 90.5 89.6 76 46.5 86.6 69.5 84.2 79.1
�, t 81.1 92.7 90.5 89.7 76.5 46.4 86.5 70.0 84.8 79.2
α, t 81.3 92.6 90.6 89.2 76.2 47.2 86.5 70.0 84.6 79.2
β, t 81.2 92.7 90.4 88.5 75.8 47.3 86.8 69.8 84.2 79.1

Table 3: SentEval and base task evaluation results for the models trained on natural language inference (T = NLI );
AllNLI is used for training. All scores are accuracy percentages, except STS14, which is Pearson correlation
percentage. AVG denotes the average of the SentEval scores.

Models trained on discourse connective prediction (T = Disc)

m,s MR SUBJ MPQA TREC MRPC�− PDTB
�
− SICK

�
− STS14 T AVG

�,− 80.4 92.7 90.2 89.5 74.5 47.3 83.2 57.9 35.7 77
α,− 80.4 92.9 90.2 90.2 75 47.9 83.3 57.8 35.9 77.2
β,− 80.2 92.8 90.2 88.4 74.9 47.5 82.9 57.7 35.9 76.8
�, t 80.2 92.8 90.2 90.4 74.6 48.5 83.4 58.6 36.1 77.3
α, t 80.2 92.9 90.3 90.3 75.1 47.8 83.2 58.3 36.1 77.3
β, t 80.2 92.8 90.3 89.7 74.4 47.9 83.7 58.2 35.7 77.2

Table 4: SentEval and base task evaluation results for the models trained on discourse connective prediction (T =
Disc). All scores are accuracy percentages, except STS14, which is Pearson correlation percentage. AVG denotes
the average of the SentEval scores.

under normality assumption to compute signifi-
cance. Table 3 shows model scores for T = NLI ,
while Table 4 shows scores for T = Disc. For
comparison, Table 5 shows a number of important
models from previous work. Finally, in Table 6,
we present results for sentence relation tasks that
use an alternative composition function (fCβ ,−) in-
stead of the standard composition function used in
SentEval.

For sentence representation learning, the base-
line, f�− composition already performs rather
well, being on par with the InferSent scores of the
original paper, as would be expected. However,
macro-averaging all accuracies, it is the second
worst performing model. fCα,t,1,2 is the best per-
forming model, and all three best models use the
translation (s = t). On relational transfer tasks,
training with fCα,t,1,2 and using complex Cβ for
transfer (Table 6) always outperforms the baseline
(f�,−,1,2 with�− composition in Tables 3 and 4).
Averaging accuracies of those transfer tasks, this
result is significant for both training tasks at level
p < 0.05 (using Bonferroni correction accounting
for the 5 comparisons). On base tasks and the aver-
age of non-relational transfer tasks (MR, MPQA,
SUBJ, TREC), our proposed compositions are on
average slightly better than f�,−,1,2. Representa-
tions learned with our proposed compositions can

still be compared with simple cosine similarity: all
three methods using the translational composition
(s = t) very significantly outperform the baseline
(significant at level p < 0.01 with Bonferroni cor-
rection) on STS14 for T = NLI . Thus, we believe
fCα,t,1,2 has more robust results and could be a bet-
ter default choice than f�,−,1,2 as composition for
representation learning. 3

Additionally, using Cβ (Table 6) instead of �
(Tables 3 and 4) for transfer learning in relational
transfer tasks (PDTB, MRPC, SICK) yields a sig-
nificant improvement on average, even when m =
� was used for training (p < 0.001). Therefore,
we believe fCβ ,− is an interesting composition for
inference or evaluation of models regardless of
how they were trained.

7 Related work

There are numerous interactions between SRL and
NLP. We believe that our framework merges two
specific lines of work: relation prediction and
modeling textual relational tasks.

Some previous NLP work focused on compo-
sition functions for relation prediction between

3Note that our compositions are also beneficial with re-
gard to convergence speed: on average, each of our proposed
compositions needed less epochs to converge than the base-
line f�,−,1,2, for both training tasks.



40

Comparison models

model MR SUBJ MPQA TREC MRPC�− PDTB
�
− SICK

�
− STS14 AVG

Infersent 81.1 92.4 90.2 88.2 76.2 46.7- 86.3 70 78.9
SkipT 76.5 93.6 87.1 92.2 73 - 82.3 29 -
BoW 77.2 91.2 87.9 83 72.2 43.9 78.4 54.6 73.6

Table 5: Comparison models from previous work. InferSent represents the original results from Conneau et al.
(2017), SkipT is SkipThought from Kiros et al. (2015), and BoW is our re-evaluation of GloVe Bag of Words from
Conneau et al. (2017). AVG denotes the average of the SentEval scores..

T = Disc T = NLI

m,s MRPCβ− PDTB
β
− SICK

β
− AVG MRPC

β
− PDTB

β
− SICK

β
− AVG

�,− 74.8 48.2 83.6 68.9 76.2 47.2 86.9 70.1
α,− 74.9 49.3 83.8 69.3 75.9 47.1 86.9 70
β,− 75 48.8 83.4 69.1 75.8 47 87 69.9
�, t 74.9 48.7 83.6 69.1 76.2 47.8 86.8 70.3
α, t 75.2 48.6 83.5 69.1 76.2 47.6 87.3 70.4
β, t 74.6 48.9 83.9 69.1 76.2 47.8 87 70.3

Table 6: Results for sentence relation tasks using an alternative composition function (fCβ ,−) during evaluation.
AVG denotes the average of the three tasks.

text fragments, even though they ignored SRL and
only dealt with word units. Word2vec (Mikolov
et al., 2013) has sparked a great interest for this
task with word analogies in the latent space.
Levy & Goldberg (2014) explored different scor-
ing functions between words, notably for analo-
gies. Hypernymy relations were also studied, by
Chang et al. (2018) and Fu et al. (2014). Levy et al.
(2015) proposed tailored scoring functions. Even
the skipgram model (Mikolov et al., 2013) can
be formulated as finding relations between con-
text and target words. We did not empirically ex-
plore textual relational learning at the word level,
but we believe that it would fit in our framework,
and could be tested in future studies. Numerous
approaches (Chen et al., 2017b; Seok et al., 2016;
Gong et al., 2018; Joshi et al., 2019) were pro-
posed to predict inference relations between sen-
tences, but don’t explicitely use sentence embed-
dings. Instead, they encode sentences jointly, pos-
sibly with the help of previously cited word com-
positions, therefore it would also be interesting
to try applying our techniques within their frame-
work.

Some modeling aspects of textual relational
learning have been formally investigated by
Baudiš et al. (2016). They noticed the genericity
of relational problems and explored multi-task and
transfer learning on relational tasks. Their work
is complementary to ours since their framework
unifies tasks while ours unifies composition func-

tions. Subsequent approaches use relational tasks
for training and evaluation on specific datasets
(Conneau et al., 2017; Nie et al., 2017).

8 Conclusion

We have demonstrated that a number of existing
models used for textual relational learning rely on
composition functions that are already used in Sta-
tistical Relational Learning. By taking into ac-
count previous insights from SRL, we proposed
new composition functions and evaluated them.
These composition functions are all simple to im-
plement and we hope that it will become standard
to try them on relational problems. Larger scale
data might leverage these more expressive compo-
sitions, as well as more compositional, asymmet-
ric, and arguably more realistic datasets (Dasgupta
et al., 2018; Gururangan et al., 2018). Finally, our
compositions can also be helpful to improve in-
terpretability of embeddings, since they can help
measure relation prediction asymmetry. Analo-
gies through translations helped interpreting word
embeddings, and perhaps anlyzing our learned t
translation could help interpreting sentence em-
beddings.



41

References
Isaac K E Ampomah, Seong-bae Park, and Sang-jo

Lee. A Sentence-to-Sentence Relation Network for
Recognizing Textual Entailment. World Academy of
Science, Engineering and Technology International
Journal of Computer and Information Engineering,
10(12):1955–1958, 2016.

Petr Baudiš, Jan Pichl, Tomáš Vyskočil, and Jan
Šedivý. Sentence Pair Scoring: Towards Unified
Framework for Text Comprehension. 2016. URL
http://arxiv.org/abs/1603.06127.

Antoine Bordes, Xavier Glorot, Jason Weston, and
Yoshua Bengio. A Semantic Matching Energy
Function for Learning with Multi-relational Data.
Machine Learning, 2013a. ISSN 0885-6125.
doi: 10.1007/s10994-013-5363-6. URL http:
//arxiv.org/abs/1301.3485.

Antoine Bordes, Nicolas Usunier, Jason Weston, and
Oksana Yakhnenko. Translating Embeddings for
Modeling Multi-Relational Data. Advances in NIPS,
26:2787–2795, 2013b. ISSN 10495258. doi: 10.
1007/s13398-014-0173-7.2.

Samuel R Bowman, Gabor Angeli, Christopher Potts,
and Christopher D Manning. A large annotated cor-
pus for learning natural language inference. Pro-
ceedings of the 2015 Conference on Empirical Meth-
ods in Natural Language Processing,Lisbon, Portu-
gal, 17-21 September 2015, (September):632–642,
2015. ISSN 9781941643327.

Haw-Shiuan Chang, Ziyun Wang, Luke Vilnis, and
Andrew McCallum. Distributional inclusion vec-
tor embedding for unsupervised hypernymy detec-
tion. In Proceedings of the 2018 Conference of
the North American Chapter of the Association for
Computational Linguistics: Human Language Tech-
nologies, Volume 1 (Long Papers), pp. 485–495,
New Orleans, Louisiana, June 2018. Association
for Computational Linguistics. doi: 10.18653/v1/
N18-1045. URL https://www.aclweb.org/
anthology/N18-1045.

Dawn Chen, Joshua C. Peterson, and Tom Grif-
fiths. Evaluating vector-space models of
analogy. In Proceedings of the 39th Annual
Meeting of the Cognitive Science Society,
CogSci 2017, London, UK, 16-29 July 2017,
2017a. URL https://mindmodeling.org/
cogsci2017/papers/0340/index.html.

Qian Chen, Xiaodan Zhu, Zhen-Hua Ling, Si Wei,
Hui Jiang, and Diana Inkpen. Enhanced lstm for
natural language inference. In Regina Barzilay
and Min-Yen Kan (eds.), ACL (1), pp. 1657–
1668. Association for Computational Linguis-
tics, 2017b. ISBN 978-1-945626-75-3. URL
http://dblp.uni-trier.de/db/conf/
acl/acl2017-1.html#ChenZLWJI17.

Alexis Conneau, Douwe Kiela, Holger Schwenk, Loic
Barrault, and Antoine Bordes. Supervised Learning

of Universal Sentence Representations from Natural
Language Inference Data. Emnlp, 2017.

Ishita Dasgupta, Demi Guo, Andreas Stuhlmüller,
Samuel J. Gershman, and Noah D. Goodman. Eval-
uating Compositionality in Sentence Embeddings.
(2011), 2018. URL http://arxiv.org/abs/
1802.04302.

Jacob Devlin, Ming-Wei Chang, Kenton Lee, and
Kristina Toutanova. Bert: Pre-training of deep bidi-
rectional transformers for language understanding.
arXiv preprint arXiv:1810.04805, 2018.

Ruiji Fu, Jiang Guo, Bing Qin, Wanxiang Che, Haifeng
Wang, and Ting Liu. Learning semantic hierar-
chies via word embeddings. In Proceedings of
the 52nd Annual Meeting of the Association for
Computational Linguistics (Volume 1: Long Pa-
pers), pp. 1199–1209, Baltimore, Maryland, June
2014. Association for Computational Linguistics.
doi: 10.3115/v1/P14-1113. URL https://www.
aclweb.org/anthology/P14-1113.

Lise Getoor and Ben Taskar. Introduction to Statisti-
cal Relational Learning (Adaptive Computation and
Machine Learning). The MIT Press, 2007. ISBN
0262072882.

Max Glockner, Vered Shwartz, and Yoav Goldberg.
Breaking NLI Systems with Sentences that Re-
quire Simple Lexical Inferences. Proceedings of
the 56th Annual Meeting of the Association for
Computational Linguistics (Short Papers), (3):1–6,
2018. URL http://arxiv.org/abs/1805.
02266.

Yichen Gong, Heng Luo, and Jian Zhang. Natu-
ral language inference over interaction space. In
International Conference on Learning Represen-
tations, 2018. URL https://openreview.
net/forum?id=r1dHXnH6-.

Suchin Gururangan, Swabha Swayamdipta, Omer
Levy, Roy Schwartz, Samuel Bowman, and Noah A.
Smith. Annotation artifacts in natural language in-
ference data. In Proceedings of the 2018 Conference
of the North American Chapter of the Association
for Computational Linguistics: Human Language
Technologies, Volume 2 (Short Papers), pp. 107–
112, New Orleans, Louisiana, June 2018. Associa-
tion for Computational Linguistics. doi: 10.18653/
v1/N18-2017. URL https://www.aclweb.
org/anthology/N18-2017.

Sohail Hooda and Leila Kosseim. Argument la-
beling of explicit discourse relations using lstm
neural networks. In Proceedings of the In-
ternational Conference Recent Advances in Nat-
ural Language Processing, RANLP 2017, pp.
309–315, Varna, Bulgaria, September 2017. IN-
COMA Ltd. doi: 10.26615/978-954-452-049-6
042. URL https://doi.org/10.26615/
978-954-452-049-6_042.

http://arxiv.org/abs/1603.06127
http://arxiv.org/abs/1301.3485
http://arxiv.org/abs/1301.3485
https://www.aclweb.org/anthology/N18-1045
https://www.aclweb.org/anthology/N18-1045
https://mindmodeling.org/cogsci2017/papers/0340/index.html
https://mindmodeling.org/cogsci2017/papers/0340/index.html
http://dblp.uni-trier.de/db/conf/acl/acl2017-1.html#ChenZLWJI17
http://dblp.uni-trier.de/db/conf/acl/acl2017-1.html#ChenZLWJI17
http://arxiv.org/abs/1802.04302
http://arxiv.org/abs/1802.04302
https://www.aclweb.org/anthology/P14-1113
https://www.aclweb.org/anthology/P14-1113
http://arxiv.org/abs/1805.02266
http://arxiv.org/abs/1805.02266
https://openreview.net/forum?id=r1dHXnH6-
https://openreview.net/forum?id=r1dHXnH6-
https://www.aclweb.org/anthology/N18-2017
https://www.aclweb.org/anthology/N18-2017
https://doi.org/10.26615/978-954-452-049-6_042
https://doi.org/10.26615/978-954-452-049-6_042


42

Yacine Jernite, Samuel R. Bowman, and David Sontag.
Discourse-Based Objectives for Fast Unsupervised
Sentence Representation Learning. 2017. URL
http://arxiv.org/abs/1705.00557.

Mandar Joshi, Eunsol Choi, Omer Levy, Daniel S.
Weld, and Luke Zettlemoyer. pair2vec: Composi-
tional word-pair embeddings for cross-sentence in-
ference. In NAACL, 2019. URL http://arxiv.
org/abs/1810.08854.

Ryan Kiros, Yukun Zhu, Ruslan R Salakhutdinov,
Richard Zemel, Raquel Urtasun, Antonio Torralba,
and Sanja Fidler. Skip-thought vectors. In Advances
in neural information processing systems, pp. 3294–
3302, 2015.

Timothée Lacroix, Nicolas Usunier, and Guillaume
Obozinski. Canonical tensor decomposition for
knowledge base completion. In ICML, 2018.

Omer Levy and Yoav Goldberg. Linguistic Reg-
ularities in Sparse and Explicit Word Represen-
tations. Proceedings of the Eighteenth Confer-
ence on Computational Natural Language Learn-
ing, pp. 171–180, 2014. doi: 10.3115/
v1/W14-1618. URL http://aclweb.org/
anthology/W14-1618.

Omer Levy, Steffen Remus, Chris Biemann, and
Ido Dagan. Do Supervised Distributional
Methods Really Learn Lexical Inference Rela-
tions? Naacl-2015, pp. 970–976, 2015. URL
http://www.aclweb.org/anthology/N/
N15/N15-1098.pdf.

Hanxiao Liu, Yuexin Wu, and Yiming Yang. Ana-
logical Inference for Multi-Relational Embeddings.
Icml, 2017. ISSN 1938-7228. URL http://
arxiv.org/abs/1705.02426.

Lajanugen Logeswaran, Honglak Lee, and Dragomir
Radev. Sentence Ordering using Recurrent Neu-
ral Networks. pp. 1–15, 2016. URL http://
arxiv.org/abs/1611.02654.

Lajanugen Logeswaran, Honglak Lee, and
Dragomir R. Radev. Sentence ordering and
coherence modeling using recurrent neural net-
works. In Proceedings of the Thirty-Second AAAI
Conference on Artificial Intelligence, (AAAI-18),
the 30th innovative Applications of Artificial
Intelligence (IAAI-18), and the 8th AAAI Sym-
posium on Educational Advances in Artificial
Intelligence (EAAI-18), New Orleans, Louisiana,
USA, February 2-7, 2018, pp. 5285–5292, 2018.
URL https://www.aaai.org/ocs/index.
php/AAAI/AAAI18/paper/view/17011.

Eric Malmi, Daniele Pighin, Sebastian Krause, and
Mikhail Kozhevnikov. Automatic prediction of dis-
course connectives. In Proceedings of the 11th
Language Resources and Evaluation Conference,
Miyazaki, Japan, May 2018. European Language
Resource Association. URL https://www.
aclweb.org/anthology/L18-1260.

Tomas Mikolov, Kai Chen, Greg Corrado, and Jeffrey
Dean. Distributed Representations of Words and
Phrases and their Compositionality. Nips, pp. 1–9,
2013. ISSN 10495258. doi: 10.1162/jmlr.2003.3.
4-5.951.

Lili Mou, Rui Men, Ge Li, Yan Xu, Lu Zhang, Rui
Yan, and Zhi Jin. Natural language inference by
tree-based convolution and heuristic matching. In
Proceedings of the 54th Annual Meeting of the As-
sociation for Computational Linguistics (Volume 2:
Short Papers), pp. 130–136, Berlin, Germany, Au-
gust 2016. Association for Computational Linguis-
tics. doi: 10.18653/v1/P16-2022. URL https://
www.aclweb.org/anthology/P16-2022.

Jonas Mueller and Aditya Thyagarajan. Siamese Re-
current Architectures for Learning Sentence Simi-
larity. In AAAI, pp. 2786–2792, 2016.

Maximilian Nickel, Volker Tresp, and Hans-Peter
Kriegel. A Three-Way Model for Collective Learn-
ing on Multi-Relational Data. Icml, pp. 809—-816,
2011.

Allen Nie, Erin D. Bennett, and Noah D. Goodman.
DisSent: Sentence Representation Learning from
Explicit Discourse Relations. 2017. URL http:
//arxiv.org/abs/1710.04334.

Emily Pitler, Annie Louis, and Ani Nenkova. Auto-
matic sense prediction for implicit discourse rela-
tions in text. Proceedings of the Joint Conference of
the 47th Annual Meeting of the ACL and the 4th In-
ternational Joint Conference on Natural Language
Processing of the AFNLP Volume 2 ACLIJCNLP 09,
2(August):683–691, 2009. doi: 10.3115/1690219.
1690241. URL http://www.aclweb.org/
anthology/P/P09/P09-1077.

Adam Poliak, Jason Naradowsky, Aparajita Haldar,
Rachel Rudinger, and Benjamin Van Durme. Hy-
pothesis Only Baselines in Natural Language Infer-
ence. Proceedings of the 7th Joint Conference on
Lexical and Computational Semantics, (1):180–191,
2018.

Alec Radford, Karthik Narasimhan, Tim Salimans,
and Ilya Sutskever. Improving language under-
standing by generative pre-training. https:
//www.cs.ubc.ca/˜amuham01/LING530/
papers/radford2018improving.pdf,
2018.

Min Joon Seo, Aniruddha Kembhavi, Ali Farhadi,
and Hannaneh Hajishirzi. Bidirectional attention
flow for machine comprehension. In 5th Inter-
national Conference on Learning Representations,
ICLR 2017, Toulon, France, April 24-26, 2017, Con-
ference Track Proceedings, 2017. URL https://
openreview.net/forum?id=HJ0UKP9ge.

Miran Seok, Hye-Jeong Song, Chan-Young Park,
Jong-Dae Kim, and Yu-Seop Kim. Named En-
tity Recognition using Word Embedding as a Fea-
ture 1. International Journal of Software Engi-
neering and Its Applications, 10(2):93–104, 2016.

http://arxiv.org/abs/1705.00557
http://arxiv.org/abs/1810.08854
http://arxiv.org/abs/1810.08854
http://aclweb.org/anthology/W14-1618
http://aclweb.org/anthology/W14-1618
http://www.aclweb.org/anthology/N/N15/N15-1098.pdf
http://www.aclweb.org/anthology/N/N15/N15-1098.pdf
http://arxiv.org/abs/1705.02426
http://arxiv.org/abs/1705.02426
http://arxiv.org/abs/1611.02654
http://arxiv.org/abs/1611.02654
https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/view/17011
https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/view/17011
https://www.aclweb.org/anthology/L18-1260
https://www.aclweb.org/anthology/L18-1260
https://www.aclweb.org/anthology/P16-2022
https://www.aclweb.org/anthology/P16-2022
http://arxiv.org/abs/1710.04334
http://arxiv.org/abs/1710.04334
http://www.aclweb.org/anthology/P/P09/P09-1077
http://www.aclweb.org/anthology/P/P09/P09-1077
https://www.cs.ubc.ca/~amuham01/LING530/papers/radford2018improving.pdf
https://www.cs.ubc.ca/~amuham01/LING530/papers/radford2018improving.pdf
https://www.cs.ubc.ca/~amuham01/LING530/papers/radford2018improving.pdf
https://openreview.net/forum?id=HJ0UKP9ge
https://openreview.net/forum?id=HJ0UKP9ge


43

ISSN 1738-9984. doi: 10.14257/ijseia.2016.10.2.
08. URL http://dx.doi.org/10.14257/
ijseia.2016.10.2.08.

Richard Socher, Danqi Chen, Christopher Man-
ning, Danqi Chen, and Andrew Ng. Reason-
ing With Neural Tensor Networks for Knowl-
edge Base Completion. In Neural Information
Processing Systems (2003), pp. 926–934, 2013.
URL https://nlp.stanford.edu/pubs/
SocherChenManningNg{_}NIPS2013.pdf.

Kai Sheng Tai, Richard Socher, and Christopher D.
Manning. Improved semantic representations from
tree-structured long short-term memory networks.
In Proceedings of the 53rd Annual Meeting of the
Association for Computational Linguistics and the
7th International Joint Conference on Natural Lan-
guage Processing of the Asian Federation of Nat-
ural Language Processing, ACL 2015, July 26-31,
2015, Beijing, China, Volume 1: Long Papers, pp.
1556–1566, 2015. URL http://aclweb.org/
anthology/P/P15/P15-1150.pdf.

Théo Trouillon, Johannes Welbl, Sebastian Riedel,
Éric Gaussier, and Guillaume Bouchard. Com-
plex Embeddings for Simple Link Prediction. In
Proceedings of the 33nd International Conference
on Machine Learning, volume 48, 2016. ISBN
9781510829008. URL http://arxiv.org/
abs/1606.06357.

Adina Williams, Nikita Nangia, and Samuel Bowman.
A broad-coverage challenge corpus for sentence un-
derstanding through inference. In Proceedings of
the 2018 Conference of the North American Chap-
ter of the Association for Computational Linguistics:
Human Language Technologies, Volume 1 (Long Pa-
pers), pp. 1112–1122, New Orleans, Louisiana, June
2018. Association for Computational Linguistics.
doi: 10.18653/v1/N18-1101. URL https://
www.aclweb.org/anthology/N18-1101.

Min Chul Yang, Do Gil Lee, So Young Park, and
Hae Chang Rim. Knowledge-based question an-
swering using the semantic embedding space. Ex-
pert Systems with Applications, 42(23):9086–9104,
2015. ISSN 09574174. doi: 10.1016/j.eswa.
2015.07.009. URL http://dx.doi.org/10.
1016/j.eswa.2015.07.009.

http://dx.doi.org/10.14257/ijseia.2016.10.2.08
http://dx.doi.org/10.14257/ijseia.2016.10.2.08
https://nlp.stanford.edu/pubs/SocherChenManningNg{_}NIPS2013.pdf
https://nlp.stanford.edu/pubs/SocherChenManningNg{_}NIPS2013.pdf
http://aclweb.org/anthology/P/P15/P15-1150.pdf
http://aclweb.org/anthology/P/P15/P15-1150.pdf
http://arxiv.org/abs/1606.06357
http://arxiv.org/abs/1606.06357
https://www.aclweb.org/anthology/N18-1101
https://www.aclweb.org/anthology/N18-1101
http://dx.doi.org/10.1016/j.eswa.2015.07.009
http://dx.doi.org/10.1016/j.eswa.2015.07.009

