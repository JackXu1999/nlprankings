



















































Large-Scale Representation Learning from Visually Grounded Untranscribed Speech


Proceedings of the 23rd Conference on Computational Natural Language Learning, pages 55–65
Hong Kong, China, November 3-4, 2019. c©2019 Association for Computational Linguistics

55

Large-scale representation learning from visually grounded
untranscribed speech

Gabriel Ilharco†∗ Yuan Zhang‡ Jason Baldridge‡
†Paul G. Allen School of Computer Science & Engineering,

University of Washington, Seattle, WA, USA
‡Google Research, Mountain View, CA, USA

gamaga@cs.washington.edu, {zhangyua,jridge}@google.com

Abstract
Systems that can associate images with their
spoken audio captions are an important step
towards visually grounded language learning.
We describe a scalable method to automati-
cally generate diverse audio for image caption-
ing datasets. This supports pretraining deep
networks for encoding both audio and images,
which we do via a dual encoder that learns to
align latent representations from both modali-
ties. We show that a masked margin softmax
loss for such models is superior to the stan-
dard triplet loss. We fine-tune these models on
the Flickr8k Audio Captions Corpus and ob-
tain state-of-the-art results—improving recall
in the top 10 from 29.6% to 49.5%. We also
obtain human ratings on retrieval outputs to
better assess the impact of incidentally match-
ing image-caption pairs that were not associ-
ated in the data, finding that automatic evalua-
tion substantially underestimates the quality of
the retrieved results.

1 Introduction

Natural language learning in people starts with
speech, not text. Text is tidy: it comes in con-
venient symbolic units that vary little from one
writer to another. Speech is continuous and messy:
the sounds used to convey a given word are modi-
fied by those of surrounding words, and the rate of
speech, its pitch, and more vary across speakers and
even for the same speaker in different contexts. As
such, problems involving speech provide distinct
challenges and opportunities for learning language
representations that text-based work—which repre-
sents the vast majority—gets a free pass on.

Recent work has explored various means to trans-
form raw speech into symbolic forms with little or
no supervision (Park and Glass, 2007; Varadara-
jan et al., 2008; Ondel et al., 2016; Kamper et al.,

∗ Work done as a member of the Google AI Residency
Program.

Figure 1: Models that encode speech segments and im-
ages into a shared latent space enable images to be re-
trieved using their audio descriptions (top) and to asso-
ciate images with spoken captions (bottom). Text cap-
tions are provided for clarity; only speech and images
are used by the models.

2017a; Bhati et al., 2018). However, learning natu-
ral language starts with grounded, contextualized
speech. While infants as young as 8-months-old
can segment word-like units without non-linguistic
information (Jusczyk and Aslin, 1995) and adults
can learn to segment words in artificial languages
(Saffran et al., 1996), a learner must ultimately
ground their representations of linguistic sequences
(Harnad, 1990) to effectively use them to refer to
objects, events and more. Furthermore, learning
from rich perceptual data and interactions can be
more efficient as it provides additional cues to the
identities of words and their meaning in context.

We address the problem of relating images to
audio captions that describe them (Figure 1), build-
ing on previous research into learning from vi-
sually grounded, untranscribed speech (Harwath
and Glass, 2015; Sun et al., 2016; Harwath et al.,
2016; Chrupała et al., 2017; Kamper et al., 2017b;
Chrupała, 2019; Harwath and Glass, 2019). Such
problem settings provide opportunities both to im-
prove our theoretical understanding of language



56

as well as to realize gains on practical problems—
including voice interaction with virtual assistants,
image retrieval based on speech, and generally bet-
ter supporting people with visual impairments.

Our contribution is to improve performance on
bidirectional speech/image retrieval through better
data and better models for learning fixed dimen-
sional latent representations of both modalities. We
construct a synthetic speech caption dataset for pre-
training by applying text-to-speech (TTS) on Con-
ceptual Captions (Sharma et al., 2018), a dataset
with 3.3 million diverse image-caption pairs. Un-
like Chrupała et al. (2017), who similarly applied
TTS to MS-COCO (Chen et al., 2015), we inject di-
versity by varying the voice, speech rate, pitch and
volume gain on every synthetically produced audio
caption. We refer to the resulting dataset as Concep-
tual Spoken Captions (CSC). CSC’s scale allows
us to train deeper models than previous work. We
use Inception-ResNet-v2 (Szegedy et al., 2017) to
encode both the audio and visual modalities in a
dual encoder model, pretraining on CSC and then
fine-tuning and evaluating on human speech in the
smaller Flickr Audio Caption Corpus (FACC) (Har-
wath and Glass, 2015). Using an adapted batch
loss function rather than the triplet loss used in
previous work, we substantially improve on the
previous state-of-the-art for the standard FACC re-
trieval tasks.

Image captioning datasets contain positively
paired items—but that does not imply that a ran-
dom image and caption cannot also be a valid
match. For instance, in FACC there are many spo-
ken captions about beaches and sunsets and plenty
of images that match these captions; two differ-
ent images with descriptions “A surfer is riding a
wave.” and “A man surfs the wave” are likely com-
patible. It is of course not feasible to exhaustively
annotate all pairwise associations, so we have hu-
man raters judge the top five retrieved results for
two models to assess the impact of this aspect of
the data on automatic retrieval metrics used thus far.
Unsurprisingly, models retrieve many compatible
results that are unpaired in FACC: with the human
evaluations, we find consistent increases in recall.

2 Data

Larger training datasets support better performance
and generalization (Banko and Brill, 2001; Halevy
et al., 2009; Sun et al., 2017), especially for deep
models. Collecting labels from people has become

easier via crowd computing (Buhrmester et al.,
2011), but is still expensive and remains a bottle-
neck for creating broad and representative datasets.
This motivates the case for exploiting incidental
annotation (Roth, 2017) and automating some as-
pects of dataset creation. The current trend of using
machine translation systems to produce augmented
datasets for machine translation itself (Sennrich
et al., 2016) and for monolingual tasks like classifi-
cation (Yu et al., 2018) and paraphrasing (Wieting
and Gimpel, 2018) is a good example of this.

For speech image captioning, Chrupała et al.
(2017) used a Text-to-Speech (TTS) system to cre-
ate audio from the textual captions given in the
MS-COCO dataset, resulting in 300k unique im-
ages with 5 spoken captions each. We scale this
idea to the larger and more diverse textual Concep-
tual Captions dataset with 3.3 million unique image
and captions, additionally modifying the produced
speech by using multiple voices and random per-
turbations to the rate, pitch and audio. Our goal is
to make the resulting data more effective for pre-
training models so they can learn more efficiently
on smaller amounts of human speech.

2.1 Conceptual Captions

Image captioning datasets have ignited a great deal
of research at the intersection of the computer vi-
sion and natural language processing communities
(Lin et al., 2014; Vinyals et al., 2015; Bernardi
et al., 2016; Anderson et al., 2018). Getting anno-
tators to provide captions works well with crowd
computing, but Sharma et al. (2018) exploit inci-
dental supervision for this task to obtain greater
scale with their Conceptual Captions dataset. It
contains 3.3 million pairs of image and textual cap-
tions, where pairs are extracted from HTML web
pages using the alt-text field of images as a starting
point for their descriptions.

The textual captions are processed in a hyper-
nymization stage. Named entities and syntactic
dependency annotations are obtained using Google
Cloud Natural Language APIs, which are matched
to hypernym terms using the Google Knowledge
Graph Search API. Proper nouns, numbers, units,
dates, durations and locations are removed; iden-
tified named-entities are substituted with their hy-
pernym, merging together analogous terms when
possible. For example, the original alt-text (1) is
converted to the conceptual caption (2).

(1) alt-text: Musician Justin Timberlake per-



57

forms at the 2017 Pilgrimage Music & Cul-
tural Festival on September 23, 2017 in
Franklin, Tennessee.

(2) conceptual caption: pop artist performs at
the festival in a city.

There are many sequential filtering steps for im-
proving the quality of the captions—see Sharma
et al. (2018) for a thorough description. As quality
control, a random sample of 4K conceptual cap-
tions were rated by human annotators, and 90.3%
were judged “good” by at least 2 out of 3 raters.

2.2 Conceptual Spoken Captions
We use TTS to generate a high-fidelity spoken sen-
tence for each of the 3.3 million textual captions
in the Conceptual Captions dataset.1 We use the
Google Cloud Speech API2 for TTS. Internally,
the service uses a WaveNet model (Van Den Oord
et al., 2016) to generate audio. For diversity, the
speech is synthesized using parameter variations,
as follows:

• Voice, which is sampled uniformly from a
set of 6 different voices generated using a
WaveNet model for American English.

• Speaking rate controls the speed of the synthe-
sized audio. A speaking rate of 1.0 means the
normal speed of a given voice, while a speak-
ing rate of 2.0 means twice as fast. When
synthesizing the data, we draw this parameter
from a Gaussian distribution ∼ N (1.0, 0.12).

• Pitch controls how high/deep the voice is. For
example, if set to 1, this means the voice will
be synthesized 1 semitones above the origi-
nal pitch. This parameter is drawn from a
Gaussian distribution ∼ N (0.0, 1.02).

• Volume gain controls a gain in dB with respect
to the normal native signal amplitude. If set to
0, the voice is synthesized without alterations
in volume. This parameter is drawn from a
Gaussian distribution ∼ N (0.0, 2.02).

To avoid degenerate cases, we clip the values
sampled from the Gaussian distributions described
above such that they are never more than 2 times
the standard deviation from the mean. All spoken
captions are generated in 16000 Hz.

1The alt-text does not come with the dataset and cannot be
redistributed, so we focus on the conceptual captions for ease
of experimentation and reproducibility.

2https://cloud.google.com/text-to-speech/

Figure 2: Dual-encoder model architecture.

2.3 Flickr Audio Caption Corpus
The Flickr Audio Caption Corpus (FACC) (Har-
wath and Glass, 2015) consists of 40,000 pairs of
images and spoken captions, with 8000 unique im-
ages, of which 1000 are held for validation and
1000 for testing. The spoken captions are generated
from humans reading the textual captions from the
Flickr8k dataset (Hodosh et al., 2013), originally
crowd-sourced and based on images from Flickr.

We use FACC for evaluation, both when pretrain-
ing on Conceptual Spoken Captions and when train-
ing on FACC from scratch. Like previous work, the
core evaluation considered is retrieval of the known
paired image given an audio caption within some
top-k set of retrieved items (e.g. R@1 for whether
the first item retrieved is the paired one and R@10
for whether it is in the top ten results). We also
conduct human evaluations on retrieval outputs to
detect the presence of unpaired but matching image-
caption pairs identified by the models and thereby
better assess their impact on performance.

3 Model

Dual encoders are used in a wide range of ap-
plications, including signature verification (Brom-
ley et al., 1994), object tracking (Bertinetto et al.,
2016), sentence similarity (Mueller and Thyagara-
jan, 2016), improving neural machine translation
(Yang et al., 2019) and many others. The core
of this set of architectures is a simple two-tower
model illustrated in Figure 2, where inputs x ∈ X
are processed by an encoder gx and inputs y ∈ Y
by a second encoder gy. The inputs may come

https://cloud.google.com/text-to-speech/


58

from the same distribution—or they may be from
entirely different sources or modalities. The towers
may share the same architecture and weights—or
they can be completely unlike and disconnected.

These models are standard in audiovisual image
captioning (Harwath and Glass, 2015; Chrupała,
2019; Harwath et al., 2018). In this setting, the
dual encoder model, is composed by a visual tower,
gvis, processing the images, and an audio tower,
gaud, processing the spoken captions. The model
is trained to map both modalities into a joint latent
space. Here, we extend previous work to consider a
batched margin loss, which we show to be superior
for learning dense representations for retrieval.

Notation. The inputs are processed in batches
of size B. For each input xk and yk in the batch,
1 ≤ k ≤ B , let gx(xk) and gy(yk) be their la-
tent representations extracted by the corresponding
tower. We define the B × B matrix Z as the sim-
ilarity between the latent representations for each
pair of elements in the batch. A natural choice for
that similarity is the dot product between the latent
representations:

Zij = gx(xi) · gy(yj) (1)

As shown in Figure 2, Z encodes all pairwise as-
sociations in the batch. However, an additional
aspect of some datasets must be taken into account:
often times the same input x can match multiple
inputs y or vice-versa—for instance, both Flickr8k
and MS-COCO have multiple captions for the each
image. To respect these pairs when they land in
the same batch—and thus not penalize models for
(correctly) associating them—we define a B ×B
masking matrix M:

Mij =

{
0, if xi matches yj
1, otherwise

(2)

All pairs (xk, yk) match and this equivalence is
transitive, so M is symmetric and all diagonal ele-
ments Mkk, 1 ≤ k ≤ B are zero.

Triplet Loss. Both Chrupała (2019) and Harwath
et al. (2018) (and their previous work) employ the
triplet loss function given in Equation 3.

LT =
B∑
k=1

(
max(0,Zkm − Zkk + δ)+

max(0,Znk − Zkk + δ)
) (3)

For each value k, m is randomly drawn from a uni-
form distribution over indices j such that Mkj = 1,
and n over indices i such that Mik = 1.

Masked Margin Softmax Loss. The triplet loss
(3) used previously misses opportunities to learn
against a wider set of negative examples, namely
all those in the batch that are not known to be posi-
tively associated (i.e., Mij = 1). To exploit these
additional negatives, we minimize the Masked Mar-
gin Softmax (MMS) loss function, inspired by Hen-
derson et al. (2017) and Yang et al. (2019). MMS
simulates x-to-y and y-to-x retrievals inside the
batch. It is defined at a high level as:

LMMS = Lxy + Lyx (4)

LMMS is the sum of losses defined over x-to-y (Eq.
5) and y-to-x (Eq. 6) in-batch retrievals.

Lxy = −
1

B

B∑
i=1

log
eZii−δ

eZii−δ +
∑B

j=1Mije
Zij

(5)

Lyx = −
1

B

B∑
j=1

log
eZjj−δ

eZjj−δ +
∑B

i=1Mije
Zij

(6)
These are equivalent to a cross-entropy loss after a
column-wise or row-wise softmax on the matrix Z,
subject to the masking constraints in M and margin
δ.

The margin hyperparameter δ is gradually in-
creased as training progresses. Empirically, we
found that, with a fixed δ, large values lead to unsta-
ble performance in early training, while small val-
ues lead to negligible results in final performance.
Starting with a small δ and increasing it does not
hurt early training and forces the model to learn
from a harder task later on. There many ways to
increase δ along training—e.g. linearly, quadrati-
cally, and exponentially. The latter is used in this
work.

Contrasting Equations 3 and 4, the former
chooses a negative sample randomly, while the lat-
ter takes advantage of all negative pairs in the batch
and thus improves sample efficiency. LMMS has
three main differences with Yang et al. (2019): (1)
a masking term that accounts for the fact that there
might be multiple positive choices in the batch for
a given input; (2) a varying margin term δ, which is
increased during training; (3) a log term that makes
MMS more closely resemble a cross-entropy loss.



59

Speech to Image Image to Speech

Loss Batch Size R@1 R@5 R@10 R@50 R@100 R@1 R@5 R@10 R@50 R@100
LT 48 .037 .109 .165 .367 .474 .031 .101 .155 .346 .455

LMMS
12 .025 .083 .129 .311 .432 .024 .083 .132 .315 .433
24 .054 .143 .206 .418 .533 .046 .137 .197 .411 .520
48 .078 .204 .282 .499 .604 .074 .194 .269 .485 .587

Table 1: Performance on the validation set of Conceptual Spoken Captions, comparing different loss functions and
batch sizes.

4 Experiments

4.1 Experimental settings

Image preprocessing. During training, data aug-
mentation is performed by randomly distorting the
brightness and saturation of images. Each image is
also randomly cropped or padded such that at least
67% of the area of the original image is covered,
and re-scaled if necessary to 299×299. During
evaluation, we do not perform color distortions,
and we crop/pad the central portion of the images.

Audio preprocessing. We extract 128 Mel-
Frequency Cepstral Coefficients (MFCCs) from
the raw audio signals using a window size of 20ms.
The audio signals have a sampling rate of 16000Hz.
We compute features every 10ms, such that each
window has a 50% overlap with its neighbors. Dur-
ing training, we randomly crop/pad the MFCCs in
the temporal dimension, and perform data augmen-
tation as in Park et al. (2019), using one mask with
a frequency mask parameter of 20 and a time mask
parameter of 40. We do not perform time warping.

Encoders. Both audio and image encoders are
Inception-ResNet-v2 networks (Szegedy et al.,
2017), allowing the model to reap the benefits
of relatively low computational cost, fast train-
ing and and strong performance when combining
the Inception architecture with residual connec-
tions.3 Related to our setting for audio processing,
Li et al. (2019) also uses residual convolutional
neural networks for state of the art results on Lib-
riSpeech dataset (Panayotov et al., 2015). For the
audio tower, we stack 3 replicas of the MFCCs
and treat them as images. For each modality, a
1536-dimensional latent space representation is ex-
tracted. Despite using the same architecture for
both encoders, their weights are not shared. Unless
specified otherwise, the models are not pretrained.

3See Bianco et al. (2018) for an extensive benchmark anal-
ysis of popular convolutional neural network architectures.

Optimization. Models are trained using Adam
(Kingma and Ba, 2014), with an initial learning
rate of 0.001 and an exponential decay of 0.999
every 1000 training steps, β1 = 0.9, β2 = 0.999
and � = 1e−8. We use a weight decay of 4e−5,
and train on 32 GPUs until convergence. Unless
specified otherwise, the optimization objective is
minimizing the loss LMMS (Eq. 4) with a margin
term initially set to δ = 0.001 exponentially and
increased by a factor of 1.002 every 1000 steps.

4.2 Retrieval: Conceptual Spoken Captions

Our primary aim with CSC is to use it for pretrain-
ing for later fine-tuning and evaluation on datasets
with human speech instead of TTS. Nevertheless,
we can compare different loss functions and differ-
ent batch sizes on the CSC validation set to better
understand the impact of these parameters.

We train models on CSC for 3 million steps,
cropping/padding spoken captions to a duration of
3.5 seconds and using the loss functions LT (Eq.
3) and LMMS (Eq. 4). We find continuing im-
provements as batch size increases from 12 to 24
to 48. Furthermore, with the same batch size of
48, models optimized for minimizing LMMS per-
form substantially better than those using LT, as
summarized in Table 1. Of particular note is that
R@1 scores for LMMS (batch size 48) are more
than double those of LT in both directions.

4.3 Retrieval: Flickr Audio Caption Corpus

Table 2 compares previous results on the FACC
dataset with those obtained by variations of our
model. As a pre-processing step, spoken captions
are cropped/padded to a duration of 8 seconds. Af-
ter pretraining the model in CSC, we explore all
possible combinations of using or not the pretrained
weights for each of the branches gaud and gvis as
a warm-starting point, training until convergence
on FACC. Warm-starting each of the branches in
the dual-encoder leads to substantial improvements



60

Caption to Image Image to Caption

Model R@1 R@5 R@10 R@50 R@100 R@1 R@5 R@10 R@50 R@100

Text

Socher et al. 2014 - - .286 - - - - .2r90 - -
Karpathy et al. 2014 - - .425 - - - - .440 - -
Harwath and Glass 2015 - - .490 - - - - .567 - -
Chrupała et al. 2017 .127 .364 .494 - - - - - - -

Speech

Harwath and Glass 2015 - - .179 - - - - .243 - -
Chrupała et al. 2017 .055 0.163 .253 - - - - - - -
Chrupała 2019 - - .296 - - - - - - -

Ours (from scratch) .018 .063 .101 .288 .428 .024 .072 .124 .332 .458
Ours (warm-starting gaud) .041 .138 .211 .467 .613 .550 .166 .241 .522 .654
Ours (warm-starting gvis) .062 .190 .279 .560 .703 .081 .242 .352 .664 .782
Ours (warm-starting all) .139 .368 .495 .781 .875 .182 .435 .558 .842 .910

Table 2: Retrieval scores on the test set of FACC.

over the baseline, and combining both branches
leads to the best overall performance.

In particular, we improve R@10 for caption-to-
image from the .296 obtained by Chrupała (2019)
by 20% absolute to .495, without using multitask
training or pretraining gvis on ImageNet (Deng
et al., 2009). The multitask training approach of
Chrupała (2019) is complementary to our improve-
ments, so further gains might be obtained by com-
bining these strategies. Furthermore, very deep,
residual convolutional neural networks over charac-
ters have been shown to perform well for text-based
tasks (Conneau et al., 2017). We expect that our
strategy of using the same basic architecture across
different input types (speech, text and image) can
be fruitfully extended to that setting. A related ob-
servation: while our results exceed previous results
reported on text/image retrieval settings for FACC,
we expect that recent advances in text encoding
could easily beat those reported numbers.

We also explore very low-data regimes using our
pretrained model (see Fig. 3). Using small training
subsets randomly drawn from FACC, we report per-
formance as a function of how much data the model
sees. With as little as 10% of the original training
data (3000 image/spoken caption pairs), the warm-
started model performs competitively with a model
trained on all training data.

Qualitative evaluation. Once a model is trained,
any input (image or spoken caption) can be be used
to query the corpus of images and spoken captions
for nearest neighbors in the latent space. Figure 4
shows some examples of retrieved nearest neigh-
bors in FACC’s test set. Given a spoken caption or

0.3 0.9 3.0 9.0 30.0

Dataset size (thousands of samples)

0.0

0.2

0.4

0.6

0.8

1.0

R
e
ca

ll

I2S R@100

S2I R@100

I2S R@50

S2I R@50

I2S R@10

S2I R@10

I2S R@5

S2I R@5

I2S R@1

S2I R@1

Figure 3: Ablations on low-data regime on FACC:
chart shows recall scores for image-to-speech (I2S) and
speech-to-image (S2I) retrieval, as a function of the
amount of training data used for fine-tuning.

an image we show the five nearest image neighbors
and five nearest caption neighbors. From these, it is
clear that the representations capture many seman-
tically salient attributes of the inputs. The retrieved
items correctly share many thematic elements and
many are clearly good matches even though the
particular image-caption pairs are not associated in
the data. This serves to reinforce our observation
that R@k evaluations using only the known paired
items is likely to underestimate the actual perfor-
mance of the models—which we show to be the
case with human evaluations in Section 4.4.

Only some items are substantially incompatible:
e.g. an image of a car for a caption about a woman
in a river (they share water spraying), a picture of
three adults for a caption about children raising
their hands, and a caption about a boy climbing
a wall for an image of children playing leapfrog).
That said, many details are poor matches, such as
the count of objects (one ball versus many), colors



61

Figure 4: Nearest neighbors in the joint visual and acoustic latent space, best viewed with zoom: using 4 spoken
captions and 4 images as queries, we extract from FACC’s test set the closest 5 images and 5 spoken captions in
the latent space for each of them. For simplicity, we show the text associated with each spoken caption.

(brown dogs versus multicolored ones), people de-
scriptions (elderly woman versus male dirt biker),
object identification (e.g. a yellow pool noodle
viewed as similar to slides), processes (jumping ver-
sus sliding) and perspective (man looking up versus
viewed from behind and climbing). As such, there
is clearly significant headroom for better, more fine-
grained modeling of both captions and images. Ad-
ditionally, cross-modal attention mechanisms (Xu
et al., 2015) and other explainability techniques
(Ribeiro et al., 2016) could help better inspect and
understand a model’s predictions.

Furthermore, as noted by Chrupała et al. (2017),
text-based retrieval models often handle mis-
spellings poorly. In contrast, speech-based models
are unlikely to suffer from similar problems be-
cause they inherently must deal with variation in
the expression of words and utterances. For in-
stance, the caption “a dirt biker rides his moto-
cycle through the woods” (fourth row of Figure

4) is highly correlated with the correctly spelled
sentences.

4.4 Human evaluation

We ran human evaluations to answer two questions:
(1) how much does cropping limit model perfor-
mance? and (2) how much do retrieval evaluations
based only on positive associations underestimate
model performance? Hints about both questions
can be seen in the qualitative evaluation (Fig. 4).

To answer the first question, Table 3 shows the
ratings for ground truth image/caption pairs in the
FACC test set. The uncropped row shows that over-
all the captions are high quality and do match the
full images. However, human ratings on images
cropped at the center (which is what is provided
to the models) show that there is considerable loss
from cropping—only 62.5% of cropped images are
rated as good matches by all five raters. Inspection
makes it clear why cropping hurts: for example an



62

“good” ratings (out of 5)
1+ 2+ 3+ 4+ 5

Cropped .949 .918 .874 .800 .625
Uncropped .995 .994 .989 .971 .891

Table 3: Human evaluation results on ground truth pairs
on the test set of FACC, using either center cropped
(which the models receive) or uncropped versions of
the images.

image of a snowboarder in the air next to another
on a ski lift is cropped such that the snowboarder
is missing, and thus a poor match to captions men-
tioning the snowboarder. This clearly indicates that
standard cropping (which we follow) inherently
limits model performance and that strategies that
use the full image should be explored.

Standard retrieval evaluations are blind to pairs
that match but are not associated in the data. To
address this and answer the second question posed
above, we present the top-5 retrieved captions for
each image and the top-5 retrieved images for each
caption in FACC’s test set to human raters. To in-
crease speed and decrease costs, we show raters
the original Flickr8k textual captions instead of the
spoken ones. Each pair is judged by five raters
as “good” or not. This gives a soft measure of the
compatibility of each pair based on fast binary judg-
ments from each rater. For retrieval evaluations of
a model, we compute recall based on the majority
of human raters approving each image-caption pair:
R@1 is the percentage of top-1 results and R@5
the percentage of top-5 results that are evaluated as
a match by at least 3 of the 5 raters.

Table 4 shows these metrics computed on re-
trieval outputs from two settings: FACC training
from scratch and FACC fine-tuning after CSC pre-
training. It also shows the corresponding auto-
matic evaluations from Table 2 for easy comparison.
These results make it clear that evaluation based
only on positive associations is too rigid: speech-to-
image retrieval based on human evaluations shows
that a good matching item is returned in 52.2% of
cases rather than just the 36.8% indicated by strict
corpus matches. For image-to-speech retrieval the
55.8% strict measure goes up to 63.8%. That said,
the results also show that the strict measure is nev-
ertheless a useful indicator for comparing relative
model performance: the model pretrained on CSC
beats the corresponding one trained on FACC from
scratch, on both human and automatic evaluations.

S2I I2S

Eval Pretrain R@1 R@5 R@1 R@5
Auto .018 .063 .024 .072
Auto 3 .139 .368 .182 .558
Humans .056 .154 .070 .196
Humans 3 .229 .522 .306 .638

Table 4: Comparison of human rater scores (major-
ity agreement) versus using only corpus-known pairs
on all metrics for speech-to-image (S2I) and image-
to-speech (I2S) retrieval. Rows with Auto evaluation
correspond to Ours (from scratch) and Ours (warm-
starting all) scores in Table 2.

5 Conclusion

Large-scale datasets are essential for training deep
networks from scratch. In this paper, we present
a scalable method for generating an audio caption
dataset taking advantage of TTS systems to create
millions of data pairs. Using the MMS loss, we
demonstrate that pretraining on this dataset greatly
improves performance on a human-generated au-
dio caption dataset. As TTS models continue to
improve and be developed for more languages, this
data augmentation strategy will only become more
robust and helpful over time. Finally, using human
evaluations, we show evidence that corpus-based
retrieval scores underestimate actual performance.

This present work is focused on the here and now
since captions describe a snapshot in time and focus
on the visual entities and events involved in them.
We thus have little hope to learn representations
for words like visit, career and justice, for example.
Videos can help with process oriented words like
visit and could get significant components of words
like career (such as the visual contexts, but not
the overall path with intermediate goals involved
in careers). They are likely to be hopeless for ab-
stract words like justice. To address problems of
this sort, there are likely many opportunities to
combine ideas from unsupervised term discovery
(Kamper et al., 2016; Bansal et al., 2017) with au-
diovisual word learning (Harwath et al., 2018) and
models of visual grounding that have been applied
to text (Kiros et al., 2018). Being able to learn
effective representations from raw audio associated
with images could provide new possibilities for
work that learns from videos and text (transcribed
speech) (Chen et al., 2018), and in particular open
up such techniques to new languages and domains.



63

Acknowledgements

The authors would like to thank Radu Soricut,
Austin Waters, Alex Ku and Jeffrey Ling for the
helpful comments that assisted the development of
this work.

References

Peter Anderson, Xiaodong He, Chris Buehler, Damien
Teney, Mark Johnson, Stephen Gould, and Lei
Zhang. 2018. Bottom-up and top-down attention for
image captioning and visual question answering. In
Proceedings of the IEEE Conference on Computer
Vision and Pattern Recognition, pages 6077–6086.

Michele Banko and Eric Brill. 2001. Scaling to very
very large corpora for natural language disambigua-
tion. In Proceedings of the 39th annual meeting
of the Association for Computational Linguistics,
pages 26–33. Association for Computational Lin-
guistics.

Sameer Bansal, Herman Kamper, Sharon Goldwater,
and Adam Lopez. 2017. Weakly supervised spoken
term discovery using cross-lingual side information.
In Proceedings of the 42nd IEEE International Con-
ference on Acoustics, Speech and Signal Processing
(ICASSP-2017).

Raffaella Bernardi, Ruket Cakici, Desmond Elliott,
Aykut Erdem, Erkut Erdem, Nazli Ikizler-Cinbis,
Frank Keller, Adrian Muscat, and Barbara Plank.
2016. Automatic description generation from im-
ages: A survey of models, datasets, and evalua-
tion measures. Journal of Artificial Intelligence Re-
search, 55:409–442.

Luca Bertinetto, Jack Valmadre, Joao F Henriques, An-
drea Vedaldi, and Philip HS Torr. 2016. Fully-
convolutional siamese networks for object tracking.
In European Conference on Computer Vision, pages
850–865. Springer.

Saurabhch Bhati, Herman Kamper, and K Sri Rama
Murty. 2018. Phoneme based embedded segmen-
tal k-means for unsupervised term discovery. In
2018 IEEE International Conference on Acoustics,
Speech and Signal Processing (ICASSP), pages
5169–5173. IEEE.

Simone Bianco, Remi Cadene, Luigi Celona, and Paolo
Napoletano. 2018. Benchmark analysis of represen-
tative deep neural network architectures. IEEE Ac-
cess, 6:64270–64277.

Jane Bromley, Isabelle Guyon, Yann LeCun, Eduard
Säckinger, and Roopak Shah. 1994. Signature veri-
fication using a ”siamese” time delay neural network.
In Advances in Neural Information Processing Sys-
tems, pages 737–744.

Michael Buhrmester, Tracy Kwang, and Samuel D
Gosling. 2011. Amazon’s mechanical turk: A new
source of inexpensive, yet high-quality, data? Per-
spectives on Psychological Science, 6(1):3–5.

Jingyuan Chen, Xinpeng Chen, Lin Ma, Zequn Jie, and
Tat-Seng Chua. 2018. Temporally grounding natural
sentence in video. In Proceedings of the 2018 Con-
ference on Empirical Methods in Natural Language
Processing, pages 162–171, Brussels, Belgium. As-
sociation for Computational Linguistics.

Xinlei Chen, Hao Fang, Tsung-Yi Lin, Ramakr-
ishna Vedantam, Saurabh Gupta, Piotr Dollár, and
C Lawrence Zitnick. 2015. Microsoft coco captions:
Data collection and evaluation server. arXiv preprint
arXiv:1504.00325.

Grzegorz Chrupała. 2019. Symbolic inductive bias for
visually grounded learning of spoken language. In
To appear in Proceedings of the 57th Annual Meet-
ing of the Association for Computational Linguis-
tics.

Grzegorz Chrupała, Lieke Gelderloos, and Afra Al-
ishahi. 2017. Representations of language in a
model of visually grounded speech signal. arXiv
preprint arXiv:1702.01991.

Alexis Conneau, Holger Schwenk, Loı̈c Barrault, and
Yann Lecun. 2017. Very deep convolutional net-
works for text classification. In Proceedings of the
15th Conference of the European Chapter of the As-
sociation for Computational Linguistics: Volume 1,
Long Papers, pages 1107–1116, Valencia, Spain. As-
sociation for Computational Linguistics.

Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li,
and Li Fei-Fei. 2009. Imagenet: A large-scale hier-
archical image database. In 2009 IEEE Conference
on Computer Vision and Pattern Recognition, pages
248–255. Ieee.

Alon Halevy, Peter Norvig, and Fernando Pereira.
2009. The unreasonable effectiveness of data.

Stevan Harnad. 1990. The symbol grounding prob-
lem. Physica D: Nonlinear Phenomena, 42(1-
3):335–346.

David Harwath and James Glass. 2015. Deep mul-
timodal semantic embeddings for speech and im-
ages. In 2015 IEEE Workshop on Automatic Speech
Recognition and Understanding (ASRU), pages 237–
244. IEEE.

David Harwath and James Glass. 2019. Towards vi-
sually grounded sub-word speech unit discovery.
arXiv preprint arXiv:1902.08213.

David Harwath, Adria Recasens, Dı́dac Surı́s, Galen
Chuang, Antonio Torralba, and James Glass. 2018.
Jointly discovering visual objects and spoken words
from raw sensory input. In Proceedings of the
European Conference on Computer Vision (ECCV),
pages 649–665.



64

David Harwath, Antonio Torralba, and James Glass.
2016. Unsupervised learning of spoken language
with visual context. In Advances in Neural Infor-
mation Processing Systems, pages 1858–1866.

Matthew Henderson, Rami Al-Rfou, Brian Strope, Yun-
hsuan Sung, Laszlo Lukacs, Ruiqi Guo, Sanjiv Ku-
mar, Balint Miklos, and Ray Kurzweil. 2017. Effi-
cient natural language response suggestion for smart
reply. arXiv preprint arXiv:1705.00652.

Micah Hodosh, Peter Young, and Julia Hockenmaier.
2013. Framing image description as a ranking task:
Data, models and evaluation metrics. Journal of Ar-
tificial Intelligence Research, 47:853–899.

PW Jusczyk and RN Aslin. 1995. Infants detection of
the sound patterns of words in fluent speech. Cogni-
tive psychology, 29:1–23.

Herman Kamper, Aren Jansen, and Sharon Goldwater.
2016. Unsupervised word segmentation and lexicon
discovery using acoustic word embeddings. IEEE
Transactions on Audio, Speech and Language Pro-
cessing, 24(4):669679.

Herman Kamper, Aren Jansen, and Sharon Goldwa-
ter. 2017a. A segmental framework for fully-
unsupervised large-vocabulary speech recognition.
Computer Speech & Language, 46:154–174.

Herman Kamper, Shane Settle, Gregory
Shakhnarovich, and Karen Livescu. 2017b. Vi-
sually grounded learning of keyword prediction
from untranscribed speech. arXiv preprint
arXiv:1703.08136.

Andrej Karpathy, Armand Joulin, and Li F Fei-Fei.
2014. Deep fragment embeddings for bidirectional
image sentence mapping. In Advances in neural in-
formation processing systems, pages 1889–1897.

Diederik P Kingma and Jimmy Ba. 2014. Adam: A
method for stochastic optimization. arXiv preprint
arXiv:1412.6980.

Jamie Kiros, William Chan, and Geoffrey Hinton. 2018.
Illustrative language understanding: Large-scale vi-
sual grounding with image search. In Proceedings
of the 56th Annual Meeting of the Association for
Computational Linguistics (Volume 1: Long Papers),
pages 922–933, Melbourne, Australia. Association
for Computational Linguistics.

Jason Li, Vitaly Lavrukhin, Boris Ginsburg, Ryan
Leary, Oleksii Kuchaiev, Jonathan M Cohen, Huyen
Nguyen, and Ravi Teja Gadde. 2019. Jasper:
An end-to-end convolutional neural acoustic model.
arXiv preprint arXiv:1904.03288.

Tsung-Yi Lin, Michael Maire, Serge Belongie, James
Hays, Pietro Perona, Deva Ramanan, Piotr Dollár,
and C Lawrence Zitnick. 2014. Microsoft coco:
Common objects in context. In European Confer-
ence on Computer Vision, pages 740–755. Springer.

Jonas Mueller and Aditya Thyagarajan. 2016. Siamese
recurrent architectures for learning sentence similar-
ity. In Thirtieth AAAI Conference on Artificial Intel-
ligence.

Lucas Ondel, Lukáš Burget, and Jan Černockỳ. 2016.
Variational inference for acoustic unit discovery.
Procedia Computer Science, 81:80–86.

Vassil Panayotov, Guoguo Chen, Daniel Povey, and
Sanjeev Khudanpur. 2015. Librispeech: an asr
corpus based on public domain audio books. In
2015 IEEE International Conference on Acoustics,
Speech and Signal Processing (ICASSP), pages
5206–5210. IEEE.

Alex S Park and James R Glass. 2007. Unsuper-
vised pattern discovery in speech. IEEE Transac-
tions on Audio, Speech, and Language Processing,
16(1):186–197.

Daniel S Park, William Chan, Yu Zhang, Chung-Cheng
Chiu, Barret Zoph, Ekin D Cubuk, and Quoc V Le.
2019. Specaugment: A simple data augmentation
method for automatic speech recognition. arXiv
preprint arXiv:1904.08779.

Marco Tulio Ribeiro, Sameer Singh, and Carlos
Guestrin. 2016. Why should i trust you?: Explain-
ing the predictions of any classifier. In Proceed-
ings of the 22nd ACM SIGKDD international con-
ference on knowledge discovery and data mining,
pages 1135–1144. ACM.

Dan Roth. 2017. Incidental supervision: Moving be-
yond supervised learning. In Thirty-First AAAI Con-
ference on Artificial Intelligence.

Jenny R. Saffran, Elissa L. Newport, and Richard N.
Aslin. 1996. Word segmentation: The role of dis-
tributional cues. Journal of Memory and Language,
35:4:606–621.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Improving neural machine translation mod-
els with monolingual data. In Proceedings of the
54th Annual Meeting of the Association for Compu-
tational Linguistics (Volume 1: Long Papers), pages
86–96, Berlin, Germany. Association for Computa-
tional Linguistics.

Piyush Sharma, Nan Ding, Sebastian Goodman, and
Radu Soricut. 2018. Conceptual captions: A
cleaned, hypernymed, image alt-text dataset for au-
tomatic image captioning. In Proceedings of the
56th Annual Meeting of the Association for Compu-
tational Linguistics (Volume 1: Long Papers), pages
2556–2565.

Richard Socher, Andrej Karpathy, Quoc V Le, Christo-
pher D Manning, and Andrew Y Ng. 2014.
Grounded compositional semantics for finding and
describing images with sentences. Transactions
of the Association for Computational Linguistics,
2:207–218.



65

Chen Sun, Abhinav Shrivastava, Saurabh Singh, and
Abhinav Gupta. 2017. Revisiting unreasonable ef-
fectiveness of data in deep learning era. In Proceed-
ings of the IEEE International Conference on Com-
puter Vision, pages 843–852.

Felix Sun, David Harwath, and James Glass. 2016.
Look, listen, and decode: Multimodal speech recog-
nition with images. In 2016 IEEE Spoken Language
Technology Workshop (SLT), pages 573–578. IEEE.

Christian Szegedy, Sergey Ioffe, Vincent Vanhoucke,
and Alexander A Alemi. 2017. Inception-v4,
inception-resnet and the impact of residual connec-
tions on learning. In Thirty-First AAAI Conference
on Artificial Intelligence.

Aäron Van Den Oord, Sander Dieleman, Heiga Zen,
Karen Simonyan, Oriol Vinyals, Alex Graves,
Nal Kalchbrenner, Andrew W Senior, and Koray
Kavukcuoglu. 2016. Wavenet: A generative model
for raw audio. SSW, 125.

Balakrishnan Varadarajan, Sanjeev Khudanpur, and
Emmanuel Dupoux. 2008. Unsupervised learning
of acoustic sub-word units. In Proceedings of the
46th Annual Meeting of the Association for Compu-
tational Linguistics on Human Language Technolo-
gies: Short Papers, pages 165–168. Association for
Computational Linguistics.

Oriol Vinyals, Alexander Toshev, Samy Bengio, and
Dumitru Erhan. 2015. Show and tell: A neural im-
age caption generator. In Proceedings of the IEEE
Conference on Computer Vision and Pattern Recog-
nition, pages 3156–3164.

John Wieting and Kevin Gimpel. 2018. ParaNMT-
50M: Pushing the limits of paraphrastic sentence em-
beddings with millions of machine translations. In
Proceedings of the 56th Annual Meeting of the As-
sociation for Computational Linguistics (Volume 1:
Long Papers), pages 451–462, Melbourne, Australia.
Association for Computational Linguistics.

Kelvin Xu, Jimmy Ba, Ryan Kiros, Kyunghyun Cho,
Aaron Courville, Ruslan Salakhutdinov, Richard
Zemel, and Yoshua Bengio. 2015. Show, attend and
tell: Neural image caption generation with visual at-
tention. arXiv preprint arXiv:1502.03044.

Yinfei Yang, Gustavo Hernandez Abrego, Steve Yuan,
Mandy Guo, Qinlan Shen, Daniel Cer, Yun-hsuan
Sung, Brian Strope, and Ray Kurzweil. 2019. Im-
proving multilingual sentence embedding using bi-
directional dual encoder with additive margin soft-
max. arXiv preprint arXiv:1902.08564.

Adams Wei Yu, David Dohan, Quoc Le, Thang Luong,
Rui Zhao, and Kai Chen. 2018. Fast and accurate
reading comprehension by combining self-attention
and convolution. In International Conference on
Learning Representations (ICLR).


