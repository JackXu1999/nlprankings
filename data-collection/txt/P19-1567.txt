



















































Improving Neural Conversational Models with Entropy-Based Data Filtering


Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics, pages 5650–5669
Florence, Italy, July 28 - August 2, 2019. c©2019 Association for Computational Linguistics

5650

Improving Neural Conversational Models
with Entropy-Based Data Filtering

Richard Csaky
Department of Automation and Applied Informatics
Budapest University of Technology and Economics

ricsinaruto@hotmail.com

Patrik Purgai
Department of Automation and Applied Informatics
Budapest University of Technology and Economics

purgai.patrik@gmail.com

Gabor Recski
Apollo.AI

gabor@apollo.ai

Abstract
Current neural network-based conversational
models lack diversity and generate boring re-
sponses to open-ended utterances. Priors such
as persona, emotion, or topic provide addi-
tional information to dialog models to aid re-
sponse generation, but annotating a dataset
with priors is expensive and such annotations
are rarely available. While previous methods
for improving the quality of open-domain re-
sponse generation focused on either the un-
derlying model or the training objective, we
present a method of filtering dialog datasets
by removing generic utterances from training
data using a simple entropy-based approach
that does not require human supervision. We
conduct extensive experiments with different
variations of our method, and compare dialog
models across 17 evaluation metrics to show
that training on datasets filtered this way re-
sults in better conversational quality as chat-
bots learn to output more diverse responses.

1 Introduction

Current open-domain neural conversational mod-
els (NCM) are trained on pairs of source and tar-
get utterances in an effort to maximize the likeli-
hood of each target given the source (Vinyals and
Le, 2015). However, real-world conversations are
much more complex, and a plethora of suitable tar-
gets (responses) can be adequate for a given in-
put. We propose a data filtering approach where
the “most open-ended” inputs - determined by cal-
culating the entropy of the distribution over tar-
get utterances - are excluded from the training set.
We show that dialog models can be improved us-
ing this simple unsupervised method which can

be applied to any conversational dataset. We con-
duct several experiments to uncover how some of
the current open-domain dialog evaluation meth-
ods behave with respect to overfitting and random
data. Our software for filtering dialog data and au-
tomatic evaluation using 17 metrics is released on
GitHub under an MIT license12.

2 Background

Most open-domain NCMs are based on neural net-
work architectures developed for machine trans-
lation (MT, Sutskever et al. (2014); Cho et al.
(2014); Vaswani et al. (2017)). Conversational
data differs from MT data in that targets to the
same source may vary not only grammatically but
also semantically (Wei et al., 2017; Tandon et al.,
2017): consider plausible replies to the question
What did you do today?. Dialog datasets also con-
tain generic responses, e.g. yes, no and i don’t
know, that appear in a large and diverse set of con-
texts (Mou et al., 2016; Wu et al., 2018). Follow-
ing the approach of modeling conversation as a se-
quence to sequence (seq2seq, Sutskever et al.
(2014)) transduction of single dialog turns, these
issues can be referred to as the one-to-many, and
many-to-one problem. seq2seq architectures
are not suited to deal with the ambiguous nature
of dialogs since they are inherently deterministic,
meaning that once trained they cannot output dif-
ferent sequences to the same input. Consequently
they tend to produce boring and generic responses

1https://github.com/ricsinaruto/
Seq2seqChatbots

2https://github.com/ricsinaruto/
dialog-eval

https://github.com/ricsinaruto/Seq2seqChatbots
https://github.com/ricsinaruto/Seq2seqChatbots
https://github.com/ricsinaruto/dialog-eval
https://github.com/ricsinaruto/dialog-eval


5651

(Li et al., 2016a; Wei et al., 2017; Shao et al., 2017;
Zhang et al., 2018a; Wu et al., 2018).

Previous approaches to the one-to-many, many-
to-one problem can be grouped into three cat-
egories. One approach involves feeding extra
information to the dialog model such as dialog
history (Serban et al., 2016; Xing et al., 2018),
categorical information like persona (Li et al.,
2016b; Joshi et al., 2017; Zhang et al., 2018b),
mood/emotion (Zhou et al., 2018; Li et al., 2017c),
and topic (Xing et al., 2017; Liu et al., 2017; Ba-
heti et al., 2018), or through knowledge-bases (Di-
nan et al., 2019; Ghazvininejad et al., 2018; Zhu
et al., 2017; Moghe et al., 2018). A downside
to these approaches is that they require annotated
datasets which are not always available, or might
be smaller in size. Augmenting the model itself,
with e.g. latent variable sampling (Serban et al.,
2017b; Zhao et al., 2017, 2018; Gu et al., 2019;
Park et al., 2018; Shen et al., 2018b; Gao et al.,
2019), or improving the decoding process (Shao
et al., 2017; Kulikov et al., 2018; Mo et al., 2017;
Wang et al., 2018) is also a popular approach.
Sampling provides a way to generate more diverse
responses, however such models are more likely
to output ungrammatical or irrelevant responses.
Finally, directly modifying the loss function (Li
et al., 2016a), or training by reinforcement (Li
et al., 2016d; Serban et al., 2017a; Li et al., 2016c;
Lipton et al., 2018; Lewis et al., 2017) or adver-
sarial learning (Li et al., 2017b; Ludwig, 2017;
Olabiyi et al., 2018; Zhang et al., 2018c) has also
been proposed, but this is still an open research
problem, as it is far from trivial to construct ob-
jective functions that capture conversational goals
better than cross-entropy loss.

Improving dataset quality through filtering is
frequently used in the machine learning literature
(Sedoc et al., 2018; Ghazvininejad et al., 2018;
Wojciechowski and Zakrzewicz, 2002) and data
distillation methods in general are used both in
machine translation and dialog systems (Axelrod
et al., 2011; Li et al., 2017a). Xu et al. (2018b)
introduced coherence for measuring the similar-
ity between contexts and responses, and then fil-
tered out pairs with low coherence. This improves
datasets from a different aspect and could be com-
bined with our present approach. However, natural
conversations allow many adequate responses that
are not similar to the context, thus it is not intu-
itively clear why filtering these should improve di-

alog models. Our experiments also further support
that cross-entropy is not an adequate loss function
(shown qualitatively by Csaky (2019) and Tandon
et al. (2017)), by showing that many automatic
metrics continue to improve after the validation
loss reaches its minimum and starts increasing.
However, we found that the metrics steadily im-
prove even after we can be certain that the model
overfitted (not just according to the loss function).
Further research is required, to determine whether
this indicates that overfitted model responses are
truly better or if it’s a shortcoming of the metrics
that they prefer such models.

Currently, there is no well-defined automatic
evaluation method (Liu et al., 2016), and while
some metrics that correlate more with human
judgment have been proposed recently (Li et al.,
2017b; Lowe et al., 2017; Tao et al., 2018),
they are harder to measure than simpler auto-
matic metrics like perplexity or BLEU (Papineni
et al., 2002). Furthermore, even human evalua-
tion has its downsides, like high variance, high
cost, and difficulty of replicating experimental
setups (Zhang et al., 2018b; Tao et al., 2018).
Some works resort to human evaluations (Krause
et al., 2017; Fang et al., 2018), others use auto-
matic metrics only (Olabiyi et al., 2018; Xing and
Fernández, 2018; Kandasamy et al., 2017; Sha-
lyminov et al., 2018; Xu et al., 2018b), and some
use both (Shen et al., 2018a; Xu et al., 2018a; Ba-
heti et al., 2018; Ram et al., 2018). While exten-
sive human evaluation of the methods presented
here is left for future work, we do conduct an es-
pecially thorough automatic evaluation both at the
validation loss minimum and of overfitted models.
We believe our experiments also shed light on the
limitations of frequently used automatic metrics.

3 Methods

3.1 Intuition

We approach the one-to-many, many-to-one prob-
lem from a relatively new perspective: instead of
adding more complexity to NCMs, we reduce the
complexity of the dataset by filtering out a fraction
of utterance pairs that we assume are primarily re-
sponsible for generic/uninteresting responses. Of
the 72 000 unique source utterances in the Dai-
lyDialog dataset (see Section 4.1 for details), 60
000 occur with a single target only. For these it
seems straightforward to maximize the conditional
probability P (T |S), S and T denoting a specific



5652

source and target utterance. However, in the case
of sources that appear with multiple targets (one-
to-many), models are forced to learn some “aver-
age” of observed responses (Wu et al., 2018).

The entropy of response distribution of an utter-
ance s is a natural measure of the amount of “con-
fusion” introduced by s. For example, the context
What did you do today? has high entropy, since it
is paired with many different responses in the data,
but What color is the sky? has low entropy since
it’s observed with few responses. The many-to-
one scenario can be similarly formulated, where a
diverse set of source utterances are observed with
the same target (e.g. I don’t know has high en-
tropy). While this may be a less prominent issue
in training NCMs, we shall still experiment with
excluding such generic targets, as dialog models
tend to generate them frequently (see Section 2).

3.2 Clustering Methods and Filtering

We refer with IDENTITY to the following entropy
computation method. For each source utterance s
in the dataset we calculate the entropy of the con-
ditional distribution T |S = s, i.e. given a dataset
D of source-target pairs, we define the target en-
tropy of s as

Htgt(s,D) = −
∑

(s,ti)∈D

p(ti|s) log2 p(ti|s) (1)

Similarly, source entropy of a target utterance is

Hsrc(t,D) = −
∑

(si,t)∈D

p(si|t) log2 p(si|t) (2)

The probabilities are based on the observed rela-
tive frequency of utterance pairs in the data.

For the purposes of this entropy-based filter-
ing, we considered the possibility of also includ-
ing some form of similarity measure between ut-
terances that would allow us to detect whether a
set of responses is truly diverse, as in the case of
a question like What did you do today?, or diverse
only on the surface, such as in the case of a ques-
tion like How old are you? (since answers to the
latter are semantically close). Measuring the en-
tropy of semantic clusters as opposed to individual
utterances may improve our method by reducing
data sparsity. For example How are you? can ap-
pear in many forms, like How are you <name>?
(see Section 4.2). While the individual forms have
low entropy (because they have low frequency),

we may decide to filter them all if together they
form a high-entropy cluster.

To this end we performed the filtering based not
only on the set of all utterances, as in the case
of IDENTITY, but also on clusters of utterances
established by clustering their vector representa-
tions using the Mean Shift algorithm (Fukunaga
and Hostetler, 1975). Source and target utterances
are clustered separately. In the AVG-EMBEDDING
setup the representation R(U) of utterance U is
computed by taking the average word embed-
ding weighted by the smooth inverse frequency
R(U) = 1|U |

∑
w∈U

E(w)·0.001
0.001+p(w) of words (Arora

et al., 2017), where E(w) and p(w) are the embed-
ding and the probability3 of word w respectively.
We also experiment with SENT2VEC4, a more so-
phisticated sentence embedding approach, which
can be thought of as an extension of word2vec to
sentences (Pagliardini et al., 2018).

The target entropy of a source cluster cs is

Htgt(cs, C) = −
∑
ci∈C

p(ci|cs) log2 p(ci|cs) (3)

where C is the set of all clusters and p(ci|cs) is
the conditional probability of observing an utter-
ance from cluster i after an utterance from cluster
s. In the context of these methods, the entropy
of an utterance will mean the entropy of its clus-
ter. Note that IDENTITY is a special case of this
cluster-based entropy computation method, since
in IDENTITY a “cluster” is comprised of multiple
examples of one unique utterance. Thus a target
cluster’s entropy is computed similarly to Equa-
tion 2, but using clusters as in Equation 3.

Entropy values obtained with each of these
methods were used to filter dialog data in three
ways. The SOURCE approach filters utterance
pairs in which the source utterance has high en-
tropy, TARGET filters those with a high entropy
target, and finally the BOTH strategy filters all ut-
terance pairs that are filtered by either SOURCE or
TARGET. Some additional techniques did not yield
meaningful improvement and were excluded from
further evaluation. Clustering based on the Jaccard
similarity of the bag of words of utterances only
added noise to IDENTITY and resulted in much
worse clusters than SENT2VEC. Clustering single
occurrences of each unique utterance (as opposed
to datasets with multiplicity) lead to less useful

3Based on the observed relative frequency in the data.
4https://github.com/epfml/sent2vec

https://github.com/epfml/sent2vec


5653

clusters than when clustering the whole dataset,
probably because it resulted in less weight being
given to the frequent utterances that we want to fil-
ter out. K-means proved inferior to the Mean Shift
algorithm, which is a density-based clustering al-
gorithm and seems to work better for clustering
vectors of sentences. Filtering stop words before
clustering did not improve the quality of clusters,
probably because many utterances that we want to
filter out contain a large number of stop words.

4 Data Analysis

4.1 Dataset

With 90 000 utterances in 13 000 dialogs, Dai-
lyDialog (Li et al., 2017c), our primary dataset,
is comparable in size with the Cornell Movie-
Dialogs Corpus (Danescu-Niculescu-Mizil and
Lee, 2011), but contains real-world conversations.
Using the IDENTITY approach, about 87% of ut-
terances have 0 entropy (i.e. they do not appear
with more than one target), 5% have an entropy of
1 (e.g. they appear twice, with different targets),
remaining values rise sharply to 7. This distribu-
tion is similar for source and target utterances.

Figure 1: Entropy of source utterances (computed with
IDENTITY) with respect to utterance frequency.

Entropy is clearly proportional to utterance fre-
quency (Figure 1), but has a wide range of values
among utterances of equal frequency. For exam-
ple, utterances with a frequency of 3 can have en-
tropies ranging from 0 to log2 3 ≈ 1.58, the latter
of which would be over our filtering threshold of
1 (see Section 5.1 for details on selecting thresh-
olds). Since high-entropy utterances are relatively
short, we also examined the relationship between
entropy and utterance length (Figure 2). Given

Figure 2: Entropy of source utterances (computed with
IDENTITY) with respect to utterance length.

the relationship between frequency and entropy, it
comes as no surprise that longer utterances have
lower entropy.

4.2 Clustering Results

Compared to IDENTITY, both SENT2VEC and
AVG-EMBEDDING produce a much lower number
of clusters with 0 entropy, but also a huge clus-
ter with more than 5000 elements (the size of
the second largest cluster is below 500), which
we didn’t filter since it clearly doesn’t group ut-
terances with similar meaning. Generally, clus-
ters were formed of similar utterances with the
occasional exception of longer outlier utterances
clustered together (instead of creating a separate
cluster for each outlier), which can be attributed
to the nature of the clustering algorithm. Over-
all, SENT2VEC appeared to produce better clusters
than AVG-EMBEDDING, as reflected in the evalua-
tion in Section 5.

We experimented with different bandwidth val-
ues5 for the Mean Shift algorithm to produce clus-
ters with as many elements as possible while also
keeping the elements semantically similar. In an
example cluster (Figure 3) we can see that the
clustering was able to group together several vari-
ants of How are you?, in particular, those with dif-
ferent names. In general, we noticed that both in
the case of IDENTITY and the clustering methods,
utterances labeled with the highest entropy are in-
deed those generic sources and replies which we
hoped to eliminate. See Appendix A.1 for a selec-
tion of high entropy utterances and clusters.

5Bandwidth is like a radius in the latent space of utterance
representations (Fukunaga and Hostetler, 1975).



5654

Figure 3: A cluster produced by SENT2VEC.

5 Experiments

In this section the model and parameter setups are
presented along with 17 evaluation metrics. Lim-
itations of these metrics are discussed and a com-
parison between our filtering methods is presented
on DailyDialog (Section 5.3), and other datasets
(Section 5.4).

5.1 Model and Parameters

Dataset Type Th. SOURCE TARGET BOTH

DailyDialog
ID 1 5.64% 6.98% 12.2%
AE 3.5 5.39% 7.06% 12.0%
SC 3.5 6.53% 8.45% 14.3%

Cornell ID 4 - 7.39% 14.1%
Twitter ID 0.5 - 1.82% 9.96%

Table 1: Entropy threshold (Th.) and amount of data
filtered for all datasets in the 3 filtering scenarios. ID
stands for IDENTITY, AE stands for AVG-EMBEDDING,
and SC for SENT2VEC.

We use transformer (Vaswani et al., 2017)
as our dialog model, an encoder-decoder architec-
ture relying solely on attention mechanisms (Bah-
danau et al., 2015). transformer has already
been applied to a plethora of natural language pro-
cessing tasks, including dialog modeling (Dinan
et al., 2019; Mazare et al., 2018; Devlin et al.,
2018). We used the official implementation6 (see
Appendix A.2 for a report of hyperparameters).

6https://github.com/tensorflow/
tensor2tensor

The vocabulary for DailyDialog was limited to the
most frequent 16 384 words, and train / validation
/ test splits contained 71 517 / 9 027 / 9 318 exam-
ples, respectively.

Clustering and Filtering. For AVG-
EMBEDDING fastText7 embeddings were used.
The bandwidth of Mean Shift was set to 0.7
and 3.5 for AVG-EMBEDDING and SENT2VEC,
which produced 40 135 and 23 616 clusters,
respectively. Entropy thresholds and amount of
data filtered can be found in Table 1. Generally
we set the threshold so that filtered data amount
is similar to the DailyDialog IDENTITY scenario.
We also set a threshold for the maximum average
utterance length (15 and 20 for AVG-EMBEDDING
and SENT2VEC) in clusters that we considered
for filtering, excluding outliers from the filtering
process (see Section 4.2).

Training and Decoding. Word embeddings of
size 512 were randomly initialized, batch size
was set to 2048 tokens, and we used the Adam
optimizer (Kingma and Ba, 2014). We experi-
mented with various beam sizes (Graves, 2012),
but greedy decoding performed better according
to all metrics, also observed previously (Asghar
et al., 2017; Shao et al., 2017; Tandon et al., 2017).

5.2 Evaluation Metrics

As mentioned in Section 2, automatic evaluation
of chatbots is an open research problem. In order
to get as complete a picture as possible, we use 17
metrics that have been applied to dialog models
over the past years, briefly described below. These
metrics assess different aspects of response qual-
ity, thus models should be compared on the whole
set of metrics.

Response length. Widely used as a simple en-
gagement indicator (Serban et al., 2017b; Tandon
et al., 2017; Baheti et al., 2018).

Word and utterance entropy. The per-word en-
tropy Hw = − 1|U |

∑
w∈U log2 p(w) of responses

is measured to determine their non-genericness
(Serban et al., 2017b). Probabilities are calculated
based on frequencies observed in the training data.
We introduce the bigram version of this metric, to
measure diversity at the bigram level as well. Ut-
terance entropy is the product of Hw and |U |, also
reported at the bigram level.

7https://fasttext.cc/

https://github.com/tensorflow/tensor2tensor
https://github.com/tensorflow/tensor2tensor
https://fasttext.cc/


5655

KL divergence. We use the KL divergence be-
tween model and ground truth (GT) response sets
to measure how well a model can approximate
the GT distribution of words. Specifically, we
define distributions pgt and pm based on each
set of responses and calculate the KL divergence
Dkl =

1
|Ugt|

∑
w∈Ugt log2

pgt(w)
pm(w)

for each GT re-
sponse. The bigram version of this metric is also
reported.

Embedding metrics. Embedding average, ex-
trema, and greedy are widely used metrics (Liu
et al., 2016; Serban et al., 2017b; Zhang et al.,
2018c). average measures the cosine similarity
between the averages of word vectors of response
and target utterances. extrema constructs a rep-
resentation by taking the greatest absolute value
for each dimension among the word vectors in the
response and target utterances and measures the
cosine similarity between them. Finally, greedy
matches each response token to a target token
(and vice versa) based on the cosine similarity
between their embeddings and averages the total
score across all words. For word embeddings and
average word embedding representations, we used
the same setup as in AVG-EMBEDDING.

Coherence. We measure the cosine similarity
between pairs of input and response (Xu et al.,
2018b). Although a coherence value of 1 would
indicate that input and response are the same, gen-
erally a higher value seems better as model re-
sponses tend to have lower coherence than targets.

Distinct metrics. Distinct-1 and distinct-2 are
widely used in the literature (Li et al., 2016a; Shen
et al., 2018a; Xu et al., 2018b), measuring the ratio
of unique unigrams/bigrams to the total number of
unigrams/bigrams in a set of responses. However,
they are very sensitive to the test data size, since
increasing the number of examples in itself low-
ers their value. While the number of total words
increases linearly, the number of unique words
is limited by the vocabulary, and we found that
the ratio decreases even in human data (see Ap-
pendix A.3 for details). It is therefore important
to only compare distinct metrics computed on the
same test data.

Bleu. Measuring n-gram overlap between re-
sponse and target is widely used in the machine
learning and dialog literature (Shen et al., 2018a;
Xu et al., 2018b). We report BLEU-1, BLUE-

2, BLEU-3, and BLEU-4 computed with the
4th smoothing algorithm described in Chen and
Cherry (2014).

Figure 4: Embedding metrics and coherence (on vali-
dation data) as a function of the training evolution of
transformer on unfiltered data (DailyDialog).

Figure 5: Training (bottom) and validation (top)
loss with respect to training steps of transformer
trained on unfiltered data (DailyDialog).

Normally metrics are computed at the validation
loss minimum of a model, however in the case of
chatbot models loss may not be a good indicator of
response quality (Section 2), thus we also looked
at how our metrics progress during training. Fig-
ure 4 shows how coherence and the 3 embedding
metrics saturate after about 80-100k steps, and
never decrease (we ran the training for 300k steps,
roughly 640 epochs). Most metrics show a simi-
lar trend of increasing until 100k steps, and then
stagnating (see Appendix A.3 for more figures).

In contrast, validation loss for the same train-
ing reaches its minimum after about 10-20k steps
(Figure 5). This again suggests the inadequacy of



5656

|U | Huw Hbw Huu Hbu Dukl Dbkl AVG EXT GRE COH d1 d2 b1 b2 b3 b4
TRF 8.6 7.30 12.2 63.6 93 .330 .85 .540 .497 .552 .538 .0290 .149 .142 .135 .130 .119

ID
B 9.8 7.44 12.3 71.9 105 .315 .77 .559 .506 .555 .572 .0247 .138 .157 .151 .147 .136
T 10.9 7.67 12.7 83.2 121 .286 .72 .570 .507 .554 .584 .0266 .150 .161 .159 .156 .146
S 9.4 7.19 11.9 66.4 98 .462 1.08 .540 .495 .553 .538 .0262 .130 .139 .133 .128 .117

A
E

B 7.9 7.25 12.0 57.7 83 .447 1.05 .524 .486 .548 .524 .0283 .132 .128 .121 .115 .105
T 8.6 7.26 12.1 61.4 90 .425 1.12 .526 .492 .548 .529 .0236 .115 .133 .127 .121 .111
S 9.0 7.21 11.9 65.1 95 .496 1.16 .536 .490 .548 .538 .0232 .109 .134 .130 .126 .116

SC

B 10.0 7.40 12.3 72.6 108 .383 .97 .544 .497 .549 .550 .0257 .131 .145 .142 .138 .128
T 11.2 7.49 12.4 82.2 122 .391 .97 .565 .500 .552 .572 .0250 .132 .153 .153 .152 .142
S 11.1 7.15 11.9 74.4 114 .534 1.27 .546 .501 .560 .544 .0213 .102 .144 .139 .135 .125

Table 2: Metrics computed at the minimum of the validation loss on the unfiltered test set (DailyDialog). TRF
refers to transformer, ID to IDENTITY, AE to AVG-EMBEDDING, and SC to SENT2VEC. SOURCE-side,
TARGET-side, and filtering BOTH sides are denoted by initials. Best results are highlighted with bold and best
results separately for each entropy computing method are in italic (and those within a 95% confidence interval).

|U | Huw Hbw Huu Hbu Dukl Dbkl AVG EXT GRE COH d1 d2 b1 b2 b3 b4
TRF 11.5 7.98 13.4 95 142 .0360 .182 .655 .607 .640 .567 .0465 .297 .333 .333 .328 .315

ID

B 13.1 8.08 13.6 107 162 .0473 .210 .668 .608 .638 .598 .0410 .275 .334 .340 .339 .328
T 12.2 8.04 13.6 100 150 .0335 .181 .665 .610 .640 .589 .0438 .289 .338 .341 .339 .328
S 12.3 7.99 13.5 101 153 .0406 .187 .662 .610 .641 .578 .0444 .286 .339 .342 .338 .326

A
E

B 11.9 7.98 13.5 98 147 .0395 .197 .649 .600 .628 .574 .0434 .286 .318 .321 .318 .306
T 12.5 7.99 13.5 102 155 .0436 .204 .656 .602 .634 .580 .0423 .279 .324 .327 .325 .313
S 12.1 7.93 13.4 99 148 .0368 .186 .658 .605 .636 .578 .0425 .278 .325 .328 .324 .311

SC

B 12.8 8.07 13.6 105 159 .0461 .209 .655 .600 .629 .583 .0435 .282 .322 .328 .327 .316
T 13.0 8.06 13.6 107 162 .0477 .215 .657 .602 .632 .585 .0425 .279 .324 .330 .329 .318
S 12.1 7.96 13.4 100 150 .0353 .183 .657 .606 .638 .576 .0443 .286 .331 .333 .329 .317

RT 13.5 8.40 14.2 116 177 .0300 .151 .531 .452 .481 .530 .0577 .379 .090 .121 .130 .125
GT 14.1 8.39 13.9 122 165 0 0 1 1 1 .602 .0488 .362 1 1 1 1

Table 3: Metrics computed on the unfiltered test set (DailyDialog) after 150 epochs of training. TRF refers to
transformer, ID to IDENTITY, AE to AVG-EMBEDDING, and SC to SENT2VEC. SOURCE-side, TARGET-side,
and filtering BOTH sides are denoted by initials. Best results are highlighted with bold and best results separately
for each entropy computing method are in italic (and those within a 95% confidence interval). GT refers to ground
truth responses and RT refers to randomly selected responses from the training set.

the loss function, but it also questions the valid-
ity of these metrics, as they seem to favor a model
that overfitted the training data, which we can as-
sume after 640 epochs. This could be due to the
many identical inputs in train and test splits, be-
cause of the nature of dialog data. Most interest-
ing are embedding metrics and BLEU scores (Sec-
tion 5.3), since they show that even after overfit-
ting responses do not get farther from targets. This
is in line with other findings reporting that qualita-
tively responses are better after overfitting (Csaky,
2019; Tandon et al., 2017), however occasionally
they also tend to be too specific and irrelevant. We
leave it for future work to conduct human evalua-
tion between non-overfitted and overfitted models
to solidify these claims. In light of these issues, we
compare trainings on the DailyDialog dataset both

at the validation loss minimum and at an overfitted
point (150 epochs).

5.3 DailyDialog Results
We compute metrics on the unfiltered test set to
show that filtered trainings perform better even on
utterances that would have been filtered from the
training data. TRF, the baseline transformer
model trained on unfiltered data is compared to
the 9 trainings on filtered data. In all tables the
17 metrics from left to right are: response length,
unigram and bigram entropy, unigram and bigram
utterance entropy, unigram and bigram KL diver-
gence, embedding average, extrema and greedy,
coherence, distinct-1 and distinct-2, and finally,
BLEU-1, BLEU-2, BLEU-3 and BLEU-4 (see
Section 5.2).

Evaluating at the minimum validation loss (Ta-



5657

Input Response

your starting salary is 2500 yuan a month and
after you become a permanent employee it will
be higher .

BASE: i can tell you what is the best way to find a job .
BASE-O: do you know what it is ?
TARGET: i ’m very interested in the position .
TARGET-O: that ’s very nice of you . i ’ll have to think about it .

you can greatly improve your grades by always
reflecting on what you can improve on .

BASE: i want to be a great singer .
BASE-O: i really appreciate it . thanks .
TARGET: i think i am experienced in that position . i think i would
like to make a good impression .
TARGET-O: i always liked it . thank you .

umm i think i would be hard to find something
in that range in this area . you know the
environment in the south district is the nicest .

BASE: what about the kitchen ?
BASE-O: what about the kitchen ?
TARGET: what about the kitchen ?
TARGET-O: what about the kitchen ?

Table 4: Example inputs and responses from DailyDialog. BASE is trained on unfiltered data, and TARGET is the
model trained on IDENTITY, TARGET filtered data. Models marked with O are evaluated at an overfitted point.

ble 2) clearly shows that models trained on data
filtered by IDENTITY and SENT2VEC are better
than the baseline. IDENTITY performs best among
the three methods, surpassing the baseline on all
but the distinct-1 metric. SENT2VEC is a close
second, getting higher values on fewer metrics
than IDENTITY, but mostly improving on the base-
line. Finally, AVG-EMBEDDING is inferior to the
baseline, as it didn’t produce clusters as mean-
ingful as SENT2VEC, and thus produced a lower
quality training set. It seems like filtering high
entropy targets (both in the case of IDENTITY
and SENT2VEC) is more beneficial than filtering
sources, and BOTH falls mostly in the middle as
expected, since it combines the two filtering types.
By removing example responses that are boring
and generic from the dataset the model learns to
improve response quality. Finding such utterances
is useful for a number of purposes, but earlier it
has been done mainly manually (Li et al., 2016d;
Shen et al., 2017), whereas we provide an au-
tomatic, unsupervised method of detecting them
based on entropy.

Every value is higher after 150 epochs of train-
ing than at the validation loss minimum (Table 3).
The most striking change is in the unigram KL
divergence, which is now an order of magnitude
lower. IDENTITY still performs best, falling be-
hind the baseline on only the two distinct metrics.
Interestingly this time BOTH filtering was better
than the TARGET filtering. SENT2VEC still mostly
improves the baseline and AVG-EMBEDDING now
also performs better or at least as good as the base-
line on most metrics. In some cases the best per-
forming model gets quite close to the ground truth
performance. On metrics that evaluate utterances
without context (i.e. entropy, divergence, dis-

tinct), randomly selected responses achieve sim-
ilar values as the ground truth, which is expected.
However, on embedding metrics, coherence, and
BLEU, random responses are significantly worse
than those of any model evaluated.

Computing the unigram and bigram KL diver-
gence with a uniform distribution instead of the
model yields a value of 4.35 and 1.87, respec-
tively. Thus, all models learned a much better
distribution, suggesting that this is indeed a use-
ful metric. We believe the main reason that clus-
tering methods perform worse than IDENTITY is
that clustering adds some noise to the filtering pro-
cess. Conducting a good clustering of sentence
vectors is a hard task. This could be remedied
by filtering only utterances instead of whole clus-
ters, thus combining IDENTITY and the clustering
methods. In this scenario, the entropy of individ-
ual utterances is computed based on the clustered
data. The intuition behind this approach would be
that the noise in the clusters based on which we
compute entropy is less harmful than the noise in
clusters which we consider for filtering. Finally,
Table 4 shows responses from the baseline and the
best performing model to 3 randomly selected in-
puts from the test set (which we made sure are not
present in the training set) to show that training on
filtered data does not degrade response quality. We
show more example responses in Appendix A.3.

5.4 Cornell and Twitter Results

To further solidify our claims we tested the two
best performing variants of IDENTITY (BOTH and
TARGET) on the Cornell Movie-Dialogs Corpus
and on a subset of 220k examples from the Twit-



5658

|U | Huw Hbw Huu Hbu Dukl Dbkl AVG EXT GRE COH d1 d2 b1 b2 b3 b4
TRF 8.1 6.55 10.4 54 75 2.29 3.40 .667 .451 .635 .671 4.7e-4 1.0e-3 .108 .120 .120 .112

ID
B 7.4 6.67 10.8 50 69 1.96 2.91 .627 .455 .633 .637 2.1e-3 7.7e-3 .106 .113 .111 .103
T 12.0 6.44 10.4 74 106 2.53 3.79 .646 .456 .637 .651 9.8e-4 3.2e-3 .108 .123 .125 .118

RT 13.4 8.26 14.2 113 170 .03 .12 .623 .386 .601 .622 4.6e-2 3.2e-1 .079 .102 .109 .105
GT 13.1 8.18 13.8 110 149 0 0 1 1 1 .655 4.0e-2 3.1e-1 1 1 1 1

Table 5: Metrics on the unfiltered test set (Cornell) at the validation loss minimum. TRF refers to transformer,
ID to IDENTITY. TARGET-side, and filtering BOTH sides are denoted by initials. Best results are highlighted with
bold. GT refers to ground truth responses and RT refers to randomly selected responses from the training set.

|U | Huw Hbw Huu Hbu Dukl Dbkl AVG EXT GRE COH d1 d2 b1 b2 b3 b4
TRF 20.6 6.89 11.4 121 177 2.28 3.40 .643 .395 .591 .659 2.1e-3 6.2e-3 .0519 .0666 .0715 .0693

ID

B 20.3 6.95 11.4 119 171 2.36 3.41 .657 .394 .595 .673 1.2e-3 3.4e-3 .0563 .0736 .0795 .0774
T 29.0 6.48 10.7 157 226 2.68 3.69 .644 .403 .602 .660 1.4e-3 4.6e-3 .0550 .0740 .0819 .0810

RT 14.0 9.81 15.9 136 171 .05 .19 .681 .334 .543 .695 8.5e-2 5.4e-1 .0444 .0751 .0852 .0840
GT 14.0 9.78 15.8 135 167 0 0 1 1 1 .734 8.1e-2 5.3e-1 1 1 1 1

Table 6: Metrics on the unfiltered test set (Twitter) at the validation loss minimum. TRF refers to transformer,
ID to IDENTITY. TARGET-side, and filtering BOTH sides are denoted by initials. Best results are highlighted with
bold. GT refers to ground truth responses and RT refers to randomly selected responses from the training set.

ter corpus8. Entropy thresholds were selected to
be similar to the DailyDialog experiments (Ta-
ble 1). Evaluation results at the validation loss
minimum on the Cornell corpus and the Twitter
dataset are presented in Table 5 and Table 6, re-
spectively. On these noisier datasets our simple
IDENTITY method still managed to improve over
the baseline, but the impact is not as pronounced
and in contrast to DailyDialog, BOTH and TAR-
GET perform best on nearly the same number of
metrics. On these noisier datasets the clustering
methods might work better, this is left for fu-
ture work. Compared to DailyDialog there are
some important distinctions that also underline
that these datasets are of lesser quality. The CO-
HERENCE metric is worse on the ground truth re-
sponses than on model responses (Table 5, and
some embedding metrics and BLEU scores are
better on randomly selected responses than on
model responses (Table 6).

6 Conclusion

We proposed a simple unsupervised entropy-based
approach that can be applied to any conversa-
tional dataset for filtering generic sources/targets
that cause “confusion” during the training of open-
domain dialog models. We compared various se-
tups in an extensive quantitative evaluation, and
showed that the best approach is measuring the

8https://github.com/Marsan-Ma/chat_
corpus/

entropy of individual utterances and filtering pairs
based on the entropy of target, but not source utter-
ances. Some limitations of current automatic met-
rics and the loss function have also been shown,
by examining their behavior on random data and
with overfitting.

In the future, we plan to explore several addi-
tional ideas. As mentioned in Section 5.3, we
want to extend our clustering experiments combin-
ing the ideas behind IDENTITY and the clustering
methods to make them more robust to noise. We
wish to conduct clustering experiments on nois-
ier datasets and try other sentence representations
(Devlin et al., 2018). We also plan to combine our
method with coherence-based filtering (Xu et al.,
2018b). Furthermore, we intend to perform a di-
rect quantitative evaluation of our method based
on human evaluation. Finally, we believe our
method is general enough that it could also be ap-
plied to datasets in other similar NLP tasks, such
as machine translation, which could open another
interesting line of future research.

Acknowledgments

We wish to thank Evelin Ács, Péter Ihász, Márton
Makrai, Luca Szegletes, and all anonymous re-
viewers for their thoughtful feedback. Work par-
tially supported by Project FIEK 16-1-2016-0007,
financed by the FIEK 16 funding scheme of the
Hungarian National Research, Development and
Innovation Office (NKFIH).

https://github.com/Marsan-Ma/chat_corpus/
https://github.com/Marsan-Ma/chat_corpus/


5659

References
Sanjeev Arora, Yingyu Liang, and Tengyu Ma. 2017.

A simple but tough-to-beat baseline for sentence em-
beddings. In International Conference on Learning
Representations.

Nabiha Asghar, Pascal Poupart, Xin Jiang, and Hang
Li. 2017. Deep active learning for dialogue genera-
tion. In Proceedings of the 6th Joint Conference on
Lexical and Computational Semantics (*SEM 2017),
pages 78–83. Association for Computational Lin-
guistics.

Amittai Axelrod, Xiaodong He, and Jianfeng Gao.
2011. Domain adaptation via pseudo in-domain data
selection. In Proceedings of the 2011 Conference on
Empirical Methods in Natural Language Process-
ing, pages 355–362, Edinburgh, Scotland, UK. As-
sociation for Computational Linguistics.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In International Con-
ference on Learning Representations (ICLR 2015).

Ashutosh Baheti, Alan Ritter, Jiwei Li, and Bill Dolan.
2018. Generating more interesting responses in
neural conversation models with distributional con-
straints. In Proceedings of the 2018 Conference on
Empirical Methods in Natural Language Process-
ing, pages 3970–3980. Association for Computa-
tional Linguistics.

Boxing Chen and Colin Cherry. 2014. A systematic
comparison of smoothing techniques for sentence-
level BLEU. In Proceedings of the Ninth Workshop
on Statistical Machine Translation, pages 362–367,
Baltimore, Maryland, USA. Association for Compu-
tational Linguistics.

Kyunghyun Cho, Bart van Merriëenboer, Caglar Gul-
cehre, Fethi Bougares, Holger Schwenk, and Yoshua
Bengio. 2014. Learning phrase representations
using rnn encoder-decoder for statistical machine
translation. In Proceedings of the 2014 Conference
on Empirical Methods in Natural Language Pro-
cessing (EMNLP), pages 1724–1734, Doha, Qatar.

Richard Csaky. 2019. Deep learning
based chatbot models. National Scien-
tific Students’ Associations Conference.
Https://tdk.bme.hu/VIK/DownloadPaper/asdad.

Cristian Danescu-Niculescu-Mizil and Lillian Lee.
2011. Chameleons in imagined conversations: A
new approach to understanding coordination of lin-
guistic style in dialogs. In Proceedings of the
2nd Workshop on Cognitive Modeling and Compu-
tational Linguistics, pages 76–87. Association for
Computational Linguistics.

Jacob Devlin, Ming-Wei Chang, Kenton Lee, and
Kristina Toutanova. 2018. Bert: Pre-training of deep
bidirectional transformers for language understand-
ing.

Emily Dinan, Stephen Roller, Kurt Shuster, Angela
Fan, Michael Auli, and Jason Weston. 2019. Wizard
of wikipedia: Knowledge-powered conversational
agents. In International Conference on Learning
Representations.

Hao Fang, Hao Cheng, Maarten Sap, Elizabeth Clark,
Ari Holtzman, Yejin Choi, Noah A. Smith, and Mari
Ostendorf. 2018. Sounding board: A user-centric
and content-driven social chatbot. In Proceedings of
the 2018 Conference of the North American Chap-
ter of the Association for Computational Linguis-
tics: Demonstrations, pages 96–100. Association for
Computational Linguistics.

Keinosuke Fukunaga and Larry Hostetler. 1975. The
estimation of the gradient of a density function, with
applications in pattern recognition. IEEE Transac-
tions on information theory, 21(1):32–40.

Xiang Gao, Sungjin Lee, Yizhe Zhang, Chris Brock-
ett, Michel Galley, Jianfeng Gao, and Bill Dolan.
2019. Jointly optimizing diversity and relevance
in neural response generation. arXiv preprint
arXiv:1902.11205.

Marjan Ghazvininejad, Chris Brockett, Ming-Wei
Chang, Bill Dolan, Jianfeng Gao, Wen-tau Yih, and
Michel Galley. 2018. A knowledge-grounded neural
conversation model. In Thirty-Second AAAI Confer-
ence on Artificial Intelligence. Association for the
Advancement of Artificial Intelligence.

Alex Graves. 2012. Sequence transduction with recur-
rent neural networks. In Representation Learning
Workshop, ICML 2012, Edinburgh, Scotland.

Xiaodong Gu, Kyunghyun Cho, Jung-Woo Ha, and
Sunghun Kim. 2019. DialogWAE: Multimodal
response generation with conditional wasserstein
auto-encoder. In International Conference on
Learning Representations.

Chaitanya K Joshi, Fei Mi, and Boi Faltings. 2017.
Personalization in goal-oriented dialog. arXiv
preprint arXiv:1706.07503.

Kirthevasan Kandasamy, Yoram Bachrach, Ryota
Tomioka, Daniel Tarlow, and David Carter. 2017.
Batch policy gradient methods for improving
neural conversation models. arXiv preprint
arXiv:1702.03334.

Diederik P Kingma and Jimmy Ba. 2014. Adam: A
method for stochastic optimization. arXiv preprint
arXiv:1412.6980.

Ben Krause, Marco Damonte, Mihai Dobre, Daniel
Duma, Joachim Fainberg, Federico Fancellu, Em-
manuel Kahembwe, Jianpeng Cheng, and Bonnie
Webber. 2017. Edina: Building an open domain so-
cialbot with self-dialogues. In 1st Proceedings of
Alexa Prize (Alexa Prize 2017).

https://openreview.net/pdf?id=SyK00v5xx
https://openreview.net/pdf?id=SyK00v5xx
https://doi.org/10.18653/v1/S17-1008
https://doi.org/10.18653/v1/S17-1008
https://www.aclweb.org/anthology/D11-1033
https://www.aclweb.org/anthology/D11-1033
http://arxiv.org/abs/1409.0473
http://arxiv.org/abs/1409.0473
http://aclweb.org/anthology/D18-1431
http://aclweb.org/anthology/D18-1431
http://aclweb.org/anthology/D18-1431
https://doi.org/10.3115/v1/W14-3346
https://doi.org/10.3115/v1/W14-3346
https://doi.org/10.3115/v1/W14-3346
http://www.aclweb.org/anthology/D14-1179
http://www.aclweb.org/anthology/D14-1179
http://www.aclweb.org/anthology/D14-1179
https://tdk.bme.hu/VIK/DownloadPaper/asdad
https://tdk.bme.hu/VIK/DownloadPaper/asdad
http://aclweb.org/anthology/W11-0609
http://aclweb.org/anthology/W11-0609
http://aclweb.org/anthology/W11-0609
http://arxiv.org/abs/http://arxiv.org/abs/1810.04805v1
http://arxiv.org/abs/http://arxiv.org/abs/1810.04805v1
http://arxiv.org/abs/http://arxiv.org/abs/1810.04805v1
https://openreview.net/forum?id=r1l73iRqKm
https://openreview.net/forum?id=r1l73iRqKm
https://openreview.net/forum?id=r1l73iRqKm
https://doi.org/10.18653/v1/N18-5020
https://doi.org/10.18653/v1/N18-5020
https://ieeexplore.ieee.org/document/1055330
https://ieeexplore.ieee.org/document/1055330
https://ieeexplore.ieee.org/document/1055330
https://arxiv.org/pdf/1902.11205.pdf
https://arxiv.org/pdf/1902.11205.pdf
https://arxiv.org/abs/1702.01932
https://arxiv.org/abs/1702.01932
http://arxiv.org/abs/1211.3711
http://arxiv.org/abs/1211.3711
https://openreview.net/forum?id=BkgBvsC9FQ
https://openreview.net/forum?id=BkgBvsC9FQ
https://openreview.net/forum?id=BkgBvsC9FQ
https://arxiv.org/abs/1706.07503
https://arxiv.org/abs/1702.03334
https://arxiv.org/abs/1702.03334
https://arxiv.org/abs/1412.6980
https://arxiv.org/abs/1412.6980
https://s3.amazonaws.com/alexaprize/2017/technical-article/edina.pdf
https://s3.amazonaws.com/alexaprize/2017/technical-article/edina.pdf


5660

Ilya Kulikov, Alexander H Miller, Kyunghyun Cho,
and Jason Weston. 2018. Importance of a search
strategy in neural dialogue modelling. arXiv
preprint arXiv:1811.00907.

Mike Lewis, Denis Yarats, Yann N Dauphin, Devi
Parikh, and Dhruv Batra. 2017. Deal or no deal?
end-to-end learning for negotiation dialogues. In
Proceedings of the 2017 Conference on Empirical
Methods in Natural Language Processing, pages
2443–2453. Association for Computational Linguis-
tics.

Jiwei Li, Michel Galley, Chris Brockett, Jianfeng Gao,
and Bill Dolan. 2016a. A diversity-promoting ob-
jective function for neural conversation models. In
Proceedings of NAACL-HLT 2016, pages 110–119.
Association for Computational Linguistics.

Jiwei Li, Michel Galley, Chris Brockett, Georgios P
Spithourakis, Jianfeng Gao, and Bill Dolan. 2016b.
A persona-based neural conversation model. In Pro-
ceedings of the 54th Annual Meeting of the Asso-
ciation for Computational Linguistics, pages 994–
1003. Association for Computational Linguistics.

Jiwei Li, Alexander H Miller, Sumit Chopra,
Marc’Aurelio Ranzato, and Jason Weston. 2016c.
Dialogue learning with human-in-the-loop. arXiv
preprint arXiv:1611.09823.

Jiwei Li, Will Monroe, and Dan Jurafsky. 2017a. Data
distillation for controlling specificity in dialogue
generation. arXiv preprint arXiv:1702.06703.

Jiwei Li, Will Monroe, Alan Ritter, Michel Galley,
Jianfeng Gao, and Dan Jurafsky. 2016d. Deep rein-
forcement learning for dialogue generation. In Pro-
ceedings of the 2016 Conference on Empirical Meth-
ods in Natural Language Processing, pages 1192–
1202. Association for Computational Linguistics.

Jiwei Li, Will Monroe, Tianlin Shi, Alan Ritter, and
Dan Jurafsky. 2017b. Adversarial learning for neu-
ral dialogue generation. In Proceedings of the 2017
Conference on Empirical Methods in Natural Lan-
guage Processing, pages 2157–2169. Association
for Computational Linguistics.

Yanran Li, Hui Su, Xiaoyu Shen, Wenjie Li, Ziqiang
Cao, and Shuzi Niu. 2017c. Dailydialog: A man-
ually labelled multi-turn dialogue dataset. In Pro-
ceedings of the The 8th International Joint Confer-
ence on Natural Language Processing, pages 986–
995. AFNLP.

Zachary Lipton, Xiujun Li, Jianfeng Gao, Lihong Li,
Faisal Ahmed, and Li Deng. 2018. Bbq-networks:
Efficient exploration in deep reinforcement learning
for task-oriented dialogue systems. In The Thirty-
Second AAAI Conference on Artificial Intelligence
(AAAI-18). Association for the Advancement of Ar-
tificial Intelligence.

Chia-Wei Liu, Ryan Lowe, Iulian Serban, Mike Nose-
worthy, Laurent Charlin, and Joelle Pineau. 2016.
How not to evaluate your dialogue system: An em-
pirical study of unsupervised evaluation metrics for
dialogue response generation. In Proceedings of the
2016 Conference on Empirical Methods in Natural
Language Processing, pages 2122–2132. Associa-
tion for Computational Linguistics.

Huiting Liu, Tao Lin, Hanfei Sun, Weijian Lin, Chih-
Wei Chang, Teng Zhong, and Alexander Rudnicky.
2017. Rubystar: A non-task-oriented mixture model
dialog system. In 1st Proceedings of Alexa Prize
(Alexa Prize 2017).

Ryan Lowe, Michael Noseworthy, Iulian Vlad Ser-
ban, Nicolas Angelard-Gontier, Yoshua Bengio, and
Joelle Pineau. 2017. Towards an automatic tur-
ing test: Learning to evaluate dialogue responses.
In Proceedings of the 55th Annual Meeting of the
Association for Computational Linguistics (Volume
1: Long Papers), pages 1116–1126. Association for
Computational Linguistics.

Oswaldo Ludwig. 2017. End-to-end adversarial learn-
ing for generative conversational agents. arXiv
preprint arXiv:1711.10122.

Pierre-Emmanuel Mazare, Samuel Humeau, Martin
Raison, and Antoine Bordes. 2018. Training mil-
lions of personalized dialogue agents. In Proceed-
ings of the 2018 Conference on Empirical Methods
in Natural Language Processing, pages 2775–2779.
Association for Computational Linguistics.

Kaixiang Mo, Yu Zhang, Qiang Yang, and Pascale
Fung. 2017. Fine grained knowledge transfer for
personalized task-oriented dialogue systems. arXiv
preprint arXiv:1711.04079.

Nikita Moghe, Siddhartha Arora, Suman Banerjee, and
Mitesh M. Khapra. 2018. Towards exploiting back-
ground knowledge for building conversation sys-
tems. In Proceedings of the 2018 Conference on
Empirical Methods in Natural Language Process-
ing, pages 2322–2332, Brussels, Belgium. Associ-
ation for Computational Linguistics.

Lili Mou, Yiping Song, Rui Yan, Ge Li, Lu Zhang,
and Zhi Jin. 2016. Sequence to backward and for-
ward sequences: A content-introducing approach to
generative short-text conversation. In Proceedings
of COLING 2016, the 26th International Confer-
ence on Computational Linguistics: Technical Pa-
pers, pages 3349–3358. The COLING 2016 Orga-
nizing Committee.

Oluwatobi Olabiyi, Alan Salimov, Anish Khazane, and
Erik Mueller. 2018. Multi-turn dialogue response
generation in an adversarial learning framework.
arXiv preprint arXiv:1805.11752.

Matteo Pagliardini, Prakhar Gupta, and Martin Jaggi.
2018. Unsupervised learning of sentence embed-
dings using compositional n-gram features. In Pro-
ceedings of the 2018 Conference of the North Amer-
ican Chapter of the Association for Computational

https://arxiv.org/abs/1811.00907
https://arxiv.org/abs/1811.00907
http://aclweb.org/anthology/D17-1259
http://aclweb.org/anthology/D17-1259
https://www.aclweb.org/anthology/N/N16/N16-1014.pdf
https://www.aclweb.org/anthology/N/N16/N16-1014.pdf
http://www.aclweb.org/anthology/P16-1094
https://arxiv.org/abs/1611.09823
https://arxiv.org/pdf/1702.06703.pdf
https://arxiv.org/pdf/1702.06703.pdf
https://arxiv.org/pdf/1702.06703.pdf
https://aclweb.org/anthology/D16-1127
https://aclweb.org/anthology/D16-1127
https://www.aclweb.org/anthology/D17-1230
https://www.aclweb.org/anthology/D17-1230
http://www.aclweb.org/anthology/I17-1099
http://www.aclweb.org/anthology/I17-1099
https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/download/16189/16073
https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/download/16189/16073
https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/download/16189/16073
https://doi.org/10.18653/v1/D16-1230
https://doi.org/10.18653/v1/D16-1230
https://doi.org/10.18653/v1/D16-1230
https://s3.amazonaws.com/alexaprize/2017/technical-article/rubystar.pdf
https://s3.amazonaws.com/alexaprize/2017/technical-article/rubystar.pdf
https://doi.org/10.18653/v1/P17-1103
https://doi.org/10.18653/v1/P17-1103
https://arxiv.org/abs/1711.10122
https://arxiv.org/abs/1711.10122
http://aclweb.org/anthology/D18-1298
http://aclweb.org/anthology/D18-1298
https://arxiv.org/abs/1711.04079
https://arxiv.org/abs/1711.04079
https://www.aclweb.org/anthology/D18-1255
https://www.aclweb.org/anthology/D18-1255
https://www.aclweb.org/anthology/D18-1255
http://aclweb.org/anthology/C16-1316
http://aclweb.org/anthology/C16-1316
http://aclweb.org/anthology/C16-1316
https://arxiv.org/abs/1805.11752
https://arxiv.org/abs/1805.11752
https://doi.org/10.18653/v1/N18-1049
https://doi.org/10.18653/v1/N18-1049


5661

Linguistics: Human Language Technologies, Vol-
ume 1 (Long Papers), pages 528–540. Association
for Computational Linguistics.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic eval-
uation of machine translation. In Proceedings of the
40th Annual Meeting of the Association for Compu-
tational Linguistics, Philadelphia.

Yookoon Park, Jaemin Cho, and Gunhee Kim. 2018.
A hierarchical latent structure for variational con-
versation modeling. In Proceedings of NAACL-HLT
2018, pages 1792–1801. Association for Computa-
tional Linguistics.

Ashwin Ram, Rohit Prasad, Chandra Khatri, Anu
Venkatesh, Raefer Gabriel, Qing Liu, Jeff Nunn,
Behnam Hedayatnia, Ming Cheng, Ashish Nagar,
et al. 2018. Conversational ai: The science behind
the alexa prize. arXiv preprint arXiv:1801.03604.

Joao Sedoc, Daphne Ippolito, Arun Kirubarajan, Jai
Thirani, Lyle Ungar, and Chris Callison-Burch.
2018. Chateval: A tool for the systematic evalua-
tion of chatbots. In Proceedings of the Workshop on
Intelligent Interactive Systems and Language Gen-
eration (2IS&NLG), pages 42–44. Association for
Computational Linguistics.

Iulian V Serban, Chinnadhurai Sankar, Mathieu Ger-
main, Saizheng Zhang, Zhouhan Lin, Sandeep Sub-
ramanian, Taesup Kim, Michael Pieper, Sarath
Chandar, Nan Rosemary Ke, et al. 2017a. A
deep reinforcement learning chatbot. arXiv preprint
arXiv:1709.02349.

Iulian Vlad Serban, Alessandro Sordoni, Yoshua Ben-
gio, Aaron C Courville, and Joelle Pineau. 2016.
Building end-to-end dialogue systems using gener-
ative hierarchical neural network models. In AAAI,
pages 3776–3784.

Iulian Vlad Serban, Alessandro Sordoni, Ryan Lowe,
Laurent Charlin, Joelle Pineau, Aaron C Courville,
and Yoshua Bengio. 2017b. A hierarchical latent
variable encoder-decoder model for generating di-
alogues. In Thirty-First AAAI Conference on Artifi-
cial Intelligence. Association for the Advancement
of Artificial Intelligence.

Igor Shalyminov, Ondřej Dušek, and Oliver Lemon.
2018. Neural response ranking for social conver-
sation: A data-efficient approach. In Proceedings of
the 2018 EMNLP Workshop SCAI: The 2nd Interna-
tional Workshop on Search-Oriented Conversational
AI, pages 1–8. Association for Computational Lin-
guistics.

Yuanlong Shao, Stephan Gouws, Denny Britz, Anna
Goldie, Brian Strope, and Ray Kurzweil. 2017.
Generating high-quality and informative conversa-
tion responses with sequence-to-sequence models.
In Proceedings of the 2017 Conference on Empiri-
cal Methods in Natural Language Processing, pages

2210–2219. Association for Computational Linguis-
tics.

Xiaoyu Shen, Hui Su, Wenjie Li, and Dietrich Klakow.
2018a. Nexus network: Connecting the preceding
and the following in dialogue generation. In Pro-
ceedings of the 2018 Conference on Empirical Meth-
ods in Natural Language Processing, pages 4316–
4327. Association for Computational Linguistics.

Xiaoyu Shen, Hui Su, Yanran Li, Wenjie Li, Shuzi
Niu, Yang Zhao, Akiko Aizawa, and Guoping Long.
2017. A conditional variational framework for dia-
log generation. In Proceedings of the 55th Annual
Meeting of the Association for Computational Lin-
guistics (Volume 2: Short Papers), pages 504–509.
Association for Computational Linguistics.

Xiaoyu Shen, Hui Su, Shuzi Niu, and Vera Demberg.
2018b. Improving variational encoder-decoders in
dialogue generation. In The Thirty-Second AAAI
Conference on Artificial Intelligence (AAAI-18). As-
sociation for the Advancement of Artificial Intelli-
gence.

Ilya Sutskever, Oriol Vinyals, and Quoc V. Le. 2014.
Sequence to sequence learning with neural net-
works. In Proc. NIPS, pages 3104–3112, Montreal,
CA.

Shubhangi Tandon, Ryan Bauer, et al. 2017. A
dual encoder sequence to sequence model for
open-domain dialogue modeling. arXiv preprint
arXiv:1710.10520.

Chongyang Tao, Lili Mou, Dongyan Zhao, and Rui
Yan. 2018. Ruber: An unsupervised method for au-
tomatic evaluation of open-domain dialog systems.
In The Thirty-Second AAAI Conference on Artifi-
cial Intelligence (AAAI-18). Association for the Ad-
vancement of Artificial Intelligence.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Oriol Vinyals and Quoc V. Le. 2015. A neural conver-
sational model. In Proceedings of the 31st Interna-
tional Conference on Machine Learning.

Yansen Wang, Chenyi Liu, Minlie Huang, and Liqiang
Nie. 2018. Learning to ask questions in open-
domain conversational systems with typed decoders.
In Proceedings of the 56th Annual Meeting of the As-
sociation for Computational Linguistics (Long Pa-
pers), pages 2193–2203. Association for Computa-
tional Linguistics.

Bolin Wei, Shuai Lu, Lili Mou, Hao Zhou, Pascal
Poupart, Ge Li, and Zhi Jin. 2017. Why do neu-
ral dialog systems generate short and meaningless

http://aclweb.org/anthology/P02-1040
http://aclweb.org/anthology/P02-1040
http://www.aclweb.org/anthology/N18-1162
http://www.aclweb.org/anthology/N18-1162
https://arxiv.org/abs/1801.03604
https://arxiv.org/abs/1801.03604
http://cis.upenn.edu/~ccb/publications/chateval.pdf
http://cis.upenn.edu/~ccb/publications/chateval.pdf
https://arxiv.org/abs/1709.02349
https://arxiv.org/abs/1709.02349
https://www.aaai.org/ocs/index.php/AAAI/AAAI16/paper/download/11957/12160
https://www.aaai.org/ocs/index.php/AAAI/AAAI16/paper/download/11957/12160
http://www.cs.toronto.edu/~lcharlin/papers/vhred_aaai17.pdf
http://www.cs.toronto.edu/~lcharlin/papers/vhred_aaai17.pdf
http://www.cs.toronto.edu/~lcharlin/papers/vhred_aaai17.pdf
http://aclweb.org/anthology/W18-5701
http://aclweb.org/anthology/W18-5701
https://doi.org/10.18653/v1/D17-1235
https://doi.org/10.18653/v1/D17-1235
http://aclweb.org/anthology/D18-1463
http://aclweb.org/anthology/D18-1463
https://doi.org/10.18653/v1/P17-2080
https://doi.org/10.18653/v1/P17-2080
https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/download/16402/16100
https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/download/16402/16100
http://arxiv.org/abs/1409.3215
http://arxiv.org/abs/1409.3215
https://arxiv.org/abs/1710.10520
https://arxiv.org/abs/1710.10520
https://arxiv.org/abs/1710.10520
http://www.ruiyan.me/pubs/AAAI2018Tao.pdf
http://www.ruiyan.me/pubs/AAAI2018Tao.pdf
http://arxiv.org/abs/1706.03762
http://arxiv.org/abs/1706.03762
http://arxiv.org/pdf/1506.05869v3.pdf
http://arxiv.org/pdf/1506.05869v3.pdf
http://www.aclweb.org/anthology/P18-1204
http://www.aclweb.org/anthology/P18-1204
https://arxiv.org/abs/1712.02250
https://arxiv.org/abs/1712.02250


5662

replies? a comparison between dialog and transla-
tion. arXiv preprint arXiv:1712.02250.

Marek Wojciechowski and Maciej Zakrzewicz. 2002.
Dataset filtering techniques in constraint-based fre-
quent pattern mining. In Pattern detection and dis-
covery, pages 77–91. Springer.

Bowen Wu, Nan Jiang, Zhifeng Gao, Suke Li, Wenge
Rong, and Baoxun Wang. 2018. Why do neural re-
sponse generation models prefer universal replies?
arXiv preprint arXiv:1808.09187.

Chen Xing, Wei Wu, Yu Wu, Jie Liu, Yalou Huang,
Ming Zhou, and Wei-Ying Ma. 2017. Topic aware
neural response generation. In Proceedings of the
Thirty-First AAAI Conference on Artificial Intelli-
gence (AAAI-17). Association for the Advancement
of Artificial Intelligence.

Chen Xing, Yu Wu, Wei Wu, Yalou Huang, and Ming
Zhou. 2018. Hierarchical recurrent attention net-
work for response generation. In The Thirty-Second
AAAI Conference on Artificial Intelligence (AAAI-
18). Association for the Advancement of Artificial
Intelligence.

Yujie Xing and Raquel Fernández. 2018. Automatic
evaluation of neural personality-based chatbots. In
Proceedings of The 11th International Natural Lan-
guage Generation Conference, pages 189–194. As-
sociation for Computational Linguistics.

Can Xu, Wei Wu, and Yu Wu. 2018a. Towards ex-
plainable and controllable open domain dialogue
generation with dialogue acts. arXiv preprint
arXiv:1807.07255.

Xinnuo Xu, Ondřej Dušek, Ioannis Konstas, and Ver-
ena Rieser. 2018b. Better conversations by model-
ing, filtering, and optimizing for coherence and di-
versity. In Proceedings of the 2018 Conference on
Empirical Methods in Natural Language Process-
ing, pages 3981–3991. Association for Computa-
tional Linguistics.

Hainan Zhang, Yanyan Lan, Jiafeng Guo, Jun Xu, and
Xueqi Cheng. 2018a. Reinforcing coherence for se-
quence to sequence model in dialogue generation.
In Proceedings of the Twenty-Seventh International
Joint Conference on Artificial Intelligence (IJCAI-
18), pages 4567–4573.

Saizheng Zhang, Emily Dinan, Jack Urbanek, Arthur
Szlam, Douwe Kiela, and Jason Weston. 2018b.
Personalizing dialogue agents: I have a dog, do you
have pets too? In Proceedings of the 56th Annual
Meeting of the Association for Computational Lin-
guistics (Long Papers), pages 2204–2213. Associa-
tion for Computational Linguistics.

Yizhe Zhang, Michel Galley, Jianfeng Gao, Zhe Gan,
Xiujun Li, Chris Brockett, and Bill Dolan. 2018c.
Generating informative and diverse conversational
responses via adversarial information maximization.
In 32nd Conference on Neural Information Process-
ing Systems (NeurIPS 2018).

Tiancheng Zhao, Kyusong Lee, and Maxine Eskenazi.
2018. Unsupervised discrete sentence representa-
tion learning for interpretable neural dialog gener-
ation. In Proceedings of the 56th Annual Meeting of
the Association for Computational Linguistics (Long
Papers), pages 1098–1107. Association for Compu-
tational Linguistics.

Tiancheng Zhao, Ran Zhao, and Maxine Eskenazi.
2017. Learning discourse-level diversity for neural
dialog models using conditional variational autoen-
coders. In Proceedings of the 55th Annual Meet-
ing of the Association for Computational Linguistics
(Volume 1: Long Papers), pages 654–664. Associa-
tion for Computational Linguistics.

Hao Zhou, Minlie Huang, Tianyang Zhang, Xiaoyan
Zhu, and Bing Liu. 2018. Emotional chatting ma-
chine: Emotional conversation generation with in-
ternal and external memory. In The Thirty-Second
AAAI Conference on Artificial Intelligence (AAAI-
18). Association for the Advancement of Artificial
Intelligence.

Wenya Zhu, Kaixiang Mo, Yu Zhang, Zhangbin Zhu,
Xuezheng Peng, and Qiang Yang. 2017. Flexible
end-to-end dialogue system for knowledge grounded
conversation. arXiv preprint arXiv:1709.04264.

https://arxiv.org/abs/1712.02250
https://arxiv.org/abs/1712.02250
https://www.cs.put.poznan.pl/mwojciechowski/papers/esf02.pdf
https://www.cs.put.poznan.pl/mwojciechowski/papers/esf02.pdf
https://arxiv.org/pdf/1808.09187.pdf
https://arxiv.org/pdf/1808.09187.pdf
https://www.aaai.org/ocs/index.php/AAAI/AAAI17/paper/download/14563/14260
https://www.aaai.org/ocs/index.php/AAAI/AAAI17/paper/download/14563/14260
https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/download/16510/16119
https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/download/16510/16119
http://aclweb.org/anthology/W18-6524
http://aclweb.org/anthology/W18-6524
https://arxiv.org/pdf/1807.07255.pdf
https://arxiv.org/pdf/1807.07255.pdf
https://arxiv.org/pdf/1807.07255.pdf
http://aclweb.org/anthology/D18-1432
http://aclweb.org/anthology/D18-1432
http://aclweb.org/anthology/D18-1432
https://www.ijcai.org/proceedings/2018/0635.pdf
https://www.ijcai.org/proceedings/2018/0635.pdf
http://aclweb.org/anthology/P18-1205
http://aclweb.org/anthology/P18-1205
https://papers.nips.cc/paper/7452-generating-informative-and-diverse-conversational-responses-via-adversarial-information-maximization.pdf
https://papers.nips.cc/paper/7452-generating-informative-and-diverse-conversational-responses-via-adversarial-information-maximization.pdf
http://www.aclweb.org/anthology/P18-1101
http://www.aclweb.org/anthology/P18-1101
http://www.aclweb.org/anthology/P18-1101
https://doi.org/10.18653/v1/P17-1061
https://doi.org/10.18653/v1/P17-1061
https://doi.org/10.18653/v1/P17-1061
https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/download/16455/15753
https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/download/16455/15753
https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/download/16455/15753
https://arxiv.org/abs/1709.04264
https://arxiv.org/abs/1709.04264
https://arxiv.org/abs/1709.04264


5663

A Appendix

A.1 High Entropy Utterances
A.1.1 Top 20 high entropy utterances

Utterance Frequency Entropy
yes . 173 7.06
thank you . 141 6.57
why ? 104 6.33
here you are . 99 6.10
ok . 75 6.00
what do you mean ? 77 5.97
may i help you ? 72 5.96
can i help you ? 80 5.93
really ? 74 5.91
sure . 66 5.66
what can i do for you ? 51 5.63
why not ? 61 5.42
what ? 48 5.27
what happened ? 44 5.18
anything else ? 43 5.17
thank you very much . 72 5.14
what is it ? 41 5.06
i see . 42 5.05
no . 42 5.04
thanks . 50 5.03

Table 7: Top 20 source utterances (from DailyDialog)
sorted by entropy. The entropy was calculated with
IDENTITY.

A.1.2 High Entropy Clusters

Figure 6: A high entropy cluster from DailyDialog.

Figure 7: A high entropy cluster from DailyDialog.

Figure 8: A high entropy cluster from DailyDialog.



5664

A.2 Model Parameters

Name Value
Hidden size 512
Number of hidden layers 6
Label smoothing 0.1
Filter size 2048
Number of attention heads 8
Layer dropout 0.2
Relu dropout 0.1
Attention dropout 0.1
Learning rate 0.2
Learning rate warmup steps 8000

Table 8: Transformer hyperparameters.

A.3 Evaluation Metrics and Examples

Figure 9: Distinct-1 metric with respect to number of
test examples (on DailyDialog). Model responses were
evaluated on 9000 examples only, since the rest were
training examples.

Figure 10: Distinct-2 metric with respect to number of
test examples (on DailyDialog). Model responses were
evaluated on 9000 examples only, since the rest were
training examples.



5665

Figure 11: Average length of responses (computed on the validation set) with respect to the number of training
steps of the transformer trained on unfiltered data (DailyDialog).

Figure 12: Word entropy of responses (computed on the validation set) with respect to the number of training steps
of the transformer trained on unfiltered data (DailyDialog).



5666

Figure 13: Utterance entropy of responses (computed on the validation set) with respect to the number of training
steps of the transformer trained on unfiltered data (DailyDialog).

Figure 14: KL divergence of responses (computed on the validation set) with respect to the number of training
steps of the transformer trained on unfiltered data (DailyDialog).



5667

Figure 15: Distinct-1 and distinct-2 metrics (computed on the validation set) with respect to the number of training
steps of the transformer trained on unfiltered data (DailyDialog).



5668

Input Unfiltered Unfiltered-Overfitted IDENTITY TARGET fil-
tered

IDENTITY TARGET

filtered-overfitted
some high speed chase
scene i think .

i ’m not sure . but many things are
went wrong !

i ’m so sorry . enough !

how long is this bus ride
?

about twelve hours . it ’s about fortyfive min-
utes to an hour .

it ’s about 20 minutes . it ’s only about fortyfive
minutes to an hour .

is that yellow bus it ? no it ’s not far . it ’s a bit
cold .

yeah . there s a new one
in america .

no it ’s a yellow one . no it ’s not very expen-
sive these days .

hi mary ! what do you
like to do in your spare
time ?

i like playing basketball
.

well i like to play the pi-
ano .

i like playing basketball
.

i like playing chess .

let me see . we can visit
the country . we have
n’t done that for such a
long time .

i hope so . yes there are many fa-
mous paintings on show
. i hope it ’s the nicest
city in the united states .

i ’m glad to hear that . where are your parents ?

thirty u . s . dollars . . .
and it ’s only been used
for six months .

that ’s fine . i see . is it a long time
to come to the station ?

how many months did
you get there ?

what ’re two weeks ?

five hundred dollars al-
together .

here you are . here you are . here is your bill . here you are . thank you
byebye .

look at this bridge . we
will soon be crossing
the thames .

yes i agree . oh yeah . how far is it ? well there ’s a spanish
teacher . so i ’ll often go
back to the spanish mu-
seum .

is the furniture crafted
well ?

yes it is . yes it ’s fully furnished . yes the furniture is right
over there .

yes it ’s a furnished
eatin kitchen . the furni-
ture and the icebox are
all pretty outdated .

where do they go ? they ’re on the bottom
floor .

i have no idea . they re in the cabinet
next to the library .

go to them department
please .

let me pay for it . ok . here you are . cash credit card or debit
card ?

ok . here is the money . cash credit card or debit
card ?

he never does and in
fact he seldom commu-
nicates with him .

he is a hard job . he can
also learn a lot from the
government .

that ’s right . he has
no children and his wife
experience too .

he is a very kind of man
.

yeah . he ’s a very easy
teacher .

so you must have had a
busy and enjoyable day
yesterday .

yes i am . i really en-
joyed it .

yes . i am very sorry i
can t make it .

i will . thanks for com-
ing .

yes . let ’s go .

yes . the reservation un-
der mr . watson .

ok . could you spell that
please ?

i ’m afraid there ’s no
seat in the middle of the
table .

ok . would you please
fill out the table ?

there are so many to
choose from . i did n’t
know you could do all
of this using a card .

i see . what ’s the best part ? i ’m not sure . i ’ll go
to the doctor and get my
card right away .

you mean you do n’t
have to tell me the truth
?

it was great ! how was
your year ?

it was great . i had a
great time .

my mother had a birth-
day party for me .

it was great . i ’m glad i
did n’t like it .

it was ok . there was a
lot of turbulence though
. the worst thing was n’t
too good !

tomorrow ? no i am
afraid i won t be able to
. i m going on business
to birmingham .

i think you are looking
for a .<unk><unk>in
the future . the best rea-
son why are you want to
see the results .

well there is a problem
with the exchange rate
. it s the same size that
you have in the u . s .

you should go to the
dentist .

you might want to
change your plans .
with the cold and wet
weather that we re sup-
posed to have tomorrow
the roads are going to
be rather slippery .

Table 9: Responses to randomly selected test inputs which we made sure were not in the training data (DailyDia-
log). Unfiltered is the model trained on unfiltered data, and IDENTITY TARGET is the model trained on IDENTITY,
TARGET filtered data. Overfitted means that the respective model is evaluated at an overfitted point.



5669

Input Unfiltered Unfiltered-Overfitted IDENTITY TARGET fil-
tered

IDENTITY TARGET

filtered-overfitted
you ’re flattering me . no . no really . no but you can t . no really . i can only

hear a little accent .
three bags and a suit-
case . this is my luggage
to check .

ok . i will take one . what ’s this ? essential
oil ? wow ! this is a
small bag .

i ’ll put you in the bag . ok . is this your luggage
properly labelled sir ?

i like orange better . what ’s your favorite fla-
vor ?

how about drinks ? i ’ll tell you what you ’re
doing .

could i have some water
?

i like to watch barbie
sticking her tongue out
.

what ’s her figure ? oh she ’s a pretty
woman .

you are not supposed to
be serious .

oh shut up ! she ’s not
what you are thinking
about .

if you give us your in-
quiry i shall go very
carefully into the price
and try my best to put
you on the best of the
terms .

ok . i will take it . thank you very much .
we will try our best to
do our best to help you
.

i understand . i under-
stand that you are right
.

ok i will . i look forward
to it .

ok . any time on friday
will be ok with me .

ok . see you then . i think so . i ’ll be expecting you
then .

great !

no wonder you can con-
trol your voice so well
. you are a professional
singer .

i am not a singer . i would n’t mind a posi-
tion that would be great
.

i am a singer . i think
i can be a singer in the
lead .

i would n’t like to be a
singer but i love to sing
that dream .

when can i get high
speed internet installed
?

you can make a list of
the company and make
sure that you do n’t have
to use the machine .

you ’ll need to make an
appointment before the
company starts .

you can get up at the air-
port and you ’ll have to
make an appointment .

you ’ll have to make an
appointment before we
can come in and install
it .

i like those kinds of pro-
grammes too . they re
very informative . i
think that many people
underrate the education
value of tv .

i agree . people often
criticize tv for showing
too much sex and vio-
lence .

i agree . people often
criticize tv for showing
too much sex and vio-
lence .

i think that teenagers
should be often become
addicted and violence .

i agree . people often
criticize tv for showing
too much sex and vio-
lence .

can you tell that i m ex-
cited ?

i m afraid i m not a child
.

i m a fashion designer
. next month i have a
fashion show .

i m not sure . what do
you want to know ?

i m sure that i ll cook the
same for you .

would you like to have a
shampoo sir ?

yes i ’d like a glass of
iced tea .

no thank you . no i ’d rather have it
with me .

yes with the lux dan-
druff shampoo . it helps
a lot to get rid of my
dandruff .

what else would i pre-
pare sir ?

you can bring your beef
with your chicken and a
bottle of wine .

oh good ! can you
make some recommen-
dation for me ?

well the interviewers
are not interested in the
position .

let me see . everything
looks fine .

he always says i am a
hard worker with con-
sciousness of responsi-
bility sufficient educa-
tion and enough experi-
ence .

i think that maybe you
are right .

what s the matter with
you ?

how many years of ex-
perience will you earn ?

would you like to work
in the finance depart-
ment ?

what made you think
that ?

i like it a lot . i love that shirt on you . i think it ’s great . i think
i ve learned a lot from
different countries .

i will care for it .

i can tell you what bus
to catch but you have to
walk a little bit .

i do n’t know . tell me how to get a
ticket and a student bus
station .

i ’m sorry but i do n’t
have to wait .

you ’re going to have a
car .

Table 10: Responses to randomly selected test inputs which we made sure were not in the training data (DailyDia-
log). Unfiltered is the model trained on unfiltered data, and IDENTITY TARGET is the model trained on IDENTITY,
TARGET filtered data. Overfitted means that the respective model is evaluated at an overfitted point.


