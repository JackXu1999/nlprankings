



















































Unpaired Sentiment-to-Sentiment Translation: A Cycled Reinforcement Learning Approach


Proceedings of the 56th Annual Meeting of the Association for Computational Linguistics (Long Papers), pages 979–988
Melbourne, Australia, July 15 - 20, 2018. c©2018 Association for Computational Linguistics

979

Unpaired Sentiment-to-Sentiment Translation: A Cycled
Reinforcement Learning Approach

Jingjing Xu1∗, Xu Sun1∗, Qi Zeng1, Xuancheng Ren1,
Xiaodong Zhang1, Houfeng Wang1, Wenjie Li2

1MOE Key Lab of Computational Linguistics, School of EECS, Peking University
2Department of Computing, Hong Kong Polytechnic University

{jingjingxu,xusun,pkuzengqi,renxc,zxdcs,wanghf}@pku.edu.cn
cswjli@comp.polyu.edu.hk

Abstract

The goal of sentiment-to-sentiment “trans-
lation” is to change the underlying senti-
ment of a sentence while keeping its con-
tent. The main challenge is the lack of
parallel data. To solve this problem, we
propose a cycled reinforcement learning
method that enables training on unpaired
data by collaboration between a neutral-
ization module and an emotionalization
module. We evaluate our approach on two
review datasets, Yelp and Amazon. Exper-
imental results show that our approach sig-
nificantly outperforms the state-of-the-art
systems. Especially, the proposed method
substantially improves the content preser-
vation performance. The BLEU score is
improved from 1.64 to 22.46 and from
0.56 to 14.06 on the two datasets, respec-
tively.1

1 Introduction

Sentiment-to-sentiment “translation” requires the
system to change the underlying sentiment of a
sentence while preserving its non-emotional se-
mantic content as much as possible. It can be re-
garded as a special style transfer task that is impor-
tant in Natural Language Processing (NLP) (Hu
et al., 2017; Shen et al., 2017; Fu et al., 2018).
It has broad applications, including review senti-
ment transformation, news rewriting, etc. Yet the
lack of parallel training data poses a great obstacle
to a satisfactory performance.

Recently, several related studies for language
style transfer (Hu et al., 2017; Shen et al., 2017)
have been proposed. However, when applied

∗Equal Contribution.
1The released code can be found in

https://github.com/lancopku/unpaired-sentiment-translation

to the sentiment-to-sentiment “translation” task,
most existing studies only change the underlying
sentiment and fail in keeping the semantic con-
tent. For example, given “The food is delicious”
as the source input, the model generates “What a
bad movie” as the output. Although the sentiment
is successfully transformed from positive to neg-
ative, the output text focuses on a different topic.
The reason is that these methods attempt to im-
plicitly separate the emotional information from
the semantic information in the same dense hidden
vector, where all information is mixed together in
an uninterpretable way. Due to the lack of super-
vised parallel data, it is hard to only modify the
underlying sentiment without any loss of the non-
emotional semantic information.

To tackle the problem of lacking parallel data,
we propose a cycled reinforcement learning ap-
proach that contains two parts: a neutralization
module and an emotionalization module. The
neutralization module is responsible for extracting
non-emotional semantic information by explicitly
filtering out emotional words. The advantage is
that only emotional words are removed, which
does not affect the preservation of non-emotional
words. The emotionalization module is responsi-
ble for adding sentiment to the neutralized seman-
tic content for sentiment-to-sentiment translation.

In cycled training, given an emotional sentence
with sentiment s, we first neutralize it to the non-
emotional semantic content, and then force the
emotionalization module to reconstruct the origi-
nal sentence by adding the sentiment s. Therefore,
the emotionalization module is taught to add senti-
ment to the semantic context in a supervised way.
By adding opposite sentiment, we can achieve the
goal of sentiment-to-sentiment translation. Be-
cause of the discrete choice of neutral words, the
gradient is no longer differentiable over the neu-
tralization module. Thus, we use policy gradient,



980

one of the reinforcement learning methods, to re-
ward the output of the neutralization module based
on the feedback from the emotionalization mod-
ule. We add different sentiment to the semantic
content and use the quality of the generated text
as reward. The quality is evaluated by two useful
metrics: one for identifying whether the generated
text matches the target sentiment; one for evalu-
ating the content preservation performance. The
reward guides the neutralization module to better
identify non-emotional words. In return, the im-
proved neutralization module further enhances the
emotionalization module.

Our contributions are concluded as follows:

• For sentiment-to-sentiment translation, we
propose a cycled reinforcement learning ap-
proach. It enables training with unpaired
data, in which only reviews and sentiment la-
bels are available.

• Our approach tackles the bottleneck of keep-
ing semantic information by explicitly sepa-
rating sentiment information from semantic
content.

• Experimental results show that our approach
significantly outperforms the state-of-the-art
systems, especially in content preservation.

2 Related Work

Style transfer in computer vision has been stud-
ied (Johnson et al., 2016; Gatys et al., 2016; Liao
et al., 2017; Li et al., 2017; Zhu et al., 2017). The
main idea is to learn the mapping between two im-
age domains by capturing shared representations
or correspondences of higher-level structures.

There have been some studies on unpaired lan-
guage style transfer recently. Hu et al. (2017) pro-
pose a new neural generative model that combines
variational auto-encoders (VAEs) and holistic at-
tribute discriminators for effective imposition of
style semantic structures. Fu et al. (2018) pro-
pose to use an adversarial network to make sure
that the input content does not have style informa-
tion. Shen et al. (2017) focus on separating the
underlying content from style information. They
learn an encoder that maps the original sentence
to style-independent content and a style-dependent
decoder for rendering. However, their evalua-
tions only consider the transferred style accuracy.
We argue that content preservation is also an in-
dispensable evaluation metric. However, when

applied to the sentiment-to-sentiment translation
task, the previously mentioned models share the
same problem. They have the poor preservation of
non-emotional semantic content.

In this paper, we propose a cycled reinforce-
ment learning method to improve sentiment-to-
sentiment translation in the absence of parallel
data. The key idea is to build supervised train-
ing pairs by reconstructing the original sentence.
A related study is “back reconstruction” in ma-
chine translation (He et al., 2016; Tu et al., 2017).
They couple two inverse tasks: one is for trans-
lating a sentence in language A to a sentence in
language B; the other is for translating a sentence
in language B to a sentence in language A. Dif-
ferent from the previous work, we do not intro-
duce the inverse task, but use collaboration be-
tween the neutralization module and the emotion-
alization module.

Sentiment analysis is also related to our
work (Socher et al., 2011; Pontiki et al., 2015;
Rosenthal et al., 2017; Chen et al., 2017; Ma et al.,
2017, 2018b). The task usually involves detecting
whether a piece of text expresses positive, nega-
tive, or neutral sentiment. The sentiment can be
general or about a specific topic.

3 Cycled Reinforcement Learning for
Unpaired Sentiment-to-Sentiment
Translation

In this section, we introduce our proposed method.
An overview is presented in Section 3.1. The de-
tails of the neutralization module and the emo-
tionalization module are shown in Section 3.2 and
Section 3.3. The cycled reinforcement learning
mechanism is introduced in Section 3.4.

3.1 Overview

The proposed approach contains two modules:
a neutralization module and an emotionalization
module, as shown in Figure 1. The neutraliza-
tion module first extracts non-emotional seman-
tic content, and then the emotionalization module
attaches sentiment to the semantic content. Two
modules are trained by the proposed cycled rein-
forcement learning method. The proposed method
requires the two modules to have initial learning
ability. Therefore, we propose a novel pre-training
method, which uses a self-attention based senti-
ment classifier (SASC). A sketch of cycled rein-
forcement learning is shown in Algorithm 1. The



981

Neutralization Module

Emotionalization Module

The food is very *

The food is very delicious

Classifier

Negative

terrible andis tastelessThe food

very deliciousisThe food

Positive

Figure 1: An illustration of the two modules.
Lower: The neutralization module removes emo-
tional words and extracts non-emotional semantic
information. Upper: The emotionalization mod-
ule adds sentiment to the semantic content. The
proposed self-attention based sentiment classifier
is used to guide the pre-training.

details are introduced as follows.

3.2 Neutralization Module

The neutralization module Nθ is used for explic-
itly filtering out emotional information. In this
paper, we consider this process as an extraction
problem. The neutralization module first identifies
non-emotional words and then feeds them into the
emotionalization module. We use a single Long-
short Term Memory Network (LSTM) to generate
the probability of being neutral or being polar for
every word in a sentence. Given an emotional in-
put sequence x = (x1, x2, . . . , xT ) of T words
from Γ, the vocabulary of words, this module is
responsible for producing a neutralized sequence.

Since cycled reinforcement learning requires
the modules with initial learning ability, we pro-
pose a novel pre-training method to teach the
neutralization module to identify non-emotional
words. We construct a self-attention based sen-
timent classifier and use the learned attention
weight as the supervisory signal. The motivation
comes from the fact that, in a well-trained senti-
ment classification model, the attention weight re-
flects the sentiment contribution of each word to

Algorithm 1 The cycled reinforcement learning
method for training the neutralization module Nθ
and the emotionalization module Eφ.
1: Initialize the neutralization module Nθ , the emotional-

ization module Eφ with random weights θ, φ
2: Pre-train Nθ using MLE based on Eq. 6
3: Pre-train Eφ using MLE based on Eq. 7
4: for each iteration i = 1, 2, ...,M do
5: Sample a sequence x with sentiment s from X
6: Generate a neutralized sequence x̂ based on Nθ
7: Given x̂ and s, generate an output based on Eφ
8: Compute the gradient of Eφ based on Eq. 8
9: Compute the reward R1 based on Eq. 11

10: s̄ = the opposite sentiment
11: Given x̂ and s̄, generate an output based on Eφ
12: Compute the reward R2 based on Eq. 11
13: Compute the combined reward Rc based on Eq. 10
14: Compute the gradient of Nθ based on Eq. 9
15: Update model parameters θ, φ
16: end for

some extent. Emotional words tend to get higher
attention weights while neutral words usually get
lower weights. The details of sentiment classifier
are described as follows.

Given an input sequence x, a sentiment label y
is produced as

y = softmax(W · c) (1)

where W is a parameter. The term c is computed
as a weighted sum of hidden vectors:

c =
T∑
i=0

αihi (2)

where αi is the weight of hi. The term hi is the
output of LSTM at the i-th word. The term αi is
computed as

αi =
exp(ei)∑T
i=0 exp(ei)

(3)

where ei = f(hi,hT ) is an alignment model. We
consider the last hidden state hT as the context
vector, which contains all information of an input
sequence. The term ei evaluates the contribution
of each word for sentiment classification.

Our experimental results show that the proposed
sentiment classifier achieves the accuracy of 89%
and 90% on two datasets. With high classifica-
tion accuracy, the attention weight produced by
the classifier is considered to adequately capture
the sentiment information of each word.

To extract non-emotional words based on con-
tinuous attention weights, we map attention



982

weights to discrete values, 0 and 1. Since the dis-
crete method is not the key part is this paper, we
only use the following method for simplification.

We first calculate the averaged attention value
in a sentence as

ᾱ =
1

T

T∑
i=0

αi (4)

where ᾱ is used as the threshold to distinguish
non-emotional words from emotional words. The
discrete attention weight is calculated as

α̂i =

{
1, if αi ≤ ᾱ
0, if αi > ᾱ

(5)

where α̂i is treated as the identifier.
For pre-training the neutralization module, we

build the training pair of input text x and a discrete
attention weight sequence α̂. The cross entropy
loss is computed as

Lθ = −
T∑
i=1

PNθ(α̂i|xi) (6)

3.3 Emotionalization Module
The emotionalization module Eφ is responsible
for adding sentiment to the neutralized semantic
content. In our work, we use a bi-decoder based
encoder-decoder framework, which contains one
encoder and two decoders. One decoder adds the
positive sentiment and the other adds the negative
sentiment. The input sentiment signal determines
which decoder to use. Specifically, we use the
seq2seq model (Sutskever et al., 2014) for im-
plementation. Both the encoder and decoder are
LSTM networks. The encoder learns to compress
the semantic content into a dense vector. The de-
coder learns to add sentiment based on the dense
vector. Given the neutralized semantic content and
the target sentiment, this module is responsible for
producing an emotional sequence.

For pre-training the emotionalization module,
we first generate a neutralized input sequence x̂ by
removing emotional words identified by the pro-
posed sentiment classifier. Given the training pair
of a neutralized sequence x̂ and an original sen-
tence x with sentiment s, the cross entropy loss is
computed as

Lφ = −
T∑
i=1

PEφ(xi|x̂i, s) (7)

where a positive example goes through the posi-
tive decoder and a negative example goes through
the negative decoder.

We also explore a simpler method for pre-
training the emotionalization module, which uses
the product between a continuous vector 1 − α
and a word embedding sequence as the neutralized
content where α represents an attention weight
sequence. Experimental results show that this
method achieves much lower results than explic-
itly removing emotional words based on discrete
attention weights. Thus, we do not choose this
method in our work.

3.4 Cycled Reinforcement Learning
Two modules are trained by the proposed cycled
method. The neutralization module first neutral-
izes an emotional input to semantic content and
then the emotionalization module is forced to re-
construct the original sentence based on the source
sentiment and the semantic content. Therefore,
the emotionalization module is taught to add senti-
ment to the semantic content in a supervised way.
Because of the discrete choice of neutral words,
the loss is no longer differentiable over the neu-
tralization module. Therefore, we formulate it as
a reinforcement learning problem and use policy
gradient to train the neutralization module. The
detailed training process is shown as follows.

We refer the neutralization module Nθ as the
first agent and the emotionalization module Eφ as
the second one. Given a sentence x associated
with sentiment s, the term x̂ represents the mid-
dle neutralized context extracted by α̂, which is
generated by PNθ(α̂|x).

In cycled training, the original sentence can be
viewed as the supervision for training the second
agent. Thus, the gradient for the second agent is

∇φJ(φ) = ∇φ log(PEφ(x|x̂, s)) (8)

We denote x̄ as the output generated by
PEφ(x̄|x̂, s). We also denote y as the output gen-
erated by PEφ(y|x̂, s̄) where s̄ represents the op-
posite sentiment. Given x̄ and y, we first calcu-
late rewards for training the neutralized module,
R1 and R2. The details of calculation process will
be introduced in Section 3.4.1. Then, we optimize
parameters through policy gradient by maximiz-
ing the expected reward to train the neutralization
module. It guides the neutralization module to
identify non-emotional words better. In return, the



983

improved neutralization module further enhances
the emotionalization module.

According to the policy gradient theo-
rem (Williams, 1992), the gradient for the first
agent is

∇θJ(θ) = E[Rc · ∇θ log(PNθ(α̂|x))] (9)

where Rc is calculated as

Rc = R1 +R2 (10)

Based on Eq. 8 and Eq. 9, we use the sampling
approach to estimate the expected reward. This
cycled process is repeated until converge.

3.4.1 Reward
The reward consists of two parts, sentiment con-
fidence and BLEU. Sentiment confidence evalu-
ates whether the generated text matches the target
sentiment. We use a pre-trained classifier to make
the judgment. Specially, we use the proposed self-
attention based sentiment classifier for implemen-
tation. The BLEU (Papineni et al., 2002) score
is used to measure the content preservation per-
formance. Considering that the reward should en-
courage the model to improve both metrics, we use
the harmonic mean of sentiment confidence and
BLEU as reward, which is formulated as

R = (1 + β2)
2 ·BLEU · Confid

(β2 ·BLEU) + Confid
(11)

where β is a harmonic weight.

4 Experiment

In this section, we evaluate our method on two re-
view datasets. We first introduce the datasets, the
training details, the baselines, and the evaluation
metrics. Then, we compare our approach with the
state-of-the-art systems. Finally, we show the ex-
perimental results and provide the detailed analy-
sis of the key components.

4.1 Unpaired Datasets
We conduct experiments on two review datasets
that contain user ratings associated with each re-
view. Following previous work (Shen et al., 2017),
we consider reviews with rating above three as
positive reviews and reviews below three as neg-
ative reviews. The positive and negative reviews
are not paired. Since our approach focuses on
sentence-level sentiment-to-sentiment translation

where sentiment annotations are provided at the
document level, we process the two datasets with
the following steps. First, following previous
work (Shen et al., 2017), we filter out the reviews
that exceed 20 words. Second, we construct text-
sentiment pairs by extracting the first sentence in
a review associated with its sentiment label, be-
cause the first sentence usually expresses the core
idea. Finally, we train a sentiment classifier and
filter out the text-sentiment pairs with the classi-
fier confidence below 0.8. Specially, we use the
proposed self-attention based sentiment classifier
for implementation. The details of the processed
datasets are introduced as follows.

Yelp Review Dataset (Yelp): This dataset is
provided by Yelp Dataset Challenge.2 The pro-
cessed Yelp dataset contains 400K, 10K, and 3K
pairs for training, validation, and testing, respec-
tively.

Amazon Food Review Dataset (Amazon):
This dataset is provided by McAuley and
Leskovec (2013). It consists of amounts of food
reviews from Amazon.3 The processed Ama-
zon dataset contains 230K, 10K, and 3K pairs for
training, validation, and testing, respectively.

4.2 Training Details

We tune hyper-parameters based on the perfor-
mance on the validation sets. The self-attention
based sentiment classifier is trained for 10 epochs
on two datasets. We set β for calculating reward
to 0.5, hidden size to 256, embedding size to 128,
vocabulary size to 50K, learning rate to 0.6, and
batch size to 64. We use the Adagrad (Duchi et al.,
2011) optimizer. All of the gradients are clipped
when the norm exceeds 2. Before cycled train-
ing, the neutralization module and the emotional-
ization module are pre-trained for 1 and 4 epochs
on the yelp dataset, for 3 and 5 epochs on the Ama-
zon dataset.

4.3 Baselines

We compare our proposed method with the follow-
ing state-of-the-art systems.

Cross-Alignment Auto-Encoder (CAAE):
This method is proposed by Shen et al. (2017).
They propose a method that uses refined align-
ment of latent representations in hidden layers to

2https://www.yelp.com/dataset/
challenge

3http://amazon.com

https://www.yelp.com/dataset/challenge
https://www.yelp.com/dataset/challenge
http://amazon.com


984

perform style transfer. We treat this model as a
baseline and adapt it by using the released code.

Multi-Decoder with Adversarial Learning
(MDAL): This method is proposed by Fu et al.
(2018). They use a multi-decoder model with ad-
versarial learning to separate style representations
and content representations in hidden layers. We
adapt this model by using the released code.

4.4 Evaluation Metrics

We conduct two evaluations in this work, includ-
ing an automatic evaluation and a human evalua-
tion. The details of evaluation metrics are shown
as follows.

4.4.1 Automatic Evaluation
We quantitatively measure sentiment transforma-
tion by evaluating the accuracy of generating des-
ignated sentiment. For a fair comparison, we
do not use the proposed sentiment classification
model. Following previous work (Shen et al.,
2017; Hu et al., 2017), we instead use a state-
of-the-art sentiment classifier (Vieira and Moura,
2017), called TextCNN, to automatically evalu-
ate the transferred sentiment accuracy. TextCNN
achieves the accuracy of 89% and 88% on two
datasets. Specifically, we generate sentences given
sentiment s, and use the pre-trained sentiment
classifier to assign sentiment labels to the gener-
ated sentences. The accuracy is calculated as the
percentage of the predictions that match the senti-
ment s.

To evaluate the content preservation perfor-
mance, we use the BLEU score (Papineni et al.,
2002) between the transferred sentence and the
source sentence as an evaluation metric. BLEU
is a widely used metric for text generation tasks,
such as machine translation, summarization, etc.
The metric compares the automatically produced
text with the reference text by computing overlap-
ping lexical n-gram units.

To evaluate the overall performance, we use the
geometric mean of ACC and BLEU as an evalua-
tion metric. The G-score is one of the most com-
monly used “single number” measures in Informa-
tion Retrieval, Natural Language Processing, and
Machine Learning.

4.4.2 Human Evaluation
While the quantitative evaluation provides indi-
cation of sentiment transfer quality, it can not
evaluate the quality of transferred text accurately.

Yelp ACC BLEU G-score
CAAE (Shen et al., 2017) 93.22 1.17 10.44
MDAL (Fu et al., 2018) 85.65 1.64 11.85
Proposed Method 80.00 22.46 42.38
Amazon ACC BLEU G-score
CAAE (Shen et al., 2017) 84.19 0.56 6.87
MDAL (Fu et al., 2018) 70.50 0.27 4.36
Proposed Method 70.37 14.06 31.45

Table 1: Automatic evaluations of the proposed
method and baselines. ACC evaluates sentiment
transformation. BLEU evaluates content preserva-
tion. G-score is the geometric mean of ACC and
BLEU.

Therefore, we also perform a human evaluation on
the test set. We randomly choose 200 items for the
human evaluation. Each item contains the trans-
formed sentences generated by different systems
given the same source sentence. The items are
distributed to annotators who have no knowledge
about which system the sentence is from. They
are asked to score the transformed text in terms of
sentiment and semantic similarity. Sentiment rep-
resents whether the sentiment of the source text
is transferred correctly. Semantic similarity eval-
uates the context preservation performance. The
score ranges from 1 to 10 (1 is very bad and 10 is
very good).

4.5 Experimental Results

Automatic evaluation results are shown in Table 1.
ACC evaluates sentiment transformation. BLEU
evaluates semantic content preservation. G-score
represents the geometric mean of ACC and BLEU.
CAAE and MDAL achieve much lower BLEU
scores, 1.17 and 1.64 on the Yelp dataset, 0.56
and 0.27 on the Amazon dataset. The low BLEU
scores indicate the worrying content preservation
performance to some extent. Even with the desired
sentiment, the irrelevant generated text leads to
worse overall performance. In general, these two
systems work more like sentiment-aware language
models that generate text only based on the target
sentiment and neglect the source input. The main
reason is that these two systems attempt to sep-
arate emotional information from non-emotional
content in a hidden layer, where all information
is complicatedly mixed together. It is difficult to
only modify emotional information without any
loss of non-emotional semantic content.

In comparison, our proposed method achieves
the best overall performance on the two datasets,



985

Yelp Sentiment Semantic G-score
CAAE (Shen et al., 2017) 7.67 3.87 5.45
MDAL (Fu et al., 2018) 7.12 3.68 5.12
Proposed Method 6.99 5.08 5.96
Amazon Sentiment Semantic G-score
CAAE (Shen et al., 2017) 8.61 3.15 5.21
MDAL (Fu et al., 2018) 7.93 3.22 5.05
Proposed Method 7.92 4.67 6.08

Table 2: Human evaluations of the proposed
method and baselines. Sentiment evaluates senti-
ment transformation. Semantic evaluates content
preservation.

demonstrating the ability of learning knowledge
from unpaired data. This result is attributed to
the improved BLEU score. The BLEU score is
largely improved from 1.64 to 22.46 and from 0.56
to 14.06 on the two datasets. The score improve-
ments mainly come from the fact that we separate
emotional information from semantic content by
explicitly filtering out emotional words. The ex-
tracted content is preserved and fed into the emo-
tionalization module. Given the overall quality of
transferred text as the reward, the neutralization
module is taught to extract non-emotional seman-
tic content better.

Table 2 shows the human evaluation results. It
can be clearly seen that the proposed method ob-
viously improves semantic preservation. The se-
mantic score is increased from 3.87 to 5.08 on the
Yelp dataset, and from 3.22 to 4.67 on the Amazon
dataset. In general, our proposed model achieves
the best overall performance. Furthermore, it also
needs to be noticed that with the large improve-
ment in content preservation, the sentiment accu-
racy of the proposed method is lower than that of
CAAE on the two datasets. It shows that simulta-
neously promoting sentiment transformation and
content preservation remains to be studied further.

By comparing two evaluation results, we find
that there is an agreement between the human
evaluation and the automatic evaluation. It indi-
cates the usefulness of automatic evaluation met-
rics. However, we also notice that the human eval-
uation has a smaller performance gap between the
baselines and the proposed method than the auto-
matic evaluation. It shows the limitation of auto-
matic metrics for giving accurate results. For eval-
uating sentiment transformation, even with a high
accuracy, the sentiment classifier sometimes gen-
erates noisy results, especially for those neutral
sentences (e.g., “I ate a cheese sandwich”). For
evaluating content preservation, the BLEU score

Input: I would strongly advise against using this com-
pany.
CAAE: I love this place for a great experience here.
MDAL: I have been a great place was great.
Proposed Method: I would love using this company.
Input: The service was nearly non-existent and ex-
tremely rude.
CAAE: The best place in the best area in vegas.
MDAL: The food is very friendly and very good.
Proposed Method: The service was served and com-
pletely fresh.
Input: Asked for the roast beef and mushroom sub,
only received roast beef.
CAAE: We had a great experience with.
MDAL: This place for a great place for a great food
and best.
Proposed Method: Thanks for the beef and spring
bbq.
Input: Worst cleaning job ever!
CAAE: Great food and great service!
MDAL: Great food, food!
Proposed Method: Excellent outstanding job ever!
Input: Most boring show I’ve ever been.
CAAE: Great place is the best place in town.
MDAL: Great place I’ve ever ever had.
Proposed Method: Most amazing show I’ve ever
been.
Input: Place is very clean and the food is delicious.
CAAE: Don’t go to this place.
MDAL: This place wasn’t worth the worst place is hor-
rible.
Proposed Method: Place is very small and the food is
terrible.
Input: Really satisfied with experience buying clothes.
CAAE: Don’t go to this place.
MDAL: Do not impressed with this place.
Proposed Method: Really bad experience.

Table 3: Examples generated by the proposed ap-
proach and baselines on the Yelp dataset. The two
baselines change not only the polarity of exam-
ples, but also the semantic content. In comparison,
our approach changes the sentiment of sentences
with higher semantic similarity.

is computed based on the percentage of overlap-
ping n-grams between the generated text and the
reference text. However, the overlapping n-grams
contain not only content words but also function
words, bringing the noisy results. In general, ac-
curate automatic evaluation metrics are expected
in future work.

Table 3 presents the examples generated by
different systems on the Yelp dataset. The two
baselines change not only the polarity of exam-
ples, but also the semantic content. In compari-
son, our method precisely changes the sentiment
of sentences (and paraphrases slightly to ensure
fluency), while keeping the semantic content un-
changed.



986

Yelp ACC BLEU G-score
Emotionalization Module 41.84 25.66 32.77
+ NM + Cycled RL 85.71 1.08 9.62
+ NM + Pre-training 70.61 17.02 34.66
+ NM + Cycled RL + Pre-training 80.00 22.46 42.38
Amazon ACC BLEU G-score
Emotionalization Module 57.28 12.22 26.46
+ NM + Cycled RL 64.16 8.03 22.69
+ NM + Pre-training 69.61 11.16 27.87
+ NM + Cycled RL + Pre-training 70.37 14.06 31.45

Table 4: Performance of key components in the
proposed approach. “NM” denotes the neutraliza-
tion module. “Cycled RL” represents cycled rein-
forcement learning.

4.6 Incremental Analysis

In this section, we conduct a series of experiments
to evaluate the contributions of our key compo-
nents. The results are shown in Table 4.

We treat the emotionalization module as a base-
line where the input is the original emotional sen-
tence. The emotionalization module achieves the
highest BLEU score but with much lower senti-
ment transformation accuracy. The encoding of
the original sentiment leads to the emotional hid-
den vector that influences the decoding process
and results in worse sentiment transformation per-
formance.

It can be seen that the method with all compo-
nents achieves the best performance. First, we find
that the method that only uses cycled reinforce-
ment learning performs badly because it is hard to
guide two randomly initialized modules to teach
each other. Second, the pre-training method brings
a slight improvement in overall performance. The
G-score is improved from 32.77 to 34.66 and from
26.46 to 27.87 on the two datasets. The bottle-
neck of this method is the noisy attention weight
because of the limited sentiment classification ac-
curacy. Third, the method that combines cycled
reinforcement learning and pre-training achieves
the better performance than using one of them.
Pre-training gives the two modules initial learning
ability. Cycled training teaches the two modules to
improve each other based on the feedback signals.
Specially, the G-score is improved from 34.66 to
42.38 and from 27.87 to 31.45 on the two datasets.
Finally, by comparing the methods with and with-
out the neutralization module, we find that the neu-
tralization mechanism improves a lot in sentiment
transformation with a slight reduction on content
preservation. It proves the effectiveness of explic-

Michael is absolutely wonderful.
I would strongly advise against using this company.

Horrible experience!
Worst cleaning job ever!
Most boring show i ’ve ever been.
Hainan chicken was really good.
I really don’t understand all the negative reviews for this
dentist.
Smells so weird in there.
The service was nearly non-existent and extremely rude.

Table 5: Analysis of the neutralization module.
Words in red are removed by the neutralization
module.

itly separating sentiment information from seman-
tic content.

Furthermore, to analyze the neutralization abil-
ity in the proposed method, we randomly sample
several examples, as shown in Table 5. It can be
clearly seen that emotional words are removed ac-
curately almost without loss of non-emotional in-
formation.

4.7 Error Analysis

Although the proposed method outperforms the
state-of-the-art systems, we also observe sev-
eral failure cases, such as sentiment-conflicted
sentences (e.g., “Outstanding and bad service”),
neutral sentences (e.g., “Our first time here”).
Sentiment-conflicted sentences indicate that the
original sentiment is not removed completely.
This problem occurs when the input contains emo-
tional words that are unseen in the training data,
or the sentiment is implicitly expressed. Han-
dling complex sentiment expressions is an impor-
tant problem for future work. Neutral sentences
demonstrate that the decoder sometimes fails in
adding the target sentiment and only generates text
based on the semantic content. A better sentiment-
aware decoder is expected to be explored in future
work.

5 Conclusions and Future Work

In this paper, we focus on unpaired sentiment-
to-sentiment translation and propose a cycled re-
inforcement learning approach that enables train-
ing in the absence of parallel training data. We
conduct experiments on two review datasets. Ex-
perimental results show that our method substan-
tially outperforms the state-of-the-art systems, es-
pecially in terms of semantic preservation. For fu-
ture work, we would like to explore a fine-grained
version of sentiment-to-sentiment translation that



987

not only reverses sentiment, but also changes the
strength of sentiment.

Acknowledgements

This work was supported in part by National Natu-
ral Science Foundation of China (No. 61673028),
National High Technology Research and Devel-
opment Program of China (863 Program, No.
2015AA015404), and the National Thousand
Young Talents Program. Xu Sun is the corre-
sponding author of this paper.

References
Tao Chen, Ruifeng Xu, Yulan He, and Xuan Wang.

2017. Improving sentiment analysis via sentence
type classification using bilstm-crf and CNN. Ex-
pert Syst. Appl., 72:221–230.

Li Dong, Shaohan Huang, Furu Wei, Mirella Lapata,
Ming Zhou, and Ke Xu. 2017. Learning to generate
product reviews from attributes. In Proceedings of
the 15th Conference of the European Chapter of the
Association for Computational Linguistics: Volume
1, Long Papers, volume 1, pages 623–632.

John C. Duchi, Elad Hazan, and Yoram Singer. 2011.
Adaptive subgradient methods for online learning
and stochastic optimization. Journal of Machine
Learning Research, 12:2121–2159.

Zhenxin Fu, Xiaoye Tan, Nanyun Peng, Dongyan
Zhao, and Rui Yan. 2018. Style transfer in text: Ex-
ploration and evaluation. In AAAI 2018.

Leon A. Gatys, Alexander S. Ecker, and Matthias
Bethge. 2016. Image style transfer using convolu-
tional neural networks. In 2016 IEEE Conference
on Computer Vision and Pattern Recognition, CVPR
2016, Las Vegas, NV, USA, June 27-30, 2016, pages
2414–2423.

Di He, Yingce Xia, Tao Qin, Liwei Wang, Nenghai
Yu, Tie-Yan Liu, and Wei-Ying Ma. 2016. Dual
learning for machine translation. In Advances in
Neural Information Processing Systems 29: Annual
Conference on Neural Information Processing Sys-
tems 2016, December 5-10, 2016, Barcelona, Spain,
pages 820–828.

Zhiting Hu, Zichao Yang, Xiaodan Liang, Ruslan
Salakhutdinov, and Eric P. Xing. 2017. Controllable
text generation. In ICML 2017.

Justin Johnson, Alexandre Alahi, and Li Fei-Fei. 2016.
Perceptual losses for real-time style transfer and
super-resolution. In ECCV, 2016, pages 694–711.

Yanghao Li, Naiyan Wang, Jiaying Liu, and Xiaodi
Hou. 2017. Demystifying neural style transfer. In
Proceedings of the Twenty-Sixth International Joint

Conference on Artificial Intelligence, IJCAI 2017,
Melbourne, Australia, August 19-25, 2017, pages
2230–2236.

Jing Liao, Yuan Yao, Lu Yuan, Gang Hua, and
Sing Bing Kang. 2017. Visual attribute transfer
through deep image analogy. ACM Trans. Graph.,
36(4):120:1–120:15.

Junyang Lin, Shuming Ma, Qi Su, and Xu Sun.
2018. Decoding-history-based adaptive control of
attention for neural machine translation. CoRR,
abs/1802.01812.

Dehong Ma, Sujian Li, Xiaodong Zhang, Houfeng
Wang, and Xu Sun. 2017. Cascading multiway
attentions for document-level sentiment classifica-
tion. In Proceedings of the Eighth International
Joint Conference on Natural Language Processing,
IJCNLP 2017, Taipei, Taiwan, November 27 - De-
cember 1, 2017 - Volume 1: Long Papers, pages
634–643.

Shuming Ma, Xu Sun, Wei Li, Sujian Li, Wenjie
Li, and Xuancheng Ren. 2018a. Query and out-
put: Generating words by querying distributed word
representations for paraphrase generation. CoRR,
abs/1803.01465.

Shuming Ma, Xu Sun, Junyang Lin, and Xuancheng
Ren. 2018b. A hierarchical end-to-end model for
jointly improving text summarization and sentiment
classification. CoRR, abs/1805.01089.

Julian John McAuley and Jure Leskovec. 2013. From
amateurs to connoisseurs: modeling the evolution of
user expertise through online reviews. In 22nd In-
ternational World Wide Web Conference, WWW ’13,
Rio de Janeiro, Brazil, May 13-17, 2013, pages 897–
908.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic eval-
uation of machine translation. In Proceedings of the
40th Annual Meeting of the Association for Compu-
tational Linguistics, July 6-12, 2002, Philadelphia,
PA, USA., pages 311–318.

Maria Pontiki, Dimitris Galanis, Haris Papageorgiou,
Suresh Manandhar, and Ion Androutsopoulos. 2015.
Semeval-2015 task 12: Aspect based sentiment anal-
ysis. In Proceedings of the 9th International Work-
shop on Semantic Evaluation, SemEval@NAACL-
HLT 2015, Denver, Colorado, USA, June 4-5, 2015,
pages 486–495.

Sara Rosenthal, Noura Farra, and Preslav Nakov. 2017.
Semeval-2017 task 4: Sentiment analysis in twitter.
In Proceedings of the 11th International Workshop
on Semantic Evaluation, SemEval@ACL 2017, Van-
couver, Canada, August 3-4, 2017, pages 502–518.

Tianxiao Shen, Tao Lei, Regina Barzilay, and Tommi S.
Jaakkola. 2017. Style transfer from non-parallel text
by cross-alignment. In NIPS 2017.



988

Richard Socher, Cliff Chiung-Yu Lin, Andrew Y. Ng,
and Christopher D. Manning. 2011. Parsing natu-
ral scenes and natural language with recursive neu-
ral networks. In Proceedings of the 28th Inter-
national Conference on Machine Learning, ICML
2011, Bellevue, Washington, USA, June 28 - July 2,
2011, pages 129–136.

Ilya Sutskever, Oriol Vinyals, and Quoc V. Le. 2014.
Sequence to sequence learning with neural net-
works. In Advances in Neural Information Process-
ing Systems 27: Annual Conference on Neural In-
formation Processing Systems 2014, December 8-
13 2014, Montreal, Quebec, Canada, pages 3104–
3112.

Zhaopeng Tu, Yang Liu, Lifeng Shang, Xiaohua Liu,
and Hang Li. 2017. Neural machine translation with
reconstruction. In Proceedings of the Thirty-First
AAAI Conference on Artificial Intelligence, Febru-
ary 4-9, 2017, San Francisco, California, USA.,
pages 3097–3103.

Joao Paulo Albuquerque Vieira and Raimundo Santos
Moura. 2017. An analysis of convolutional neural
networks for sentence classification. In XLIII 2017,
pages 1–5.

Ronald J. Williams. 1992. Simple statistical gradient-
following algorithms for connectionist reinforce-
ment learning. Machine Learning, 8:229–256.

Jingjing Xu, Xu Sun, Xuancheng Ren, Junyang Lin,
Bingzhen Wei, and Wei Li. 2018. DP-GAN:
diversity-promoting generative adversarial network
for generating informative and diversified text.
CoRR, abs/1802.01345.

Hongyu Zang and Xiaojun Wan. 2017. Towards au-
tomatic generation of product reviews from aspect-
sentiment scores. In Proceedings of the 10th Inter-
national Conference on Natural Language Genera-
tion, pages 168–177.

Zhiyuan Zhang, Wei Li, and Xu Sun. 2018. Automatic
transferring between ancient chinese and contempo-
rary chinese. CoRR, abs/1803.01557.

Jun-Yan Zhu, Taesung Park, Phillip Isola, and
Alexei A. Efros. 2017. Unpaired image-to-image
translation using cycle-consistent adversarial net-
works. In IEEE International Conference on Com-
puter Vision, ICCV 2017, Venice, Italy, October 22-
29, 2017, pages 2242–2251.


