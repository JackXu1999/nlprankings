



















































Proceedings of the 55th Annual Meeting of the Association for Computational Linguistics


Proceedings of the 55th Annual Meeting of the Association for Computational Linguistics, pages 1657–1668
Vancouver, Canada, July 30 - August 4, 2017. c©2017 Association for Computational Linguistics

https://doi.org/10.18653/v1/P17-1152

Proceedings of the 55th Annual Meeting of the Association for Computational Linguistics, pages 1657–1668
Vancouver, Canada, July 30 - August 4, 2017. c©2017 Association for Computational Linguistics

https://doi.org/10.18653/v1/P17-1152

Enhanced LSTM for Natural Language Inference

Qian Chen
University of Science and

Technology of China
cq1231@mail.ustc.edu.cn

Xiaodan Zhu
National Research Council Canada

xiaodan.zhu@nrc-cnrc.gc.ca

Zhenhua Ling
University of Science and

Technology of China
zhling@ustc.edu.cn

Si Wei
iFLYTEK Research

siwei@iflytek.com

Hui Jiang
York University

hj@cse.yorku.ca

Diana Inkpen
University of Ottawa

diana@site.uottawa.ca

Abstract

Reasoning and inference are central to hu-
man and artificial intelligence. Modeling
inference in human language is very chal-
lenging. With the availability of large an-
notated data (Bowman et al., 2015), it has
recently become feasible to train neural
network based inference models, which
have shown to be very effective. In this
paper, we present a new state-of-the-art re-
sult, achieving the accuracy of 88.6% on
the Stanford Natural Language Inference
Dataset. Unlike the previous top models
that use very complicated network architec-
tures, we first demonstrate that carefully de-
signing sequential inference models based
on chain LSTMs can outperform all previ-
ous models. Based on this, we further show
that by explicitly considering recursive ar-
chitectures in both local inference model-
ing and inference composition, we achieve
additional improvement. Particularly, in-
corporating syntactic parsing information
contributes to our best result—it further im-
proves the performance even when added
to the already very strong model.

1 Introduction

Reasoning and inference are central to both human
and artificial intelligence. Modeling inference in
human language is notoriously challenging but is
a basic problem towards true natural language un-
derstanding, as pointed out by MacCartney and
Manning (2008), “a necessary (if not sufficient)

condition for true natural language understanding
is a mastery of open-domain natural language in-
ference.” The previous work has included extensive
research on recognizing textual entailment.

Specifically, natural language inference (NLI)
is concerned with determining whether a natural-
language hypothesis h can be inferred from a
premise p, as depicted in the following example
from MacCartney (2009), where the hypothesis is
regarded to be entailed from the premise.

p: Several airlines polled saw costs grow more than
expected, even after adjusting for inflation.

h: Some of the companies in the poll reported cost
increases.

The most recent years have seen advances in
modeling natural language inference. An impor-
tant contribution is the creation of a much larger
annotated dataset, the Stanford Natural Language
Inference (SNLI) dataset (Bowman et al., 2015).
The corpus has 570,000 human-written English
sentence pairs manually labeled by multiple human
subjects. This makes it feasible to train more com-
plex inference models. Neural network models,
which often need relatively large annotated data to
estimate their parameters, have shown to achieve
the state of the art on SNLI (Bowman et al., 2015,
2016; Munkhdalai and Yu, 2016b; Parikh et al.,
2016; Sha et al., 2016; Paria et al., 2016).

While some previous top-performing models use
rather complicated network architectures to achieve
the state-of-the-art results (Munkhdalai and Yu,
2016b), we demonstrate in this paper that enhanc-
ing sequential inference models based on chain

1657

https://doi.org/10.18653/v1/P17-1152
https://doi.org/10.18653/v1/P17-1152


models can outperform all previous results, sug-
gesting that the potentials of such sequential in-
ference approaches have not been fully exploited
yet. More specifically, we show that our sequential
inference model achieves an accuracy of 88.0% on
the SNLI benchmark.

Exploring syntax for NLI is very attractive to us.
In many problems, syntax and semantics interact
closely, including in semantic composition (Partee,
1995), among others. Complicated tasks such as
natural language inference could well involve both,
which has been discussed in the context of rec-
ognizing textual entailment (RTE) (Mehdad et al.,
2010; Ferrone and Zanzotto, 2014). In this pa-
per, we are interested in exploring this within the
neural network frameworks, with the presence of
relatively large training data. We show that by
explicitly encoding parsing information with re-
cursive networks in both local inference modeling
and inference composition and by incorporating
it into our framework, we achieve additional im-
provement, increasing the performance to a new
state of the art with an 88.6% accuracy.

2 Related Work

Early work on natural language inference has been
performed on rather small datasets with more con-
ventional methods (refer to MacCartney (2009)
for a good literature survey), which includes a
large bulk of work on recognizing textual entail-
ment, such as (Dagan et al., 2005; Iftene and
Balahur-Dobrescu, 2007), among others. More
recently, Bowman et al. (2015) made available the
SNLI dataset with 570,000 human annotated sen-
tence pairs. They also experimented with simple
classification models as well as simple neural net-
works that encode the premise and hypothesis in-
dependently. Rocktäschel et al. (2015) proposed
neural attention-based models for NLI, which cap-
tured the attention information. In general, atten-
tion based models have been shown to be effec-
tive in a wide range of tasks, including machine
translation (Bahdanau et al., 2014), speech recogni-
tion (Chorowski et al., 2015; Chan et al., 2016), im-
age caption (Xu et al., 2015), and text summariza-
tion (Rush et al., 2015; Chen et al., 2016), among
others. For NLI, the idea allows neural models to
pay attention to specific areas of the sentences.

A variety of more advanced networks have been
developed since then (Bowman et al., 2016; Ven-
drov et al., 2015; Mou et al., 2016; Liu et al., 2016;

Munkhdalai and Yu, 2016a; Rocktäschel et al.,
2015; Wang and Jiang, 2016; Cheng et al., 2016;
Parikh et al., 2016; Munkhdalai and Yu, 2016b;
Sha et al., 2016; Paria et al., 2016). Among them,
more relevant to ours are the approaches proposed
by Parikh et al. (2016) and Munkhdalai and Yu
(2016b), which are among the best performing mod-
els.

Parikh et al. (2016) propose a relatively sim-
ple but very effective decomposable model. The
model decomposes the NLI problem into subprob-
lems that can be solved separately. On the other
hand, Munkhdalai and Yu (2016b) propose much
more complicated networks that consider sequen-
tial LSTM-based encoding, recursive networks,
and complicated combinations of attention mod-
els, which provide about 0.5% gain over the results
reported by Parikh et al. (2016).

It is, however, not very clear if the potential of
the sequential inference networks has been well
exploited for NLI. In this paper, we first revisit this
problem and show that enhancing sequential infer-
ence models based on chain networks can actually
outperform all previous results. We further show
that explicitly considering recursive architectures
to encode syntactic parsing information for NLI
could further improve the performance.

3 Hybrid Neural Inference Models

We present here our natural language inference net-
works which are composed of the following major
components: input encoding, local inference mod-
eling, and inference composition. Figure 1 shows a
high-level view of the architecture. Vertically, the
figure depicts the three major components, and hor-
izontally, the left side of the figure represents our
sequential NLI model named ESIM, and the right
side represents networks that incorporate syntactic
parsing information in tree LSTMs.

In our notation, we have two sentences a =
(a1, . . . ,a`a) and b = (b1, . . . ,b`b), where a is a
premise and b a hypothesis. The ai or bj ∈ Rl is
an embedding of l-dimensional vector, which can
be initialized with some pre-trained word embed-
dings and organized with parse trees. The goal is to
predict a label y that indicates the logic relationship
between a and b.

3.1 Input Encoding

We employ bidirectional LSTM (BiLSTM) as one
of our basic building blocks for NLI. We first use it

1658



Figure 1: A high-level view of our hybrid neural
inference networks.

to encode the input premise and hypothesis (Equa-
tion (1) and (2)). Here BiLSTM learns to represent
a word (e.g., ai) and its context. Later we will also
use BiLSTM to perform inference composition to
construct the final prediction, where BiLSTM en-
codes local inference information and its interac-
tion. To bookkeep the notations for later use, we
write as āi the hidden (output) state generated by
the BiLSTM at time i over the input sequence a.
The same is applied to b̄j :

āi = BiLSTM(a, i),∀i ∈ [1, . . . , `a], (1)
b̄j = BiLSTM(b, j),∀j ∈ [1, . . . , `b]. (2)

Due to the space limit, we will skip the descrip-
tion of the basic chain LSTM and readers can refer
to Hochreiter and Schmidhuber (1997) for details.
Briefly, when modeling a sequence, an LSTM em-
ploys a set of soft gates together with a memory
cell to control message flows, resulting in an effec-
tive modeling of tracking long-distance informa-
tion/dependencies in a sequence.

A bidirectional LSTM runs a forward and back-
ward LSTM on a sequence starting from the left
and the right end, respectively. The hidden states

generated by these two LSTMs at each time step
are concatenated to represent that time step and
its context. Note that we used LSTM memory
blocks in our models. We examined other recurrent
memory blocks such as GRUs (Gated Recurrent
Units) (Cho et al., 2014) and they are inferior to
LSTMs on the heldout set for our NLI task.

As discussed above, it is intriguing to explore
the effectiveness of syntax for natural language
inference; for example, whether it is useful even
when incorporated into the best-performing models.
To this end, we will also encode syntactic parse
trees of a premise and hypothesis through tree-
LSTM (Zhu et al., 2015; Tai et al., 2015; Le and
Zuidema, 2015), which extends the chain LSTM to
a recursive network (Socher et al., 2011).

Specifically, given the parse of a premise or hy-
pothesis, a tree node is deployed with a tree-LSTM
memory block depicted as in Figure 2 and com-
puted with Equations (3–10). In short, at each node,
an input vector xt and the hidden vectors of its two
children (the left child hLt−1 and the right h

R
t−1) are

taken in as the input to calculate the current node’s
hidden vector ht.

ct

Cell

× ht×

fLt

Left Forget Gate

× fRt

Right Forget Gate

×

itInput Gate otOutput Gate

xt

hLt−1

hRt−1

xt hRt−1h
L
t−1

xt hRt−1h
L
t−1

xt h
R
t−1h

L
t−1xt h

R
t−1h

L
t−1 cLt−1 c

R
t−1

Figure 2: A tree-LSTM memory block.

We describe the updating of a node at a high level
with Equation (3) to facilitate references later in the
paper, and the detailed computation is described
in (4–10). Specifically, the input of a node is used
to configure four gates: the input gate it, output
gate ot, and the two forget gates fLt and f

R
t . The

memory cell ct considers each child’s cell vector,
cLt−1 and c

R
t−1, which are gated by the left forget

1659



gate fLt and right forget gate f
R
t , respectively.

ht = TrLSTM(xt,hLt−1,h
R
t−1), (3)

ht = ot � tanh(ct), (4)
ot = σ(Woxt + U

L
o h

L
t−1 + U

R
o h

R
t−1), (5)

ct = f
L
t � cLt−1 + fRt � cRt−1 + it � ut, (6)

fLt = σ(Wfxt + U
LL
f h

L
t−1 + U

LR
f h

R
t−1), (7)

fRt = σ(Wfxt + U
RL
f h

L
t−1 + U

RR
f h

R
t−1), (8)

it = σ(Wixt + U
L
i h

L
t−1 + U

R
i h

R
t−1), (9)

ut = tanh(Wcxt + U
L
c h

L
t−1 + U

R
c h

R
t−1), (10)

where σ is the sigmoid function, � is the element-
wise multiplication of two vectors, and all W ∈
Rd×l, U ∈ Rd×d are weight matrices to be learned.

In the current input encoding layer, xt is used to
encode a word embedding for a leaf node. Since
a non-leaf node does not correspond to a specific
word, we use a special vector x′t as its input, which
is like an unknown word. However, in the inference
composition layer that we discuss later, the goal
of using tree-LSTM is very different; the input xt
will be very different as well—it will encode local
inference information and will have values at all
tree nodes.

3.2 Local Inference Modeling

Modeling local subsentential inference between a
premise and hypothesis is the basic component for
determining the overall inference between these
two statements. To closely examine local infer-
ence, we explore both the sequential and syntactic
tree models that have been discussed above. The
former helps collect local inference for words and
their context, and the tree LSTM helps collect lo-
cal information between (linguistic) phrases and
clauses.

Locality of inference Modeling local inference
needs to employ some forms of hard or soft align-
ment to associate the relevant subcomponents be-
tween a premise and a hypothesis. This includes
early methods motivated from the alignment in
conventional automatic machine translation (Mac-
Cartney, 2009). In neural network models, this is
often achieved with soft attention.

Parikh et al. (2016) decomposed this process:
the word sequence of the premise (or hypothesis)
is regarded as a bag-of-word embedding vector
and inter-sentence “alignment” (or attention) is
computed individually to softly align each word

to the content of hypothesis (or premise, respec-
tively). While their basic framework is very effec-
tive, achieving one of the previous best results, us-
ing a pre-trained word embedding by itself does not
automatically consider the context around a word
in NLI. Parikh et al. (2016) did take into account
the word order and context information through an
optional distance-sensitive intra-sentence attention.

In this paper, we argue for leveraging attention
over the bidirectional sequential encoding of the
input, as discussed above. We will show that this
plays an important role in achieving our best results,
and the intra-sentence attention used by Parikh et al.
(2016) actually does not further improve over our
model, while the overall framework they proposed
is very effective.

Our soft alignment layer computes the attention
weights as the similarity of a hidden state tuple
<āi, b̄j> between a premise and a hypothesis with
Equation (11). We did study more complicated
relationships between āi and b̄j with multilayer
perceptrons, but observed no further improvement
on the heldout data.

eij = ā
T
i b̄j . (11)

In the formula, āi and b̄j are computed earlier
in Equations (1) and (2), or with Equation (3) when
tree-LSTM is used. Again, as discussed above, we
will use bidirectional LSTM and tree-LSTM to en-
code the premise and hypothesis, respectively. In
our sequential inference model, unlike in Parikh
et al. (2016) which proposed to use a function
F (āi), i.e., a feedforward neural network, to map
the original word representation for calculating eij ,
we instead advocate to use BiLSTM, which en-
codes the information in premise and hypothesis
very well and achieves better performance shown in
the experiment section. We tried to apply the F (.)
function on our hidden states before computing eij
and it did not further help our models.

Local inference collected over sequences Lo-
cal inference is determined by the attention weight
eij computed above, which is used to obtain the
local relevance between a premise and hypothesis.
For the hidden state of a word in a premise, i.e., āi
(already encoding the word itself and its context),
the relevant semantics in the hypothesis is iden-
tified and composed using eij , more specifically

1660



with Equation (12).

ãi =

`b∑

j=1

exp(eij)∑`b
k=1 exp(eik)

b̄j ,∀i ∈ [1, . . . , `a], (12)

b̃j =

`a∑

i=1

exp(eij)∑`a
k=1 exp(ekj)

āi,∀j ∈ [1, . . . , `b], (13)

where ãi is a weighted summation of {b̄j}`bj=1. In-
tuitively, the content in {b̄j}`bj=1 that is relevant to
āi will be selected and represented as ãi. The same
is performed for each word in the hypothesis with
Equation (13).

Local inference collected over parse trees We
use tree models to help collect local inference in-
formation over linguistic phrases and clauses in
this layer. The tree structures of the premise and
hypothesis are produced by a constituency parser.

Once the hidden states of a tree are all computed
with Equation (3), we treat all tree nodes equally
as we do not have further heuristics to discrimi-
nate them, but leave the attention weights to figure
out their relationship. So, we use Equation (11)
to compute the attention weights for all node pairs
between a premise and hypothesis. This connects
all words, constituent phrases, and clauses between
the premise and hypothesis. We then collect the in-
formation between all the pairs with Equations (12)
and (13) and feed them into the next layer.

Enhancement of local inference information
In our models, we further enhance the local in-
ference information collected. We compute the
difference and the element-wise product for the tu-
ple <ā, ã> as well as for <b̄, b̃>. We expect that
such operations could help sharpen local inference
information between elements in the tuples and cap-
ture inference relationships such as contradiction.
The difference and element-wise product are then
concatenated with the original vectors, ā and ã,
or b̄ and b̃, respectively (Mou et al., 2016; Zhang
et al., 2017). The enhancement is performed for
both the sequential and the tree models.

ma = [ā; ã; ā− ã; ā� ã], (14)
mb = [b̄; b̃; b̄− b̃; b̄� b̃]. (15)

This process could be regarded as a special case
of modeling some high-order interaction between
the tuple elements. Along this direction, we have

also further modeled the interaction by feeding the
tuples into feedforward neural networks and added
the top layer hidden states to the above concate-
nation. We found that it does not further help the
inference accuracy on the heldout dataset.

3.3 Inference Composition
To determine the overall inference relationship be-
tween a premise and hypothesis, we explore a com-
position layer to compose the enhanced local in-
ference information ma and mb. We perform the
composition sequentially or in its parse context
using BiLSTM and tree-LSTM, respectively.

The composition layer In our sequential infer-
ence model, we keep using BiLSTM to compose
local inference information sequentially. The for-
mulas for BiLSTM are similar to those in Equations
(1) and (2) in their forms so we skip the details, but
the aim is very different here—they are used to cap-
ture local inference information ma and mb and
their context here for inference composition.

In the tree composition, the high-level formulas
of how a tree node is updated to compose local
inference is as follows:

va,t = TrLSTM(F (ma,t),hLt−1,h
R
t−1), (16)

vb,t = TrLSTM(F (mb,t),hLt−1,h
R
t−1). (17)

We propose to control model complexity in this
layer, since the concatenation we described above
to compute ma and mb can significantly increase
the overall parameter size to potentially overfit the
models. We propose to use a mapping F as in
Equation (16) and (17). More specifically, we use a
1-layer feedforward neural network with the ReLU
activation. This function is also applied to BiLSTM
in our sequential inference composition.

Pooling Our inference model converts the result-
ing vectors obtained above to a fixed-length vector
with pooling and feeds it to the final classifier to
determine the overall inference relationship.

We consider that summation (Parikh et al., 2016)
could be sensitive to the sequence length and hence
less robust. We instead suggest the following strat-
egy: compute both average and max pooling, and
concatenate all these vectors to form the final fixed
length vector v. Our experiments show that this
leads to significantly better results than summa-
tion. The final fixed length vector v is calculated

1661



as follows:

va,ave =

`a∑

i=1

va,i
`a

, va,max =
`a

max
i=1

va,i, (18)

vb,ave =

`b∑

j=1

vb,j
`b

, vb,max =
`b

max
j=1

vb,j , (19)

v = [va,ave;va,max;vb,ave;vb,max]. (20)

Note that for tree composition, Equation (20)
is slightly different from that in sequential com-
position. Our tree composition will concatenate
also the hidden states computed for the roots with
Equations (16) and (17), which are not shown here.

We then put v into a final multilayer perceptron
(MLP) classifier. The MLP has a hidden layer with
tanh activation and softmax output layer in our ex-
periments. The entire model (all three components
described above) is trained end-to-end. For train-
ing, we use multi-class cross-entropy loss.

Overall inference models Our model can be
based only on the sequential networks by removing
all tree components and we call it Enhanced Se-
quential Inference Model (ESIM) (see the left part
of Figure 1). We will show that ESIM outperforms
all previous results. We will also encode parse in-
formation with tree LSTMs in multiple layers as
described (see the right side of Figure 1). We train
this model and incorporate it into ESIM by averag-
ing the predicted probabilities to get the final label
for a premise-hypothesis pair. We will show that
parsing information complements very well with
ESIM and further improves the performance, and
we call the final model Hybrid Inference Model
(HIM).

4 Experimental Setup

Data The Stanford Natural Language Inference
(SNLI) corpus (Bowman et al., 2015) focuses on
three basic relationships between a premise and a
potential hypothesis: the premise entails the hy-
pothesis (entailment), they contradict each other
(contradiction), or they are not related (neutral).
The original SNLI corpus contains also “the other”
category, which includes the sentence pairs lacking
consensus among multiple human annotators. As
in the related work, we remove this category. We
used the same split as in Bowman et al. (2015) and
other previous work.

The parse trees used in this paper are produced
by the Stanford PCFG Parser 3.5.3 (Klein and Man-
ning, 2003) and they are delivered as part of the
SNLI corpus. We use classification accuracy as the
evaluation metric, as in related work.

Training We use the development set to select
models for testing. To help replicate our results,
we publish our code1. Below, we list our training
details. We use the Adam method (Kingma and
Ba, 2014) for optimization. The first momentum
is set to be 0.9 and the second 0.999. The initial
learning rate is 0.0004 and the batch size is 32. All
hidden states of LSTMs, tree-LSTMs, and word
embeddings have 300 dimensions.

We use dropout with a rate of 0.5, which is
applied to all feedforward connections. We use
pre-trained 300-D Glove 840B vectors (Penning-
ton et al., 2014) to initialize our word embeddings.
Out-of-vocabulary (OOV) words are initialized ran-
domly with Gaussian samples. All vectors includ-
ing word embedding are updated during training.

5 Results

Overall performance Table 1 shows the results
of different models. The first row is a baseline
classifier presented by Bowman et al. (2015) that
considers handcrafted features such as BLEU score
of the hypothesis with respect to the premise, the
overlapped words, and the length difference be-
tween them, etc.

The next group of models (2)-(7) are based
on sentence encoding. The model of Bowman
et al. (2016) encodes the premise and hypothe-
sis with two different LSTMs. The model in Ven-
drov et al. (2015) uses unsupervised “skip-thoughts”
pre-training in GRU encoders. The approach pro-
posed by Mou et al. (2016) considers tree-based
CNN to capture sentence-level semantics, while
the model of Bowman et al. (2016) introduces a
stack-augmented parser-interpreter neural network
(SPINN) which combines parsing and interpreta-
tion within a single tree-sequence hybrid model.
The work by Liu et al. (2016) uses BiLSTM to gen-
erate sentence representations, and then replaces
average pooling with intra-attention. The approach
proposed by Munkhdalai and Yu (2016a) presents
a memory augmented neural network, neural se-
mantic encoders (NSE), to encode sentences.

The next group of methods in the table, models

1https://github.com/lukecq1231/nli

1662



Model #Para. Train Test

(1) Handcrafted features (Bowman et al., 2015) - 99.7 78.2

(2) 300D LSTM encoders (Bowman et al., 2016) 3.0M 83.9 80.6
(3) 1024D pretrained GRU encoders (Vendrov et al., 2015) 15M 98.8 81.4
(4) 300D tree-based CNN encoders (Mou et al., 2016) 3.5M 83.3 82.1
(5) 300D SPINN-PI encoders (Bowman et al., 2016) 3.7M 89.2 83.2
(6) 600D BiLSTM intra-attention encoders (Liu et al., 2016) 2.8M 84.5 84.2
(7) 300D NSE encoders (Munkhdalai and Yu, 2016a) 3.0M 86.2 84.6

(8) 100D LSTM with attention (Rocktäschel et al., 2015) 250K 85.3 83.5
(9) 300D mLSTM (Wang and Jiang, 2016) 1.9M 92.0 86.1
(10) 450D LSTMN with deep attention fusion (Cheng et al., 2016) 3.4M 88.5 86.3
(11) 200D decomposable attention model (Parikh et al., 2016) 380K 89.5 86.3
(12) Intra-sentence attention + (11) (Parikh et al., 2016) 580K 90.5 86.8
(13) 300D NTI-SLSTM-LSTM (Munkhdalai and Yu, 2016b) 3.2M 88.5 87.3
(14) 300D re-read LSTM (Sha et al., 2016) 2.0M 90.7 87.5
(15) 300D btree-LSTM encoders (Paria et al., 2016) 2.0M 88.6 87.6

(16) 600D ESIM 4.3M 92.6 88.0
(17) HIM (600D ESIM + 300D Syntactic tree-LSTM) 7.7M 93.5 88.6

Table 1: Accuracies of the models on SNLI. Our final model achieves the accuracy of 88.6%, the best
result observed on SNLI, while our enhanced sequential encoding model attains an accuracy of 88.0%,
which also outperform the previous models.

(8)-(15), are inter-sentence attention-based model.
The model marked with Rocktäschel et al. (2015)
is LSTMs enforcing the so called word-by-word
attention. The model of Wang and Jiang (2016) ex-
tends this idea to explicitly enforce word-by-word
matching between the hypothesis and the premise.
Long short-term memory-networks (LSTMN) with
deep attention fusion (Cheng et al., 2016) link the
current word to previous words stored in memory.
Parikh et al. (2016) proposed a decomposable atten-
tion model without relying on any word-order in-
formation. In general, adding intra-sentence atten-
tion yields further improvement, which is not very
surprising as it could help align the relevant text
spans between premise and hypothesis. The model
of Munkhdalai and Yu (2016b) extends the frame-
work of Wang and Jiang (2016) to a full n-ary tree
model and achieves further improvement. Sha et al.
(2016) proposes a special LSTM variant which con-
siders the attention vector of another sentence as an
inner state of LSTM. Paria et al. (2016) use a neu-
ral architecture with a complete binary tree-LSTM
encoders without syntactic information.

The table shows that our ESIM model achieves
an accuracy of 88.0%, which has already outper-
formed all the previous models, including those
using much more complicated network architec-
tures (Munkhdalai and Yu, 2016b).

We ensemble our ESIM model with syntactic
tree-LSTMs (Zhu et al., 2015) based on syntactic
parse trees and achieve significant improvement
over our best sequential encoding model ESIM, at-
taining an accuracy of 88.6%. This shows that syn-
tactic tree-LSTMs complement well with ESIM.

Model Train Test

(17) HIM (ESIM + syn.tree) 93.5 88.6
(18) ESIM + tree 91.9 88.2
(16) ESIM 92.6 88.0
(19) ESIM - ave./max 92.9 87.1
(20) ESIM - diff./prod. 91.5 87.0
(21) ESIM - inference BiLSTM 91.3 87.3
(22) ESIM - encoding BiLSTM 88.7 86.3
(23) ESIM - P-based attention 91.6 87.2
(24) ESIM - H-based attention 91.4 86.5
(25) syn.tree 92.9 87.8

Table 2: Ablation performance of the models.

Ablation analysis We further analyze the ma-
jor components that are of importance to help us
achieve good performance. From the best model,
we first replace the syntactic tree-LSTM with the
full tree-LSTM without encoding syntactic parse
information. More specifically, two adjacent words
in a sentence are merged to form a parent node, and

1663



1 -

3 -

5 -

7 -

21 -

23 -

25 -

27 -

29
standing

28
while

26
newspaper

24
a

22
reading

8 -

16 -

18 -

20
jeans

19
blue

17
a

9 -

15
and

10 -

12 -

14
shirt

13
white

11
a

6
wearing

4
man

2
A

(a) Binarized constituency tree of premise

1 -

5 -

17
.

6 -

8 -

12 -

14 -

16
newspaper

15
a

13
reading

9 -

11
down

10
sitting

7
is

2 -

4
man

3
A

(b) Binarized constituency tree of hypothesis

(c) Normalized attention weights of tree-LSTM

(d) Input gate of tree-LSTM in inference composi-
tion (l2-norm)

(e) Input gate of BiLSTM in inference composition
(l2-norm)

(f) Normalized attention weights of BiLSTM

Figure 3: An example for analysis. Subfigures (a) and (b) are the constituency parse trees of the premise
and hypothesis, respectively. “-” means a non-leaf or a null node. Subfigures (c) and (f) are attention
visualization of the tree model and ESIM, respectively. The darker the color, the greater the value. The
premise is on the x-axis and the hypothesis is on y-axis. Subfigures (d) and (e) are input gates’ l2-norm of
tree-LSTM and BiLSTM in inference composition, respectively.

this process continues and results in a full binary
tree, where padding nodes are inserted when there
are no enough leaves to form a full tree. Each tree
node is implemented with a tree-LSTM block (Zhu
et al., 2015) same as in model (17). Table 2 shows
that with this replacement, the performance drops

to 88.2%.
Furthermore, we note the importance of the layer

performing the enhancement for local inference in-
formation in Section 3.2 and the pooling layer in
inference composition in Section 3.3. Table 2 sug-
gests that the NLI task seems very sensitive to the

1664



layers. If we remove the pooling layer in infer-
ence composition and replace it with summation
as in Parikh et al. (2016), the accuracy drops to
87.1%. If we remove the difference and element-
wise product from the local inference enhancement
layer, the accuracy drops to 87.0%. To provide
some detailed comparison with Parikh et al. (2016),
replacing bidirectional LSTMs in inference compo-
sition and also input encoding with feedforward
neural network reduces the accuracy to 87.3% and
86.3% respectively.

The difference between ESIM and each of the
other models listed in Table 2 is statistically signif-
icant under the one-tailed paired t-test at the 99%
significance level. The difference between model
(17) and (18) is also significant at the same level.
Note that we cannot perform significance test be-
tween our models with the other models listed in
Table 1 since we do not have the output of the other
models.

If we remove the premise-based attention from
ESIM (model 23), the accuracy drops to 87.2% on
the test set. The premise-based attention means
when the system reads a word in a premise, it uses
soft attention to consider all relevant words in hy-
pothesis. Removing the hypothesis-based atten-
tion (model 24) decrease the accuracy to 86.5%,
where hypothesis-based attention is the attention
performed on the other direction for the sentence
pairs. The results show that removing hypothesis-
based attention affects the performance of our
model more, but removing the attention from the
other direction impairs the performance too.

The stand-alone syntactic tree-LSTM model
achieves an accuracy of 87.8%, which is compa-
rable to that of ESIM. We also computed the or-
acle score of merging syntactic tree-LSTM and
ESIM, which picks the right answer if either is
right. Such an oracle/upper-bound accuracy on test
set is 91.7%, which suggests how much tree-LSTM
and ESIM could ideally complement each other. As
far as the speed is concerned, training tree-LSTM
takes about 40 hours on Nvidia-Tesla K40M and
ESIM takes about 6 hours, which is easily extended
to larger scale of data.

Further analysis We showed that encoding syn-
tactic parsing information helps recognize natural
language inference—it additionally improves the
strong system. Figure 3 shows an example where
tree-LSTM makes a different and correct decision.
In subfigure (d), the larger values at the input gates

on nodes 9 and 10 indicate that those nodes are
important in making the final decision. We observe
that in subfigure (c), nodes 9 and 10 are aligned to
node 29 in the premise. Such information helps the
system decide that this pair is a contradiction. Ac-
cordingly, in subfigure (e) of sequential BiLSTM,
the words sitting and down do not play an impor-
tant role for making the final decision. Subfigure (f)
shows that sitting is equally aligned with reading
and standing and the alignment for word down is
not that useful.

6 Conclusions and Future Work

We propose neural network models for natural lan-
guage inference, which achieve the best results
reported on the SNLI benchmark. The results are
first achieved through our enhanced sequential in-
ference model, which outperformed the previous
models, including those employing more compli-
cated network architectures, suggesting that the
potential of sequential inference models have not
been fully exploited yet. Based on this, we further
show that by explicitly considering recursive ar-
chitectures in both local inference modeling and
inference composition, we achieve additional im-
provement. Particularly, incorporating syntactic
parsing information contributes to our best result: it
further improves the performance even when added
to the already very strong model.

Future work interesting to us includes exploring
the usefulness of external resources such as Word-
Net and contrasting-meaning embedding (Chen
et al., 2015) to help increase the coverage of word-
level inference relations. Modeling negation more
closely within neural network frameworks (Socher
et al., 2013; Zhu et al., 2014) may help contradic-
tion detection.

Acknowledgments

The first and the third author of this paper were
supported in part by the Science and Technology
Development of Anhui Province, China (Grants
No. 2014z02006), the Fundamental Research
Funds for the Central Universities (Grant No.
WK2350000001) and the Strategic Priority Re-
search Program of the Chinese Academy of Sci-
ences (Grant No. XDB02070006).

1665



References
Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-

gio. 2014. Neural machine translation by jointly
learning to align and translate. CoRR abs/1409.0473.
http://arxiv.org/abs/1409.0473.

Samuel Bowman, Gabor Angeli, Christopher Potts, and
D. Christopher Manning. 2015. A large annotated
corpus for learning natural language inference. In
Proceedings of the 2015 Conference on Empirical
Methods in Natural Language Processing. Associa-
tion for Computational Linguistics, pages 632–642.
https://doi.org/10.18653/v1/D15-1075.

Samuel Bowman, Jon Gauthier, Abhinav Rastogi,
Raghav Gupta, D. Christopher Manning, and
Christopher Potts. 2016. A fast unified model for
parsing and sentence understanding. In Proceedings
of the 54th Annual Meeting of the Association for
Computational Linguistics (Volume 1: Long Papers).
Association for Computational Linguistics, pages
1466–1477. https://doi.org/10.18653/v1/P16-1139.

William Chan, Navdeep Jaitly, Quoc V. Le, and
Oriol Vinyals. 2016. Listen, attend and spell:
A neural network for large vocabulary conversa-
tional speech recognition. In 2016 IEEE Interna-
tional Conference on Acoustics, Speech and Sig-
nal Processing, ICASSP 2016, Shanghai, China,
March 20-25, 2016. IEEE, pages 4960–4964.
https://doi.org/10.1109/ICASSP.2016.7472621.

Qian Chen, Xiaodan Zhu, Zhenhua Ling, Si Wei,
and Hui Jiang. 2016. Distraction-based neural net-
works for modeling document. In Subbarao Kamb-
hampati, editor, Proceedings of the Twenty-Fifth
International Joint Conference on Artificial Intel-
ligence, IJCAI 2016, New York, NY, USA, 9-15
July 2016. IJCAI/AAAI Press, pages 2754–2760.
http://www.ijcai.org/Abstract/16/391.

Zhigang Chen, Wei Lin, Qian Chen, Xiaoping Chen,
Si Wei, Hui Jiang, and Xiaodan Zhu. 2015. Re-
visiting word embedding for contrasting meaning.
In Proceedings of the 53rd Annual Meeting of the
Association for Computational Linguistics and the
7th International Joint Conference on Natural Lan-
guage Processing (Volume 1: Long Papers). Associ-
ation for Computational Linguistics, pages 106–115.
https://doi.org/10.3115/v1/P15-1011.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proceedings of the 2016 Conference on
Empirical Methods in Natural Language Processing.
Association for Computational Linguistics, pages
551–561. http://aclweb.org/anthology/D16-1053.

Kyunghyun Cho, Bart van Merrienboer, Dzmitry Bah-
danau, and Yoshua Bengio. 2014. On the proper-
ties of neural machine translation: Encoder-decoder
approaches. In Dekai Wu, Marine Carpuat, Xavier
Carreras, and Eva Maria Vecchi, editors, Proceed-
ings of SSST@EMNLP 2014, Eighth Workshop on

Syntax, Semantics and Structure in Statistical Trans-
lation, Doha, Qatar, 25 October 2014. Associ-
ation for Computational Linguistics, pages 103–
111. http://aclweb.org/anthology/W/W14/W14-
4012.pdf.

Jan Chorowski, Dzmitry Bahdanau, Dmitriy Serdyuk,
Kyunghyun Cho, and Yoshua Bengio. 2015.
Attention-based models for speech recognition. In
Corinna Cortes, Neil D. Lawrence, Daniel D.
Lee, Masashi Sugiyama, and Roman Garnett, ed-
itors, Advances in Neural Information Process-
ing Systems 28: Annual Conference on Neu-
ral Information Processing Systems 2015, De-
cember 7-12, 2015, Montreal, Quebec, Canada.
pages 577–585. http://papers.nips.cc/paper/5847-
attention-based-models-for-speech-recognition.

Ido Dagan, Oren Glickman, and Bernardo Magnini.
2005. The PASCAL recognising textual entailment
challenge. In Machine Learning Challenges, Eval-
uating Predictive Uncertainty, Visual Object Classi-
fication and Recognizing Textual Entailment, First
PASCAL Machine Learning Challenges Workshop,
MLCW 2005, Southampton, UK, April 11-13, 2005,
Revised Selected Papers. pages 177–190.

Lorenzo Ferrone and Massimo Fabio Zanzotto. 2014.
Towards syntax-aware compositional distributional
semantic models. In Proceedings of COLING 2014,
the 25th International Conference on Computational
Linguistics: Technical Papers. Dublin City Univer-
sity and Association for Computational Linguistics,
pages 721–730. http://aclweb.org/anthology/C14-
1068.

Sepp Hochreiter and Jürgen Schmidhu-
ber. 1997. Long short-term memory.
Neural Computation 9(8):1735–1780.
https://doi.org/10.1162/neco.1997.9.8.1735.

Adrian Iftene and Alexandra Balahur-Dobrescu. 2007.
Proceedings of the ACL-PASCAL Workshop on
Textual Entailment and Paraphrasing, Association
for Computational Linguistics, chapter Hypothe-
sis Transformation and Semantic Variability Rules
Used in Recognizing Textual Entailment, pages 125–
130. http://aclweb.org/anthology/W07-1421.

Diederik P. Kingma and Jimmy Ba. 2014. Adam:
A method for stochastic optimization. CoRR
abs/1412.6980. http://arxiv.org/abs/1412.6980.

Dan Klein and Christopher D. Manning. 2003. Ac-
curate unlexicalized parsing. In Proceedings of the
41st Annual Meeting of the Association for Computa-
tional Linguistics. http://aclweb.org/anthology/P03-
1054.

Phong Le and Willem Zuidema. 2015. Compositional
distributional semantics with long short term mem-
ory. In Proceedings of the Fourth Joint Conference
on Lexical and Computational Semantics. Associ-
ation for Computational Linguistics, pages 10–19.
https://doi.org/10.18653/v1/S15-1002.

1666



Yang Liu, Chengjie Sun, Lei Lin, and Xiao-
long Wang. 2016. Learning natural language
inference using bidirectional LSTM model
and inner-attention. CoRR abs/1605.09090.
http://arxiv.org/abs/1605.09090.

Bill MacCartney. 2009. Natural Language Inference.
Ph.D. thesis, Stanford University.

Bill MacCartney and Christopher D. Manning.
2008. Modeling semantic containment and
exclusion in natural language inference. In
Proceedings of the 22Nd International Confer-
ence on Computational Linguistics - Volume 1.
Association for Computational Linguistics, Strouds-
burg, PA, USA, COLING ’08, pages 521–528.
http://dl.acm.org/citation.cfm?id=1599081.1599147.

Yashar Mehdad, Alessandro Moschitti, and Mas-
simo Fabio Zanzotto. 2010. Syntactic/semantic
structures for textual entailment recognition. In
Human Language Technologies: The 2010 Annual
Conference of the North American Chapter of the
Association for Computational Linguistics. Associ-
ation for Computational Linguistics, pages 1020–
1028. http://aclweb.org/anthology/N10-1146.

Lili Mou, Rui Men, Ge Li, Yan Xu, Lu Zhang,
Rui Yan, and Zhi Jin. 2016. Natural language
inference by tree-based convolution and heuris-
tic matching. In Proceedings of the 54th An-
nual Meeting of the Association for Computational
Linguistics (Volume 2: Short Papers). Associa-
tion for Computational Linguistics, pages 130–136.
https://doi.org/10.18653/v1/P16-2022.

Tsendsuren Munkhdalai and Hong Yu. 2016a. Neu-
ral semantic encoders. CoRR abs/1607.04315.
http://arxiv.org/abs/1607.04315.

Tsendsuren Munkhdalai and Hong Yu. 2016b. Neu-
ral tree indexers for text understanding. CoRR
abs/1607.04492. http://arxiv.org/abs/1607.04492.

Biswajit Paria, K. M. Annervaz, Ambedkar Dukkipati,
Ankush Chatterjee, and Sanjay Podder. 2016. A neu-
ral architecture mimicking humans end-to-end for
natural language inference. CoRR abs/1611.04741.
http://arxiv.org/abs/1611.04741.

Ankur Parikh, Oscar Täckström, Dipanjan Das, and
Jakob Uszkoreit. 2016. A decomposable attention
model for natural language inference. In Proceed-
ings of the 2016 Conference on Empirical Meth-
ods in Natural Language Processing. Association
for Computational Linguistics, pages 2249–2255.
http://aclweb.org/anthology/D16-1244.

Barbara Partee. 1995. Lexical semantics and composi-
tionality. Invitation to Cognitive Science 1:311–360.

Jeffrey Pennington, Richard Socher, and Christo-
pher Manning. 2014. GloVe: Global vectors
for word representation. In Proceedings of the
2014 Conference on Empirical Methods in Nat-
ural Language Processing (EMNLP). Association

for Computational Linguistics, pages 1532–1543.
https://doi.org/10.3115/v1/D14-1162.

Tim Rocktäschel, Edward Grefenstette, Karl Moritz
Hermann, Tomás Kociský, and Phil Blun-
som. 2015. Reasoning about entailment
with neural attention. CoRR abs/1509.06664.
http://arxiv.org/abs/1509.06664.

Alexander Rush, Sumit Chopra, and Jason We-
ston. 2015. A neural attention model for ab-
stractive sentence summarization. In Proceed-
ings of the 2015 Conference on Empirical Meth-
ods in Natural Language Processing. Associa-
tion for Computational Linguistics, pages 379–389.
https://doi.org/10.18653/v1/D15-1044.

Lei Sha, Baobao Chang, Zhifang Sui, and Sujian Li.
2016. Reading and thinking: Re-read LSTM unit
for textual entailment recognition. In Proceedings
of COLING 2016, the 26th International Confer-
ence on Computational Linguistics: Technical Pa-
pers. The COLING 2016 Organizing Committee,
pages 2870–2879. http://aclweb.org/anthology/C16-
1270.

Richard Socher, Cliff Chiung-Yu Lin, Andrew Y. Ng,
and Christopher D. Manning. 2011. Parsing natu-
ral scenes and natural language with recursive neu-
ral networks. In Lise Getoor and Tobias Scheffer,
editors, Proceedings of the 28th International Con-
ference on Machine Learning, ICML 2011, Bellevue,
Washington, USA, June 28 - July 2, 2011. Omnipress,
pages 129–136.

Richard Socher, Alex Perelygin, Jean Wu, Jason
Chuang, D. Christopher Manning, Andrew Ng, and
Christopher Potts. 2013. Recursive deep models
for semantic compositionality over a sentiment tree-
bank. In Proceedings of the 2013 Conference on
Empirical Methods in Natural Language Processing.
Association for Computational Linguistics, pages
1631–1642. http://aclweb.org/anthology/D13-1170.

Sheng Kai Tai, Richard Socher, and D. Christopher
Manning. 2015. Improved semantic representations
from tree-structured long short-term memory net-
works. In Proceedings of the 53rd Annual Meet-
ing of the Association for Computational Linguistics
and the 7th International Joint Conference on Natu-
ral Language Processing (Volume 1: Long Papers).
Association for Computational Linguistics, pages
1556–1566. https://doi.org/10.3115/v1/P15-1150.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and
Raquel Urtasun. 2015. Order-embeddings of
images and language. CoRR abs/1511.06361.
http://arxiv.org/abs/1511.06361.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
ural language inference with LSTM. In Proceed-
ings of the 2016 Conference of the North Ameri-
can Chapter of the Association for Computational
Linguistics: Human Language Technologies. Asso-
ciation for Computational Linguistics, pages 1442–
1451. https://doi.org/10.18653/v1/N16-1170.

1667



Kelvin Xu, Jimmy Ba, Ryan Kiros, Kyunghyun
Cho, Aaron C. Courville, Ruslan Salakhutdi-
nov, Richard S. Zemel, and Yoshua Bengio.
2015. Show, attend and tell: Neural image
caption generation with visual attention. In
Proceedings of the 32nd International Confer-
ence on Machine Learning, ICML 2015, Lille,
France, 6-11 July 2015. pages 2048–2057.
http://jmlr.org/proceedings/papers/v37/xuc15.html.

Junbei Zhang, Xiaodan Zhu, Qian Chen, Lirong
Dai, Si Wei, and Hui Jiang. 2017. Ex-
ploring question understanding and adapta-
tion in neural-network-based question an-
swering. CoRR abs/arXiv:1703.04617v2.
https://arxiv.org/abs/1703.04617.

Xiaodan Zhu, Hongyu Guo, Saif Mohammad, and Svet-
lana Kiritchenko. 2014. An empirical study on the
effect of negation words on sentiment. In Proceed-
ings of the 52nd Annual Meeting of the Associa-
tion for Computational Linguistics (Volume 1: Long
Papers). Association for Computational Linguistics,
pages 304–313. https://doi.org/10.3115/v1/P14-
1029.

Xiaodan Zhu, Parinaz Sobhani, and Hongyu Guo.
2015. Long short-term memory over recursive
structures. In Proceedings of the 32nd International
Conference on Machine Learning, ICML 2015,
Lille, France, 6-11 July 2015. pages 1604–1612.
http://jmlr.org/proceedings/papers/v37/zhub15.html.

1668


	Enhanced LSTM for Natural Language Inference

