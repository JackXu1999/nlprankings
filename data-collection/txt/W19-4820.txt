



















































Blackbox Meets Blackbox: Representational Similarity & Stability Analysis of Neural Language Models and Brains


Proceedings of the Second BlackboxNLP Workshop on Analyzing and Interpreting Neural Networks for NLP, pages 191–203
Florence, Italy, August 1, 2019. c©2019 Association for Computational Linguistics

191

Blackbox meets blackbox: Representational Similarity and Stability
Analysis of Neural Language Models and Brains

Samira Abnar Lisa Beinborn Rochelle Choenni Willem Zuidema

Institute for Logic, Language and Computation
University of Amsterdam

{abnar,l.beinborn}@uva.nl,rochelle.choenni@student.uva.nl,zuidema@uva.nl

Abstract

In this paper, we define and apply represen-
tational stability analysis (ReStA), an intu-
itive way of analyzing neural language mod-
els. ReStA is a variant of the popular repre-
sentational similarity analysis (RSA) in cog-
nitive neuroscience. While RSA can be used
to compare representations in models, model
components, and human brains, ReStA com-
pares instances of the same model, while sys-
tematically varying single model parameter.
Using ReStA, we study four recent and suc-
cessful neural language models, and evaluate
how sensitive their internal representations are
to the amount of prior context. Using RSA,
we perform a systematic study of how similar
the representational spaces in the first and sec-
ond (or higher) layers of these models are to
each other and to patterns of activation in the
human brain. Our results reveal surprisingly
strong differences between language models,
and give insights into where the deep linguis-
tic processing, that integrates information over
multiple sentences, is happening in these mod-
els. The combination of ReStA and RSA on
models and brains allows us to start address-
ing the important question of what kind of lin-
guistic processes we can hope to observe in
fMRI brain imaging data. In particular, our
results suggest that the data on story reading
from Wehbe et al. (2014) contains a signal of
shallow linguistic processing, but show no ev-
idence on the more interesting deep linguistic
processing.

1 Representational Similarity

Representational similarity analysis (RSA) is a
technique which allows us to compare heteroge-
neous representational spaces (Laakso and Cot-
trell, 2000). It is very common in cognitive neuro-
science because it allows researchers to study the
relation between patterns of activation in the brain
and representations of stimuli in a computational
model (Kriegeskorte et al., 2008). The key idea

is simple: instead of directly trying to map mod-
els to brains, we first construct two similarity ma-
trices that record how similar brain responses are
to each other for different stimuli, and how simi-
lar the computational model’s representations for
each stimulus are to each other. The representa-
tional similarity score is then defined as the simi-
larity (typically: Pearson’s correlation) of the two
similarity matrices (or equivalently: the similarity
of two distance matrices).

RSA can also be applied to deep learning mod-
els (Laakso and Cottrell, 2000; Dharmaretnam and
Fyshe, 2018; Alvarez-Melis and Jaakkola, 2018;
Wang et al., 2018; Chrupała and Alishahi, 2019).
In this paper, we present a large-scale study and
comparison of both neural language models and
fMRI data from brain imaging experiments with
human subjects, using RSA. However, we extend
standard RSA using an approach we call Repre-
sentational Stability Analysis (ReStA). The idea is
again simple: we apply RSA to compare instances
of the same model, while systematically varying a
model parameter.

We focus on a single parameter: the length of
the prior context presented to the model. Vary-
ing the amount of context allows us to quantify
the degree of context-dependence of different neu-
ral language models, and different components
of those models. If internal representations are
similarly organized regardless of how much addi-
tional context is presented to the model, context-
dependence is low. If, on the other hand, repre-
sentations change with each additional amount of
context included, context-dependence is high. Us-
ing this approach, we find intriguing differences
between some recent, successful neural language
models (GoogleLM, ELMO, BERT and the Uni-
versal Sentence Encoder; Table 1), and between
the first and deeper layers of those models.

Context-dependence, in turn, gives us a handle
on an important question in the research that tries



192

Model Objective Corpus Rep.Dim. Architecture

GloVe (Pennington et al., 2014)
Predicting

co-occurrence probabilities
Wikipedia 300 Bag of words

ELMO (Peters et al., 2018)
Bidirectional

Language Modelling
1B benchmark 1,024 BiLSTM

GoogleLM (Jozefowicz et al., 2016) Language Modelling 1B benchmark 1,024 LSTM

UniSentEnc. (Cer et al., 2018) Skip-Thought/Classification
Variety of web sources

/ SNLI
512 Transformer Encoder

BERT (base) (Devlin et al., 2019)
Masked Language Modelling

/ Next Sent. Pred.
BooksCorpus

/ English Wikipedia
768 Transformer Encoder

Table 1: Details of the third party computational models used in this paper, including a brief characterization of
the optimization objective, the training corpus, and the dimensionality of representations we extract from them.

to link neural language models to brain activation:
which aspects of language processing in the brain
can we hope to observe in fMRI data using NLP
and machine learning tools?

2 Bridging NLP Models and
Neurolinguistics

An important motivation behind our work is to
contribute to answering a big question in computa-
tional linguistics: how do we establish a relation-
ship between NLP models and data on the human
brain activation while they process language? Pio-
neering work of Mitchell et al. (2008) showed that
techniques from distributional semantics could be
used to predict and decode brain activation. In the
decade since that paper, many efforts have been re-
ported using brain data to evaluate computational
models, or using NLP models to build predic-
tive models of the human brain, or both (Murphy
et al., 2012; Wehbe et al., 2014a; Ruan et al., 2016;
Søgaard, 2016; Xu et al., 2016; Fyshe et al., 2014;
Bingel et al., 2016; Bulat et al., 2017; Abnar et al.,
2018; Pereira et al., 2018; Huth et al., 2016).

Most of that work is focused on lexical rep-
resentations, reporting promising results for con-
crete nouns, presented in isolation. More recently
researchers have tried to adapt the methodology
to address words in context, in sentence and story
processing tasks. Pereira et al. (2018), for in-
stance, used a bag of words model of sentence
meaning to decode sentences from brain activa-
tion. Wehbe et al. (2014b); Qian et al. (2016) use
the internal states of LSTMs trained for language
modelling for encoding. Jain and Huth (2018) re-
port that the higher layers of the LSTM are better
at predicting the activation of brain regions that are
known for higher level language functions (a find-

ing seemingly at odds with results from section5).

In this effort, however, we run into a number
of major conceptual, methodological and techni-
cal challenges. Most importantly: how do we
determine what we are really observing in the
brain data? Are we really seeing signatures of lin-
guistic processes, or just neural correlates of gen-
eral cognitive processes evoked by a correct un-
derstanding of the linguistic input? How do we
adequately control for alternative explanations of
the observed correlations? And how do we deal
with the intricate temporal dynamics and the over-
whelmingly high dimensionality of the brain, and
the very indirect, delayed and/or coarse measure-
ments that neuroimaging gives us of the processes
in the brain? Merely demonstrating a correlation
between two black boxes is clearly not sufficient.

We argue that experiments to find the model
best correlated with brain activations should be
accompanied by efforts for interpreting the inter-
nal representations and operations of the models.
Applying ReStA for the prior context parameter
gives us a way to roughly characterize the depth
of linguistic processing in different language mod-
els and different components of these models. If
a model component only tracks the lexical se-
mantics of the current word, the representations
it forms should not be sensitive to the amount of
prior context. On the other hand, If a model com-
ponent tracks long-distance syntactic dependen-

Block Words Unique words Sentences Sent Length Scans

1 1583 553 115 11 326
2 1711 560 163 8 338
3 1411 461 134 8 265
4 1853 583 177 8 366

Table 2: Statistics of the Harry Potter dataset.



193

Figure 1: Alignment of the words in the story and the brain vectors. Each fMRI scan lasts for 2 seconds during
which the subject is reading four words sequentially. Delay is the amount of time in seconds between the time the
first of the four word is shown to the subject and when the fMRI scan is started to be taken.

cies, semantic polarity, named entities, topics or
story arcs, resolves anaphora or builds up situa-
tion models, its representations will be different
whenever different amounts of prior context are
available. Hence, in this paper, we will interpret
context-dependence as an imperfect but useful sig-
nature of deep linguistic processing.

3 Models and Data

In this section, we explain the language encod-
ing models we study in our experiments and the
dataset from which we get the language stimuli
and their corresponding brain data.

3.1 Neural Language Models

We study language models with different archi-
tectures trained with different objective functions
(see Table 1). As a word level embedding model,
we use GloVe (Pennington et al., 2014). We con-
sider a sentence as a bag of words and take the
average of the GloVe embeddings.

We employ two high performing LSTM based
language models: ELMO (Peters et al., 2018)
and GoogleLM (Jozefowicz et al., 2016). Both
of these models have two LSTM layers; how-
ever, ELMO uses bidirectional LSTM layers,
whereas in the GoogleLM the LSTM layers are
uni-directional. From these models, we take the
internal states of each of the LSTM layers as two
different representation spaces.

In our comparisons, we also use BERT and
the Universal Sentence Encoder (UniSentEnc), as
Transformer based models. BERT is trained on
masked language modelling and next sentence
prediction tasks (Devlin et al., 2019) while the
Universal Sentence Encoder is trained on a differ-
ent objective than language modelling. The pa-
rameters of this model are optimized with respect

to different language tasks such that it can better
encode the meaning of complete sentences. These
two models do not have the recurrent inductive
bias of LSTMs, and hence the representations they
learn can be completely different.

To study how and where the models integrate
information over time, we modify the amount of
context provided to the models to obtain the con-
textualized word representations. We do this at the
sentence level. Thus, for the context length of 0,
we only feed the target words to the models; For
context length 1 we feed all the previous words
in the current sentence to the models. For context
length i where i > 1, in addition to the current
sentence we feed all the words in the last i sen-
tences. We operate on the sentence level to feed
the model with independently meaningful pieces
of text.

From prior work, we expect a relation between
the depth of the layers and the level of abstraction
of their representations. We study this intuition
here empirically by analyzing the different layers
of the models, and we focus on the first and last
layers. Note that the last layer corresponds to the
second layer for the LSTM architectures, but to the
12th layer for Bert.

3.2 Brain Data

We compare the representations of our model to
human brain activations captured while reading a
story. We use the dataset by (Wehbe et al., 2014a)
which consists of the fMRI scans of 8 participants
reading chapter 9 of Harry Potter and the Sor-
cerer’s stone (Rowling, 1998).1

The story was presented to the participants word

1The data is available at http://www.cs.cmu.edu/
˜fmri/plosone/. Further information on the pre-
processing steps is described in the supplementary material.

http://www.cs.cmu.edu/~fmri/plosone/
http://www.cs.cmu.edu/~fmri/plosone/


194

(a) GoogleLM

(b) ELMO

(c) BERT

Figure 2: RSA between different layers of each model
given different context length in terms of number of
previous sentences over the story words. In these plots,
for example L1 c3 means representation from layer 1,
when the context length is 3 sentences including the
current sentence. When c = 0, the model only sees
the current words and when c = 1 the model sees cur-
rent sentence up to the target word. Here darker means
more similar. The values are averaged over the four
story blocks and the standard deviation of all the val-
ues across the four blocks are below 0.002.

by word on a screen in four continuous blocks.2

Each word was displayed for 0.5 seconds and an
fMRI scan was taken every 2 seconds. Figure 1 vi-
sualizes an example for the beginning of the chap-
ter. More detailed statistical information about the
stimuli can be found in Table 2.

Brain Regions The fMRI data contains acti-
vation values for approximately 40,000 voxels
per scan, each reflecting the oxygen usage (the
“BOLD response”) in approximately 3mm3 of
brain tissue. To obtain the brain representa-
tions, we flatten the 3D fMRI images into vectors
thereby ignoring the spatial relationships between
the voxels. We do this either for the whole brain,
or for specific regions separately. Not all of the
scanned voxels are related to language process-
ing, but the changes in activity might be associated
with other cognitive processes like, for example,
the noise perception in the scanner. A common
reduction method is to restrict the brain response
to voxels that fall within a pre-selected set of re-
gions. In our analysis, we only include the vox-
els from the top k regions that are most similar
across different subjects given the same stimuli.
We heuristically set the value of k to 16 based on
the distribution of the similarity scores.3

Delay An important point to consider when
dealing with fMRI data is the hemodynamic re-
sponse delay: from the time neurons start firing,
it takes 4 to 6 seconds until the Bold response
reaches its peak (Buckner, 1998). This means that
from the time a stimulus is presented to a subject,
it takes approximately 5 seconds before we can ob-
serve its response in the fMRI scan of the brain.
We account for this delay by varying the alignment
between stimuli and scans. If we apply a delay of
0 seconds, scan 3 in the example would be applied
to the sequence boy he hated more, Figure 1. With
a delay of 2 seconds, it is aligned to the previous
stimulus he would meet a and a delay of 4 would
result in alignment with Harry had never believed.

2The story chapter is split into four almost equal length
blocks, each reflecting approximately 12 minutes of measure-
ments. Each block is presented to the participant in one con-
tinuous trial, and experimental blocks are separated by pauses
for the subjects.

3We sort the brain regions based on their cross-subject
similarities for different stimuli and pick a threshold value
based when there is a relatively big jump in the similarity
scores.



195

Figure 3: RSA across models

4 Analyzing Neural Language Models

In this section, we present the results of ap-
plying ReStA, Representational Stability Analy-
sis, to three different language encoding mod-
els, GoogleLM, ELMO and BERT. We investigate
what type of information is captured in the learned
representations without making any explicit as-
sumptions. Next, we apply standard RSA to, first,
investigate the relations between different compo-
nents of the language encoding models, and sec-
ond to study the alignment of these components
with the activity patterns in the human brain.4

4.1 Representational Stability Analysis

We define the Representational Stability as the
similarity between the representations obtained
from a model, when a single condition is changed,
i.e. increase in context length. We use RSA
to measure the similarity between the representa-
tional spaces. And to compute RSA we use cosine
similarity to measure the intra-space similarities
and use Pearson correlation to quantify the sim-
ilarities across representational spaces.

In Figure 2 the representations of the differ-
ent layers given different context lengths are com-
pared for GoogleLM, ELMO and BERT. The val-
ues under the diagonal of these plots indicate
the ReStA when the varying condition is context
length. This is measured as RSA(Lk−ci , Lk−cj ),
where k is the layer id and ci and cj are differ-

4We made the code that reproduces all the experi-
ments publicly available at {https://github.com/
samiraabnar/Bridge}

ent conditions which in this case indicate differ-
ent context lengths. We have depicted the trends
of how the ReStA changes for different context
length in Figures 4a and 4b.

Effect of depth As we can see in Figure 2 and
more clearly in Figure 5, for the LSTM based
models, we observe a higher degree of similarity
between the two layers (∼ 0.75 and ∼ 0.80) com-
pared to BERT (∼ 0.35). This can be partly ex-
plained by the higher number of layers in BERT,
i.e the first and last layer are further apart. More-
over, the relation between the first and last layers is
almost the same for all context lengths and for all
these three models the two layers are most similar
when provided with the same amount of context.

Context sensitivity Next, we analyse the sensi-
tivity of different layers of each model to context
length. In Figures 4a and 2, we see that for both
LSTM based models, GoogleLM and ELMO, the
first layer, L0, is less sensitive to the changes in
the context length compared to the last layer, L1,
i.e. the representations are not affected anymore
by increasing the context length to more than 3
sentences. A hierarchical encoding mechanism,
where the first layer is responsible for encoding
the local context and the second(last) layer is en-
coding more global information, can justify these
results.

We can see in Figure 4a, that the sensitivity to
the context length is more significant in the Trans-
former based models compared to LSTM based
models. In these models, the difference in the rep-
resentations at different context lengths does not
fade away as the context length increases but the
rate of the changes becomes constant. As illus-
trated in Figures 4a and 2c we observe that in
BERT, regardless of the current context length,
adding more context leads to different represen-
tations. In addition, in this model, the represen-
tations from the first layer, L0 are more context-
dependent than those from the last layer, L11.
Since in self-attention layers, there is a direct con-
nection between the representations at different
positions, the higher degree of sensitivity to con-
text length is not surprising. This is evidence that,
for computing the representations of each position
in the input, the representations from all positions,
no matter how far they are, are in fact taken into
account. We speculate that the last layer of BERT
is less sensitive to context could be that in higher

https://github.com/samiraabnar/Bridge
https://github.com/samiraabnar/Bridge


196

0 1 2 3 4 5 6

0.2

0.4

0.6

0.8

1

Context Length

GoogleLM(L0) GoogleLM(L1) Elmo(L0) Elmo(L1) BERT(L0) BERT(L02) UniSentEnc GloVe

(a) Context Sensitivity (RSA(Lk ci, Lk ci+1))

0 1 2 3 4 5

0

0.2

Context Length

(b) Changes in Context Sensitivity (δRSA(Lk ci, Lk ci+1))

Figure 4: Changes in RSA by increasing context length. (a) Shows how the amount of difference in the repre-
sentational spaces changes by increasing the context length. (b) Shows for all models that we study, regardless
of whether and how much their representations change by increasing context length, the amount of difference be-
comes almost constant after context length of 3 sentences. Note that in (b), we have scaled the plot and removed
some of the models to increase the readability.

0 1 2 3 4 5 6 7
0.2

0.4

0.6

0.8

1

Context Length

GoogleLM(L0→L1) Elmo(L0→L1)
BERT(L0→L02) BERT(L0→L1)

Figure 5: Layer similarities (RSA(Lk ci, Lk+1 ci).
Here we show how increasing context length affects the
similarity between different layers of the models.)

layers, the representations correspond to more ab-
stract meanings, and the representational space be-
comes denser than the lower layers.

4.2 RSA across Models

In the second step, we study whether the compu-
tational models have learned inherently different
representational spaces. According to representa-
tional similarity scores, among the models that we
study, shown in Figure 3, UniSentEnc seems to
learn very different representations from ELMO,
GoogleLM and BERT. While BERT and UniSen-
tEnc are both Transformer based models, the rep-
resentational space of BERT is more similar to
the representations from ELMO and GoogleLM
that are LSTM based models. This can be due
to the fact that ELMO, GoogleLM and BERT are
trained with language modelling objectives, while
UniSentEnc is trained on skip-thought and clas-
sification tasks and this could indicate the effect
of the training objective on the representational
spaces.

5 The Relation between the Models and
the Activity Patterns in Human Brains

Figure 7 shows the similarity of different computa-
tional representation spaces with brain representa-
tions, with respect to different amounts of context
provided to the models, averaged over all human
subjects. Due to the hemodynamic response delay,
we expect to see the peak in similarities after about
4s delay. As we can see in Figure 6, the highest
RSA for all models is at Delay = 4s, the rank-
ing of the models based on their similarities with
brain representations is the same for all amounts
of delay. Interestingly, the performances of these
models on the NLP tasks are not correlated with
their similarity with the brain representations (but
note the overall low correlations). The represen-
tations learned by LSTM based models are most
similar to the brain data, and for both ELMO and
GoogleLM the representations from lower layers,
L0, have higher similarity scores compared to the
higher layers, L1. Interestingly, for UniSentEnc,
BERT(L11) and also GoogleLM(L1), increasing
the context length, which usually boosts the per-
formance of language encoding models in lan-
guage understanding tasks (Wang and Cho, 2016),
leads to lower similarity with brain representa-
tions. It seems that the way these models integrate
the context information, pushes the representation
further away from the brain representations. This
could mean: (1) These models are doing fairly
well at encoding the local context, but not at a
more global level. Alternatively, (2) The informa-
tion about the more global aspects of the meaning



197

GoogleLM(L0) GoogleLM(L1) ELMO(L0) ELMO(L1) BERT(L0) BERT(L11) UniSentEnc GloVe

0.1

0.2

0.3

0.4

Delay=-4 Delay=-2 Delay=0 Delay=2 Delay=4 Delay=6 Delay=8 Delay=10

Figure 6: Representational similarity of the models and brains averaged over all subjects and the four blocks at
different time delays after the human subjects have read the target words, when the context provided to the models
is three sentences. Here the delay is increasing from left to right and the error bars indicate the standard deviation
across different blocks.

0 1 2 3 4 5 6 7

0.2

0.3

0.4

Context Length

GoogleLM(L0) GoogleLM(L1) Elmo(L0) Elmo(L1)

Bert(L0) Bert(L11) UniSentEnc GloVe

Figure 7: Similarity of the representations from differ-
ent layers of different models, given different amount
of context with brain representations, averaged over all
subjects. Note that the average RSA of brains of differ-
ent human subjects is about 0.55

is not encoded in the brain representations.

Different Segments of the Story If during train-
ing the models are only trained on full sentences, it
might be the case that the quality of their represen-
tations, when given complete sentences, is signifi-
cantly better than when provided with incomplete
sentences. On the other hand, the representation
of sentences in the brain might also be more reli-
able when the full sentence is read. To take this
into account, we look at the similarities of each of
the models with brain representations, only at the
steps in the story where an end of a sentence token
is reached. Figure 8a presents the results. We see
that in this case, the similarity of all the models
with brain representations increases slightly, but
this could be because of the reduced dimension-
ality of the similarity matrix, and we see that the
general patterns stay similar.

In Figure 8b we observe that at the story seg-
ments where a name of a character is mentioned,
the patterns of similarities change a bit, e.g. the

last layer of BERT is less similar to the brain repre-
sentations compared the first layer of BERT, when
an intermediate amount of context is provided to
the model. This finding is difficult to interpret, but
warrants further research.

Different Regions of the Brain We looked at
the similarity scores of the computational repre-
sentations with the representations at different re-
gions of the brain. This is illustrated in Figure 9
for subject 4 as an example. We observe that the
patterns of RSA of different models are very sim-
ilar across different brain regions, i.e. the scores
scale for all regions almost similarly across dif-
ferent models. Despite the low correlations be-
tween the models and the brain activation, we find
that all the models are consistently best aligned
with the regions in the Left Anterior Temporal
Lobe (LATL). This region is known for seman-
tic and sometimes syntactic processing of lan-
guage (Westerlund and Pylkkänen, 2014; Bemis
and Pylkkänen, 2011; Leffel et al., 2014). We also
find some correlation with the Left Parietal Lobe,
which is not known to be responsible for language
processing. We also computed the average RSA
between different brain regions for the eight sub-
jects, both within and across subjects, and find that
the different regions of a single brain are more
similar (RSA = 0.4) than the same regions of dif-
ferent brains (RSA = 0.12). These are counter-
intuitive findings that warrant further investiga-
tion. If brain functions involved in story compre-
hension are spatially localized and brains are or-
ganized similarly across individuals, we would ex-
pect the same regions from different subjects to be
more similar than different regions from the same
subject.



198

0 1 2 3 4 5 6 7

0.3

0.4

0.5

0.6

Context Length

GoogleLM(L0) GoogleLM(L0) Elmo(L0) Elmo(L0) BERT(L0) BERT(L01) UniSentEnc GloVe

(a) Complete sentences

0 1 2 3 4 5 6 7

0.5

0.6

0.7

Context Length

(b) Mentions of story character

Figure 8: Similarity of the computational representations with brain representations at different segments of the
story.

Predictive Approach Besides, RSA, we can use
a predictive approach to see which regions of the
brain are more predictable, given the representa-
tions from a computational model. In the predic-
tive approach, we train a linear regression model
to predict the brain activity patterns at different
steps of the story. This way, we can obtain more
fine-grained insights into which parts of the model
contribute more to which regions in the brain.

In Figure 10, we show the results of using rep-
resentations obtained from GoogleLM(L0) to pre-
dict brain activity patterns of different subjects.
Similar to the results we obtained from RSA, the
effect of hemodynamic response delay is clearly
visible here. One of the difficulties of employ-
ing a predictive approach is to train a regression
model for such high dimensions and with so little
data. Hence, if the performance of the prediction
is low, it is hard to tell if it is because we are not
able to train a good regression model or because
there is no correlation between the two models.
To overcome this challenge, one solution could be
to first use RSA to reduce the search space and
then employ predictive modelling to gain more
fine-grained insights. We postpone further anal-
ysis with the predictive approach to future studies.

6 Discussion and Conclusion

In this paper, we employ a representational simi-
larity metric to compare the representations from
the language encoding models with the brain ac-
tivity patterns, i.e. measure the alignment between
the brain activation patterns and activations of the
internal state of the models. The main advantage
of RSA is that it treats both the brain and the model
as a blackbox; it does not need to know how brains
or models represent objects, words or sentences,
but only how similar representations are to each

other. For N stimuli considered, the analysis only
compares 12N(N − 1) pairs of pairwise similari-
ties (assuming similarities are symmetric), regard-
less of the dimensionality of two representational
spaces. This bottleneck brings many advantages
including computational efficiency, reuse of the
similarity matrices in multiple comparisons, and
not having to worry about how to map representa-
tions of very different nature to each other. It also
brings important limitations and inevitable infor-
mation loss, e.g. standard RSA, assumes all fea-
tures of the representational spaces to have equal
contributions.

One of our contributions in this paper is the in-
troduction of ReStA, which uses RSA to measure
the stability of the representations from the mod-
els when an input condition such as context length
is changed. Comparing the representational sim-
ilarity of different layers of different models, we
find that both architectural differences and differ-
ent training objectives have a noticeable impact on
the representations learned by the models and the
way they change under different conditions. We
see a clear difference in the sensitivity to context
size between L0 and L1 in the LSTM based mod-
els. This means, in line with results from previ-
ous work using different methods (e.g., Giulianelli
et al., 2018), that the L1 component integrates in-
formation over time steps while L0 does not.

Using brain data to evaluate the representations
learned at different layers of each of the lan-
guage encoding models, we find that layers of
the LSTM based models achieve higher similar-
ity score with brain data compared to single word
representation models like GloVe and the Trans-
former based models. This observation could
show that the learning biases of the LSTM based
language models are closer to what happens in the
human brain. Zooming into the results, we see that



199

(a) GoogleLM (L0)

(b) GoogleLM (L1)

(c) ELMO (L0)

(d) ELMO (L1)

(e) UniSentEnc

(f) BERT (L0)

(g) BERT (L11)

(h) GloVe

Figure 9: RSA of representations learned at different
layers of different models with representations at dif-
ferent regions of Subject4’s brain which is chosen ran-
domly (the code accompanying this paper can be used
to generate the plots for the other subjects). In order
to emphasize the difference of the similarity of each
model with different brain regions, the color bar is
scaled independently for each model. The darkest re-
gion for all models is the Left Anterior Temporal Lobe.

0 2 4 6 8 10
0.4

0.6

0.8

1
·10−2

Delay

Figure 10: Predictive power of representations learned
by Google LM (L0 Cinf) for brain representations in
terms of explained variance (each subject in a different
color).

while changing the conditions of the inputs to the
models has a significant impact on the representa-
tions they compute and their performance on NLP
tasks (Khandelwal et al., 2018), these changes do
not get reflected in their alignment with the brain
representations.

Finally, evaluating computational models of
language processing with brain imaging data for
a task such as “story reading” is hard, because
of the inherent issues in the brain data and also
the complexity of the task (Beinborn et al., 2019).
Both the RSA framework and the predictive mod-
elling approach make it possible to make a bridge
between these black boxes, neural network mod-
els for language processing on the one hand and
the human brain on the other. And while each of
these approaches has its benefits and limitations,
they might provide us with complementary infor-
mation. Hence, it is invaluable to look at both.

In our experiments, we observe more similari-
ties between representations learned by some ar-
chitectures and brain representations. However,
caution is required when interpreting these results,
as the representational similarity between all mod-
els and the brain images remains very low. We
plan to perform further analysis on various (big-
ger) datasets to get a better interpretation of what
is happening in both the brain and these computa-
tional models.

Acknowledgement

We thank Dieuwke Hupkes, Arnold Kochari, the
Language in Interaction BQ1 team, and the anony-
mous reviewers for useful comments on the re-
search described here and earlier versions of this
paper. The work presented here was funded by the
Netherlands Organization for Scientific Research
(NWO), through a Gravitation Grant 024.001.006
to the Language in Interaction Consortium.



200

References
Samira Abnar, Rasyan Ahmed, Max Mijnheer, and

Willem Zuidema. 2018. Experiential, distributional
and dependency-based word embeddings have com-
plementary roles in decoding brain activity. In Pro-
ceedings of the 8th Workshop on Cognitive Modeling
and Computational Linguistics (CMCL 2018), pages
57–66. Association for Computational Linguistics.

Alexandre Abraham, Fabian Pedregosa, Michael Eick-
enberg, Philippe Gervais, Andreas Mueller, Jean
Kossaifi, Alexandre Gramfort, Bertrand Thirion, and
Gaël Varoquaux. 2014. Machine learning for neu-
roimaging with scikit-learn. Frontiers in neuroin-
formatics, 8:14.

David Alvarez-Melis and Tommi Jaakkola. 2018.
Gromov-Wasserstein alignment of word embedding
spaces. In Proceedings of the 2018 Conference on
Empirical Methods in Natural Language Process-
ing, pages 1881–1890, Brussels, Belgium. Associ-
ation for Computational Linguistics.

Lisa Beinborn, Samira Abnar, and Rochelle Choenni.
2019. Robust evaluation of language-brain encod-
ing experiments. International Journal of Computa-
tional Linguistics and Applications, to appear.

Douglas K Bemis and Liina Pylkkänen. 2011. Sim-
ple composition: A magnetoencephalography inves-
tigation into the comprehension of minimal linguis-
tic phrases. Journal of Neuroscience, 31(8):2801–
2814.

Joachim Bingel, Maria Barrett, and Anders Søgaard.
2016. Extracting token-level signals of syntactic
processing from fMRI - with an application to PoS
induction. In Proceedings of the 54th Annual Meet-
ing of the Association for Computational Linguistics
(Volume 1: Long Papers), pages 747–755. Associa-
tion for Computational Linguistics.

Randy L Buckner. 1998. Event-related fMRI and the
hemodynamic response. Human brain mapping,
6(5-6):373–377.

Luana Bulat, Stephen Clark, and Ekaterina Shutova.
2017. Speaking, seeing, understanding: Correlating
semantic models with conceptual representation in
the brain. In Proceedings of the 2017 Conference on
Empirical Methods in Natural Language Processing
(EMNLP), pages 1081–1091. Association for Com-
putational Linguistics.

Daniel Cer, Yinfei Yang, Sheng-yi Kong, Nan Hua,
Nicole Limtiaco, Rhomni St. John, Noah Constant,
Mario Guajardo-Cespedes, Steve Yuan, Chris Tar,
Brian Strope, and Ray Kurzweil. 2018. Univer-
sal sentence encoder for english. In Proceedings
of the 2018 Conference on Empirical Methods in
Natural Language Processing, EMNLP 2018: Sys-
tem Demonstrations, Brussels, Belgium, October 31
- November 4, 2018, pages 169–174.

Grzegorz Chrupała and Afra Alishahi. 2019. Correlat-
ing neural and symbolic representations of language.
In Proceedings of the Annual Meeting of the Associ-
ation for Computational Linguistics (ACL 2019).

Jacob Devlin, Ming-Wei Chang, Kenton Lee, and
Kristina Toutanova. 2019. Bert: Pre-training of deep
bidirectional transformers for language understand-
ing. In Proceedings of Conference of the North
American Chapter of the Association for Computa-
tional Linguistics - Human Language Technologies
(NAACL HLT 2019).

Dhanush Dharmaretnam and Alona Fyshe. 2018. The
emergence of semantics in neural network represen-
tations of visual information. In Proceedings of
Conference of the North American Chapter of the
Association for Computational Linguistics - Human
Language Technologies (NAACL HLT 2018).

Alona Fyshe, Partha P Talukdar, Brian Murphy, and
Tom M Mitchell. 2014. Interpretable semantic vec-
tors from a joint model of brain-and text-based
meaning. In Proceedings of the conference. Associ-
ation for Computational Linguistics. Meeting (ACL
2014), volume 2014, page 489. NIH Public Access.

Mario Giulianelli, Jack Harding, Florian Mohnert,
Dieuwke Hupkes, and Willem Zuidema. 2018. Un-
der the hood: Using diagnostic classifiers to investi-
gate and improve how language models track agree-
ment information. In 1st BlackBoxNLP workshop at
Conference on Empirical Methods in Natural Lan-
guage Processing (EMNLP 2019).

Alexander G Huth, Wendy A de Heer, Thomas L Grif-
fiths, Frédéric E Theunissen, and Jack L Gallant.
2016. Natural speech reveals the semantic maps that
tile human cerebral cortex. Nature, 532(7600):453.

Shailee Jain and Alexander G. Huth. 2018. Incorpo-
rating context into language encoding models for
fMRI. In Proceedings of the 32Nd International
Conference on Neural Information Processing Sys-
tems, NIPS’18, pages 6629–6638, USA. Curran As-
sociates Inc.

Rafal Jozefowicz, Oriol Vinyals, Mike Schuster, Noam
Shazeer, and Yonghui Wu. 2016. Exploring the lim-
its of language modeling. CoRR.

Urvashi Khandelwal, He He, Peng Qi, and Dan Juraf-
sky. 2018. Sharp nearby, fuzzy far away: How neu-
ral language models use context. In Proceedings of
the 56th Annual Meeting of the Association for Com-
putational Linguistics, ACL 2018, Melbourne, Aus-
tralia, July 15-20, 2018, Volume 1: Long Papers,
pages 284–294.

Nikolaus Kriegeskorte, Marieke Mur, and Peter A Ban-
dettini. 2008. Representational similarity analysis-
connecting the branches of systems neuroscience.
Frontiers in systems neuroscience, 2:4.

http://aclweb.org/anthology/W18-0107
http://aclweb.org/anthology/W18-0107
http://aclweb.org/anthology/W18-0107
https://www.aclweb.org/anthology/D18-1214
https://www.aclweb.org/anthology/D18-1214
http://aclweb.org/anthology/D17-1113
http://aclweb.org/anthology/D17-1113
http://aclweb.org/anthology/D17-1113
https://aclanthology.info/papers/D18-2029/d18-2029
https://aclanthology.info/papers/D18-2029/d18-2029
http://dl.acm.org/citation.cfm?id=3327757.3327769
http://dl.acm.org/citation.cfm?id=3327757.3327769
http://dl.acm.org/citation.cfm?id=3327757.3327769
https://aclanthology.info/papers/P18-1027/p18-1027
https://aclanthology.info/papers/P18-1027/p18-1027


201

Aarre Laakso and Garrison Cottrell. 2000. Content
and cluster analysis: assessing representational sim-
ilarity in neural systems. Philosophical psychology,
13(1):47–76.

Timothy Leffel, Miriam Lauter, Masha Westerlund,
and Liina Pylkkänen. 2014. Restrictive vs. non-
restrictive composition: a magnetoencephalogra-
phy study. Language, cognition and neuroscience,
29(10):1191–1204.

Tom M Mitchell, Svetlana V Shinkareva, Andrew Carl-
son, Kai-Min Chang, Vicente L Malave, Robert A
Mason, and Marcel Adam Just. 2008. Predicting
human brain activity associated with the meanings
of nouns. science, 320(5880):1191–1195.

Brian Murphy, Partha Talukdar, and Tom Mitchell.
2012. Selecting corpus-semantic models for neu-
rolinguistic decoding. In Proceedings of the First
Joint Conference on Lexical and Computational Se-
mantics, SemEval ’12, pages 114–123, Stroudsburg,
PA, USA. Association for Computational Linguis-
tics.

Jeffrey Pennington, Richard Socher, and Christopher
Manning. 2014. Glove: Global vectors for word
representation. In Proceedings of the conference on
empirical methods in natural language processing
(EMNLP 2014), pages 1532–1543.

Francisco Pereira, Bin Lou, Brianna Pritchett, Samuel
Ritter, Samuel J Gershman, Nancy Kanwisher,
Matthew Botvinick, and Evelina Fedorenko. 2018.
Toward a universal decoder of linguistic meaning
from brain activation. Nature communications,
9(1):963.

Matthew E. Peters, Mark Neumann, Mohit Iyyer, Matt
Gardner, Christopher Clark, Kenton Lee, and Luke
Zettlemoyer. 2018. Deep contextualized word repre-
sentations. In Proceedings of the 2018 Conference
of the North American Chapter of the Association
for Computational Linguistics: Human Language
Technologies, NAACL HLT 2018, pages 2227–2237.

Peng Qian, Xipeng Qiu, and Xuanjing Huang. 2016.
Bridging lstm architecture and the neural dynam-
ics during reading. In Proceedings of International
Joint Conferences on Artificial Intelligence Organi-
zation (IJCAI 2016).

J. K. Rowling. 1998. Harry Potter And the Sorcerer’s
Stone. Arthur A. Levine Books.

Yu-Ping Ruan, Zhen-Hua Ling, and Yu Hu. 2016. Ex-
ploring semantic representation in brain activity us-
ing word embeddings. In Proceedings of the 2016
Conference on Empirical Methods in Natural Lan-
guage Processing (EMNLP 2016), pages 669–679.

Anders Søgaard. 2016. Evaluating word embeddings
with fMRI and eye-tracking. In Proceedings of the
1st Workshop on Evaluating Vector-Space Repre-
sentations for NLP, pages 116–121. Association for
Computational Linguistics.

Liwei Wang, Lunjia Hu, Jiayuan Gu, Zhiqiang Hu, Yue
Wu, Kun He, and John Hopcroft. 2018. Towards un-
derstanding learning representations: To what extent
do different neural networks learn the same repre-
sentation. In Advances in Neural Information Pro-
cessing Systems, pages 9606–9615.

Tian Wang and Kyunghyun Cho. 2016. Larger-context
language modelling with recurrent neural network.
In Proceedings of the 54th Annual Meeting of the As-
sociation for Computational Linguistics, ACL 2016.

Leila Wehbe, Brian Murphy, Partha Talukdar, Alona
Fyshe, Aaditya Ramdas, and Tom Mitchell. 2014a.
Simultaneously uncovering the patterns of brain re-
gions involved in different story reading subpro-
cesses. in press.

Leila Wehbe, Ashish Vaswani, Kevin Knight, and
Tom M. Mitchell. 2014b. Aligning context-based
statistical models of language with brain activity
during reading. In Proceedings of the 2014 confer-
ence on empirical methods in natural language pro-
cessing (EMNLP 2014).

Masha Westerlund and Liina Pylkkänen. 2014. The
role of the left anterior temporal lobe in semantic
composition vs. semantic memory. Neuropsycholo-
gia, 57:59–70.

Haoyan Xu, Brian Murphy, and Alona Fyshe. 2016.
Brainbench: A brain-image test suite for distri-
butional semantic models. In Proceedings of the
2016 Conference on Empirical Methods in Natural
Language Processing (EMNLP 2016), pages 2017–
2021.

http://dl.acm.org/citation.cfm?id=2387636.2387658
http://dl.acm.org/citation.cfm?id=2387636.2387658
https://aclanthology.info/papers/N18-1202/n18-1202
https://aclanthology.info/papers/N18-1202/n18-1202
https://doi.org/10.18653/v1/W16-2521
https://doi.org/10.18653/v1/W16-2521
http://aclweb.org/anthology/P/P16/P16-1125.pdf
http://aclweb.org/anthology/P/P16/P16-1125.pdf
http://www.aclweb.org/anthology/D16-1213
http://www.aclweb.org/anthology/D16-1213


202

A Appendices

A.1 Representational Similarity Across
Different Layers of Different Models

Figure 11 shows the representational similarity
across different layers of the models given differ-
ent amount of context.

A.2 Preprocessing Brain Images
Besides the cognitive process of interest, other fac-
tors like the physiological processes in the bodies
of the human subjects or technical features of the
MRI-machine and scanning environment may in-
fluence the fMRI measurements. An important is-
sue is therefore how to preprocess the data to filter
out those irrelevant effects adequately.

Detrending. We normalise the brain activa-
tions in two steps: we scale the activation val-
ues by subtracting the per-voxel mean activa-
tion. We also experiment with a more elabo-
rate preprocessing procedure, implemented in the
nilearn.signal.clean Python library. De-
trending is a popular strategy in cognitive neu-
roscience (Abraham et al., 2014), that removes

the linear trend, applies a high pass filtering with
0.005 Hz, and standardises the vectors.

Voxel selection. To reduce the noise and remove
the voxels which their activation is not related to
the story reading task, we apply two steps for se-
lecting the voxels. In the first step, we remove all
the constant voxels. These are the brain regions
in which the activation does not change at all dur-
ing the scanning experiment. Next, we compare
the similarity of different regions of the brain for
all eight subjects and select those regions that their
activations over the different segments of the story
are most similar among the different subjects. To
do this, we rank the regions based on the average
of the similarity scores and then selected the top 16
regions. After applying this voxel selection strat-
egy, we have approximately 10000 voxels for each
subject.

In our experiments, we do not model the spa-
tial dependency of the voxels. Thus, after the pre-
processing steps, we flatten the 3D fMRI images
into vectors with the size of the total number of
the voxels.



203

Figure 11: RSA of different layers of different models for different context length. In this plot, for example
ELMO 1 c1 means representation from layer 1 of ELMO, when the context length is 1 sentences.


